Available online at www.sciencedirect.com

Procedia Computer Science 18 (2013) 2127 – 2136

International Conference on Computational Science, ICCS 2013

Electron beam absorption algorithms for electron beam melting
processes simulated by a three–dimensional thermal free surface
lattice Boltzmann method in a distributed and parallel environment
Matthias Markla,∗, Regina Ammerb , Ulric Ljungbladc , Ulrich R¨udeb , Carolin K¨ornera
a Chair

of Metals Science and Technology, WTM, University of Erlangen-Nuremberg, Martensstr. 5, 91058 Erlangen, GERMANY
for System Simulation, LSS, University of Erlangen-Nuremberg, Cauerstr. 11, 91058 Erlangen, GERMANY
c Arcam AB, Kroksl¨
atts Fabriker 27 A, 431 37 M¨olndal, SWEDEN

b Chair

Abstract
This paper introduces two electron beam absorption algorithms for a three–dimensional thermal free surface lattice Boltzmann method simulating electron beam melting processes. The algorithms use a state-of-the-art volume of ﬂuid free surface
method of the lattice Boltzmann multi–distribution approach to handle the interaction between the electron beam and the
material. Modeling the electron beam gun properties, such as absorption and energy dissipation, is explained in detail. Special emphasis is given to an implementation in a distributed and parallel environment due to the high computational costs of
three–dimensional simulations. Finally, a thorough validation for the beam absorption behavior against the analytical solution is proceeded and a concluding example in a powder bed shows the capability of the approach to simulate and support
understanding the electron beam melting process.
Keywords: Electron beam melting; Electron beam absorption; Thermal lattice Boltzmann method; Free surface

1. Introduction
Electron beam melting (EBM) is an additive manufacturing method used to produce metallic structures layer
by layer from metal powder. A schematic of an EBM system and the process is shown in Fig. 1. Before the process
starts a three–dimensional CAD model is sliced into certain thin layers. These slices determine where the electron
beam melts the powder. During the EBM process the current layer of metal powder is preheated and afterwards
the electron beam melts the powder according to the layer data. Once the layer is melted the build platform is
lowered by one layer thickness and the rake distributes a new powder layer.
There are numerous products generated by EBM: medical implants like hip joints or artiﬁcial spinal discs
[2], [3] or components for aerospace or automotive industry. Advantages of the EBM manufacturing are the
possibilities to construct very complex structures which are strong and ﬂexible.
The objective is to accelerate the build process and the production accuracy. Therefore, a better understanding
of the beam–powder interaction is necessary, which is gained by three–dimensional simulations of the process.
Based on a two–dimensional model [4] we developed a thermal three–dimensional free surface lattice Boltzmann
∗ Corresponding

author. Tel.: +49-9131-8520783; fax: +49-9131-8527515.
E-mail address: matthias.markl@fau.de.

1877-0509 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and peer review under responsibility of the organizers of the 2013 International Conference on Computational Science
doi:10.1016/j.procs.2013.05.383

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

electron beam gun

2128

1. Preheating of the
powder layer
powder
hopper

powder
hopper

rake

powder

building
tank

start plate
vacuum
chamber

process
platform

4. Application of a
new powder layer

2. Melting of the
cross section

3. Lowering of the
process platform

Fig. 1. Schematic of an EBM system and component generation layer by layer [1].

model (LBM) where powder particles are taken into account. The model includes hydrodynamic physical eﬀects,
like the ﬂow of the melt pool, capillarity and wetting, as well as thermal eﬀects, like heat conduction and transport,
electron beam absorption and solid–liquid phase transitions.
In this paper we describe in detail the derivation of absorption algorithms basing on electron beam properties.
Two acceleration voltages are considered and the resulting penetration behavior leads to the corresponding absorption algorithms. Both are derived suitable for parallel computation and validated by analytical solutions and
numerical examples. Our results show the high potential of the LB approach in combination with the electron
beam integration to understand and develop complex processes like EBM depending on thermodynamic as well
as on ﬂuid dynamic considerations.
The remainder of the paper is organized as follows. Section 2 describes the numerical method of a thermal
LBM used for discretization and its parallel implementation. Section 3, the main part of this paper, ampliﬁes the
aspects belonging to the modeling of the EBM process, i.e. deﬁnition of the electron beam and diﬀerent absorption
types. Section 4 provides information about the implementation and validates the derived absorption algorithms.
Finally, the numerical results of the absorption in a powder bed are shown and aspects and targets of future work
are described.
2. Numerical Methods
The single phase-continuum conservation equations to simulate incompressible thermodynamic ﬂuid transport
including melting and solidiﬁcation are given by:
∇ · u = 0,
1
∂(u)
+ (u · ∇)u = − ∇p + ν∇2 u + F,
∂t
ρ
∂(E)
+ ∇ · (uE) = ∇ · (k∇E) + Φ,
∂t

(1)
(2)
(3)

where t is the time and u the macroscopic velocity. Further hydrodynamic quantities are the density ρ, pressure
p, body forces F like the gravity and kinematic viscosity ν. The thermal energy density E depends on the ﬂuid
temperature, speciﬁc heat capacity and also latent heat for the phase transition and is related to the thermal diffusivity k(E). Energy sources, like the electron beam, are summarized in Φ. Fluid compression and viscous heat
dissipation are neglected by this model.

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

2129

The electron beam absorption marks the starting point for the simulation of the EBM process. The absorbed
energy introduced as a volumetric energy source in Φ heats the material and ﬁnally leads to a phase transition from
solid to liquid. Mainly the surface tension is the reason behind the melt pool ﬂow which aﬀects heat conduction
and further electron beam absorption.
For discretization lattice Boltzmann models [5] using particle distribution functions (pdf) f (x, v, t), describing
the probability of ﬁnding a particle with velocity v at position x at time t, are used. The local values of density
and momentum can be evaluated from known pdfs. The discretized pdf fi used by the lattice Boltzmann method
is gained by dividing space into a regular lattice. Velocities are represented by a ﬁnite set of displacement vectors
ei pointing to neighbor lattice sites. Resting particles are represented by a zero velocity vector.
There are mainly two approaches for solving the heat equation by LBM [6]. Thermal LBM using the multispeed approach [7], [8], [9] can be seen as an extension of the isothermal LBM. Additional discrete velocities
and higher order velocity terms in the method are used to represent the thermal energy density as an additional
moment. Drawbacks of this multi-speed approach are instabilities [10] and its limitation in simulating only one
Prandtl number, i.e. the ratio between kinematic viscosity and thermal diﬀusivity.
Using the multi-distribution approach [11], [12], [6], [13] the thermal ﬂow is modeled by second pdfs hi .
Herein, thermal energy density is deﬁned as a passive diﬀusing scalar [11], [14], [15]. The multi-distribution
ansatz can also deal with arbitrary Prandtl numbers. Because of these advantages we choose this approach.
At each lattice site both pdfs fi and hi are deﬁned and model mass, momentum and energy transport. The
macroscopic quantities are given by:
ρ=

fi ,

ρu =

i

e i fi ,

E=

i

hi .

(4)

i

The basic idea for the derivation of the LBM [16], [17], [18] is to solve the linear transport equation for pdfs in
the physical momentum space. Bhatagnar, Gross and Krook proposed an appropriate discretized approximation
of the collision operator [19], which is used to retrieve the equations of motion:
Δt eq
f (x, t) − fi (x, t) + Fi (x, t),
τf i
Δt eq
hi (x + ei , t + Δt) = hi (x, t) +
h (x, t) − hi (x, t) + Φi (x, t).
τh i
fi (x + ei , t + Δt) = fi (x, t) +

(5)
(6)

Body forces acting on the ﬂuid are summarized in Fi , e.g. gravity [20], and energy sources, like the electron beam,
eq
eq
are represented by Φi . The polynomial equilibrium distribution functions, denoted by fi and hi are deﬁned by:
ei · u (ei · u)2
u2
+
−
,
c2s
2c4s
2c2s
ei · u
eq
hi (x, t) = ωi E 1 + 2 .
cs
eq
fi (x, t) = ωi ρ 1 +

(7)
(8)

For the three–dimensional D3Q19 LBM the lattice weights ωi and lattice displacement vectors ei are given by:
⎧
⎧
1
⎪
⎪
⎪
⎪
(0, 0, 0)
i=0
⎪
⎪
3
⎪
⎪
⎪
⎪
⎨1
⎨
ωi = ⎪
ei = ⎪
(9)
(±c, 0, 0), (0, ±c, 0), (0, 0, ±c)
i = 1, . . . , 6
⎪
⎪
18
⎪
⎪
⎪
⎪
⎪
⎪
⎩1
⎩(±c, ±c, 0), (0, ±c, ±c), (±c, 0, ±c) i = 7, . . . , 18
36
The relaxation parameters τ f and τh , corresponding to the kinematic viscosity ν and the thermal diﬀusivity k
respectively, are deﬁned by:
ν = c2s Δt τ f − 0.5 ,

k = c2s Δt(τh − 0.5).

(10)

The lattice speed of sound c2s is c2 /3 with cell length c and Δt is the time step. Under the incompressible ﬂow
limit, i.e. for small Mach numbers, the mass, momentum and energy conservation equations (1)-(3) can be derived
through a Chapman–Enskog expansion [12], [21], [22]. The equations of motion (5) and (6) are solved in a two
step approach. First the collision values on the right hand side are computed and then they are streamed to the
neighbor cells.

2130

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

2.1. Free Surface
The development of a free surface LBM is necessary for the simulation of moving interfaces between immiscible gas and liquid ﬂuids. Therefore, each cell in the lattice have a cell type, e.g. wall, gas, liquid or liquid interface
and solid or solid interface (Fig. 2). Furthermore it has to be guaranteed that the gas phase is separated by a closed
interface layer from the ﬂuid phase [23].
Liquid cells (ϕ = 1)
Liquid Interface cells (ϕ ∈ ]0; 1[)
Solid cells (ϕ = 1)
Solid Interface cells (ϕ ∈ ]0; 1[)
Gas cells (ϕ = 0)
Wall cells
– Free Surface
·· Solid–Liquid Phase Transition
Fig. 2. Example of a molten spot in compact material. Gas phase is separated from the ﬂuid phase by an interface layer.

To ensure mass, momentum and energy conservation a volume of ﬂuid approach is used, where a ﬁll level
ϕ ∈ [0; 1] is deﬁned for each lattice cell.
We neglect the gas phase because of the high density diﬀerence to the ﬂuid phase, i.e. there are no pdfs
available in gas cells. Because of this fact missing pdfs after the streaming step in interface cells have to be
reconstructed by the approach described in [24].
Because of the simulation of the EBM process, which includes phase transitions, each ﬂuid lattice cell in the
simulation domain is either liquid or solid [25], determined by the energy density E and a certain, material speciﬁc
phase transition temperature.
Due to the high dynamics of the melt pool cell conversions between these states have to be done. All cells are
able to change their state but a change from a gas to a liquid cell and vice versa are not allowed because of the free
surface approach. Furthermore solid–liquid phase transitions [21] have to be considered.
3. Electron Beam Integration
In this part essential modeling aspects regarding the deﬁnition and behavior of the electron beam and its
properties are described. The main focus is taken on two absorption algorithms for electron beams with diﬀerent
acceleration voltages. Both algorithms are derived from the physical absorption behavior and are reformulated to
be executable in parallel.
3.1. Electron Beam Model
The electron beam energy Eb on the surface area of one lattice cell is modeled by a two–dimensional Gaussian
distribution
Eb (x) = γ

UIc2 Δt
1
exp − 2 x − xb , x − xb ,
2πσ2
2σ

(11)

where x denotes the lattice cell center position in the x–y–plane, xb the current beam center position and σ the
standard deviation. The electron beam power is deﬁned by the acceleration voltage U and beam current I. Some
electrons are lost due to reﬂection at the surface, so the remaining fraction of the electron beam energy penetrating
the material is denoted by γ ∈ ]0; 1[.
Regarding the EBM process it is necessary that the electron beam is mobile. Beam movements are deﬁned
by start, end and reference positions, start time and pulse duration. With these variables it is possible to describe
stationary cases which are reached by equal positions, line, curve or circle melting by a suitable setup of the
positions and multiplexing by deﬁning a series of start positions with short pulse durations.

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

2131

3.2. Electron Beam Absorption Model
The inclusion of beam energy has to be modeled by absorption, because absorption length of the electron
beam is magnitudes higher than the thermal length [26]. The electron beam penetrates through the material nearly
instantaneous. Therefore we model the energy source as a volumetric force of the ﬁrst cells
Φi (x, t) = ωi ϕ(x, t)Ea (x, t),

(12)

where x is the lattice cell center with the corresponding amount of absorbed energy Ea and Φi the source term in
equation (6).
Two diﬀerent absorption approaches have to be compared and examined. The ﬁrst is an exponential absorption
type for an electron beam with an acceleration voltage of 60 kV and the second is a constant absorption type for a
120 kV electron beam. The lower voltage is typically used in EBM machines and the higher voltage is a current
research topic.

absorption coeﬃcient [%]

8

= 60 kV
= 60 kV, approx.
= 120 kV
= 120 kV, approx.

6
4
2
0

0

10

20
30
40
50
penetration depth z [μm]

(a) lattice cell length c = 1 μm

60

40
absorption coeﬃcient [%]

U
U
U
U

10

U
U
U
U

30

= 60 kV
= 60 kV, approx.
= 120 kV
= 120 kV, approx.

20

10

0

0

10

20
30
40
50
penetration depth z [μm]

60

(b) lattice cell length c = 5 μm

Fig. 3. Relation between penetration depth and absorption coeﬃcient for 60 kV and 120 kV [27] and suitable approximations

In Fig. 3 the white marks show the absorption coeﬃcient related to the penetration depth for both acceleration voltages [27] and the black marks visualize the approximated value functions. The 60 kV electron beam is
approximated by a monotonically decreasing exponential function, meaning that most of the dissipated energy is
consumed by the cells which are closer to the electron beam gun.
The second absorption type for a 120 kV electron beam is approximated by a constant function. As a consequence of this, each cell in z-direction gets the same amount of energy until the complete energy is dissipated.
The constant absorption type has a higher penetration depth.
The maximum penetration depth z p is determined by minimizing the error of the approximated functions,
which is used to derive the artiﬁcial absorption parameter λ.
The approximations for a cell length of 1 μm in Fig. 3(a) are quite rough, but for a cell length of 5 μm in
Fig. 3(b), which is the default case for our simulations, the approximations ﬁt well. It is important to mention that
they do not diﬀer in the amount of energy which is absorbed, but rather in the depth. In both cases there is more
energy deported into deeper cells.
Furthermore it has to be thought about the dependency of the absorption coeﬃcient due to the ﬁll level at the
surface of the interface layer. Less ﬁlled cells should absorb less energy at the surface than completely ﬁlled cells.
Exponential Electron Beam Absorption. We approximate the absorption of Eb (x, y) for acceleration voltages at
60 kV by the exponential law. To apply the absorption on the lattice the spatial dimensions are discretized. For

2132

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

the x–y–plane this is done in Eb of equation (11) and the discretization of the z direction leads to
Ea (xi , y j , zk ) = Eb (xi , y j ) · 1 − e−λc · e−λzk ,

(13)

where Ea denotes the beam energy absorbed in one lattice cell and λ the material absorption parameter.
Here it is assumed that the electron beam energy is completely absorbed in a cell stack at xi , y j and that this
cell stack is ﬁlled with liquid cells. This assumption is not fulﬁlled for the EBM process, because powder layers
are melted with partly ﬁlled interface cells and empty gas cells. Therefore an equation within which the absorption
is computable cell–by–cell without any of these global assumptions is needed.
The next step is to reformulate equation (13) in a recursive way. This is done by an auxiliary function
ψ xi , y j , zl representing the exponential function:
Ea xi , y j , zk = Eb xi , y j · ψ xi , y j , zk ,
⎛
k−1
⎜⎜
−λc ⎜
⎜⎜⎜1 −
ψ xi , y j , zl
ψ xi , y j , zk = 1 − e
⎝
l=0

(14)

⎞
⎟⎟⎟
⎟⎟⎟.
⎠

By induction equality of equation (13) and equations (14) and (15) is provable.
volume of ﬂuid approach to determine the fraction of energy each cell can absorb.
⎛
k−1
⎜⎜
−λc ⎜
⎜⎜⎜1 −
χ xi , y j , zk = 1 − e
χ xi , y j , zl ϕ xi , y j , zl
⎝
l=0

(15)
The second step is to use the
Therefore ψ is replaced by
⎞
⎟⎟⎟
⎟⎟⎟.
(16)
⎠

Constant Electron Beam Absorption. The electron beam energy absorption for acceleration voltages at 120 kV is
approximated by a constant function, which is discretized spatially:
⎧
⎪
⎪
k<n
λEb xi , y j · c
⎪
⎪
⎪
⎨
n = z p /c ,
(17)
λ = 1/z p ,
Ea xi , y j , zk = ⎪
λEb xi , y j · z p − zk k = n ,
⎪
⎪
⎪
⎪
⎩0
k>n
with the material absorption parameter λ and maximum penetration depth z p .
For the same reasons as for the exponential absorption a cell–by–cell computable equation without any global
assumption is deﬁned by the auxiliary function χ, which uses the volume of ﬂuid approach:
Ea xi , y j , zk = Eb xi , y j χ xi , y j , zk ,
⎛
k−1
⎜⎜⎜
χ(xi , y j , zl )ϕ xi , y j , zl
χ xi , y j , zk = min ⎜⎜⎜⎝λc, 1 −
l=0

⎞
⎟⎟⎟
⎟⎟⎟.
⎠

(18)
(19)

Fill Level Eﬀects. In Fig. 4 the absorption behavior for both algorithms for the ﬁrst 12 lattice cells, each with a
length of 5 μm, is shown. In both cases the graphs for a ﬁll level of 1 equals the approximated graphs in Fig. 3.
In case of a reduced ﬁll level for all ﬂuid cells, the absorption behavior changes. In the exponential case
the ﬁrst cells absorb less energy, but from the third cell on the remaining energy is high enough to eliminate the
ﬁll level eﬀect and these cells absorb more energy than before. The absorption behavior for the constant case is
similar. The ﬁrst cells absorb the maximum amount of energy and the last cells the resulting energy. Here the
maximum penetration depth is indirect proportional to the ﬁll level.
3.3. Parallelization
To parallelize the numerical simulation the global domain is split in several blocks and those are distributed
to diﬀerent CPUs (Fig. 5). In a single streaming step of the LBM the pdfs to the direct neighbor cells have to
be communicated (red). But for the absorption of the electron beam the iteration over the whole domain in z
direction in one time step is necessary. In general this is possible with equations (14), (16) and (18), (19), but then
the computation of the absorption is completely sequential from top to bottom. This behavior will cause waiting
times for other CPUs, so these equations are reformulated for parallel computation.

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

ϕ = 1.0
ϕ = 0.9
ϕ = 0.8

ϕ = 1.0
ϕ = 0.9
ϕ = 0.8

12
absorption coeﬃcient [%]

absorption coeﬃcient [%]

40

30

20

10

2133

10
8
6
4
2

0

0

10

20
30
40
50
penetration depth z [μm]

0

60

0

(a) acceleration voltage 60 kV

10

20
30
40
50
penetration depth z [μm]

60

(b) acceleration voltage 120 kV

Fig. 4. Absorption behavior for diﬀerent ﬁll levels: in both ﬁgures the graph with a ﬁll level of 1 equals the approximated graphs in Fig. 3(b);
depending on the ﬁll level lower energy is absorbed in the ﬁrst cells and the electron beam penetrates deeper;

The main idea is to split the computation in a pre and post
compute step which can be evaluated parallel on each block and
a communication step between to exchange the necessary information. This communication (green) is a global top–to–bottom
scheme, where each block sends its information to each lower block.
With this technique each block can post compute the absorption coeﬃcients.
This subsection concentrates on one special position xi , y j and
skip these parameters. Furthermore the indices of zk are extended
to z(k,m) where k denotes the index in the corresponding block m.
The next step is to split up the auxiliary function χ into χpre and
χpost for the computation of the pre and the post absorption values,
respectively.
For the exponential beam absorption these modiﬁcations lead to:
Ea z(k,m) = Eb χpost z(k,m)
χpost z(k,m) = χpre z(k,m)

⎛
m−1 ⎜
⎜⎜⎜
⎜⎝1 −
n=0

−λc

χpre z(k,m) = 1 − e

⎛
⎜⎜⎜
⎜⎜⎜1 −
⎝

χpre z(l,n) ϕ z(l,n)
l

k−1

χpre z(l,m) ϕ z(l,m)
l=0

⎞
⎟⎟⎟
⎟⎟⎟
⎠

⎞
⎟⎟⎟
⎟⎟⎠

(20)
(21)

(22)

Fig. 5. Communication schemes: local for pdf
streaming (red); top–to–bottom for beam absorption (green)

The parallel computation starts from equation (22) which is computed on each block, then the second term of
equation (21) is communicated and ﬁnally equations (21) and (20) can be evaluated in the post computation step.

2134

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

A similar set of equations can be set up for the constant beam absorption:
Ea z(k,m) = Eb χpost (z(k,m) )
⎛
⎛
m−1
⎜⎜⎜
⎜⎜⎜
⎜
χpre z(l,n) ϕ z(l,n) −
χpost z(k,m) = min ⎜⎜⎝χpre z(k,m) , max ⎜⎜⎜⎝0, 1 −
n=0 l
⎛
⎞
k−1
⎜⎜⎜
⎟⎟⎟
χpre z(l,m) ϕ z(l,m) ⎟⎟⎟⎠
χpre z(k,m) = min ⎜⎜⎜⎝λc, 1 −

k−1

χpost z(l,m) ϕ z(l,m)
l=0

⎞⎞
⎟⎟⎟⎟⎟⎟
⎟⎟⎟⎟⎟⎟
⎠⎠

(23)
(24)

(25)

l=0

The parallel computation starts with the last equation (25) which is computed on each block, then the sum over
the pre computation values of the maximum function of equation (24) is communicated and ﬁnally equations (24)
and (23) are evaluated.
4. Implementation and Simulation Results
In this section the implementation in the waLBerla framework [28] is explained and the validation of the
absorption algorithm is done with respect to the approximated solutions using a generated powder bed. Finally,
the numerical results of these algorithms in a powder bed are shown.
4.1. Software frameworks
The implementation of the EBM process is done in the waLBerla framework. It is a LBM based numerical
ﬂuid ﬂow solver which can be used for the simulation of numerous physical applications, e.g. the simulation of
blood ﬂow in the human heart, the modeling of moving obstacles in a liquid or the simulation of bacteria in a
ﬂuid. Because of its modular architecture, the framework is well suited to be extended to simulate thermodynamic
phenomena. The generation of powder particles are included into waLBerla by coupling it with the PhysicsEngine
pe, which enables massively parallel simulations of arbitrary shaped rigid bodies [29].
Both frameworks are coupled by the powder bed generation. First the free surface from the lattice cells of waLBerla
is approximated and transfered to pe, which then generates
a new layer of powder particles consisting of diﬀerent sized
spheres. These particles are transfered back to the lattice
cells, by changing the cell type and setting an appropriate
ﬁll level at the interface cells to approximate the body shape.
After melting and solidiﬁcation this process starts again for
the next layer.
4.2. Absorption in powder bed
The previous section showed analytical results with a
compact material, with artiﬁcially reduced ﬁll levels. When
the EBM process is simulated, the electron beam is absorbed
in a powder bed, with completely and partly ﬁlled cells and
empty gas cells.
Fig. 6 shows a slice through a generated powder bed,
whereby the colors represent the absorption coeﬃcient from
a maximum value (red) to zero (blue) in ﬂuid cells. Gas cells
and the lattice grid are not shown. For this example we used
the exponential algorithm with a maximum absorption coefﬁcient of 0.38. The left subﬁgure represents the absorption
coeﬃcients in the pre computation step of a domain split
into three blocks.

(a) χpre

(b) χpost

Fig. 6. Absorption coeﬃcients in powder slice for 60 kV
acceleration voltage: the global domain is split into three
blocks; the absorption algorithm ﬁrst computes the pre values (a) then the communication takes place and the correct
post values can be computed (b)

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

The right subﬁgure shows the absorption coeﬃcients after the communication and post computation step. The
values at the top of the lower blocks are correct and the values show a monotonous decrease from top to bottom.
In both ﬁgures it is obvious that the gas cells have no inﬂuence on the absorption behavior. Furthermore the
absorption coeﬃcients of interface cells are not aﬀected by their ﬁll levels, because Ea is the absorbed energy
per lattice cell volume. For the computation of the energy source term in equation (12) the ﬁll level is taken into
account.
4.3. Melting of a spot
The melting spot example shows the combination of the electron beam absorption with phase transitions and
the LBM. In Fig. 7 are snapshots of melting a spot in a powder bed at diﬀerent time steps shown.

(a) 2500 time steps

(b) 5000 time steps

(c) 10000 time steps

Fig. 7. Snapshots of spot melting in a powder bed at diﬀerent time steps; the beam pulse duration is 7500 time steps;

The light gray cells are solid powder cells and the colored cells show the temperature gradient from the
maximum temperature (red) to the phase transition temperature (blue). The simulation starts with a small melt
pool (a), which grows (b) until time step 7500, when the beam pulse ends. Then the melt sink down in the powder
bed while cooling and begin to solidify (c). This example shows a good agreement to experimental data and the
potential to simulate the EBM process.
5. Conclusion
This paper describes a parallel, thermal free surface LBM which can be used for simulating the EBM process.
The implementation is included in the waLBerla framework and uses the pe for the generation of powder particles.
Particular importance was placed on the development of parallel absorption algorithms to take account of the high
computational costs of three–dimensional simulations.
The model for the electron beam consists of a deﬁnition of the electron beam by the acceleration voltage
and the current and enables us to deﬁne diﬀerent movements of it. Two diﬀerent absorption types, constant and
exponential, are derived and their relation due to penetration depth and dissipated energy is explained. Both
models are compared to the approximated solution and the implementation is also validated within a powder bed
by numerical simulations.
Future research topics will be the validation of the melt pool behavior, i.e. the comparison of its lifespan and
size with experimental data. First numerical simulations of melting spots and lines in powder beds will show the
interaction of the electron beam with the powder particles and the energy absorption in the melt pool to calibrate
the numerical model for a suﬃcient match with experiments. Then we will focus on the simulation of larger
domain sizes and more powder layers to take into account the inﬂuence of the penetration depth due to the melt
pool.
Acknowledgments
Our work is supported by the European Union Seventh Framework Program – Research for SME’s with
full title “High Productivity Electron Beam Melting Additive Manufacturing Development for the Part Production
Systems Market” and grant agreement number 286695. The authors of this paper would like to thank all developers
of waLBerla an pe.

2135

2136

Matthias Markl et al. / Procedia Computer Science 18 (2013) 2127 – 2136

References
[1] P. Heinl, A. Rottmair, C. K¨orner, R. Singer, Cellular titanium by selective electron beam melting, Advanced Engineering Materials 9 (5)
(2007) 360–364. doi:10.1002/adem.200700025.
[2] P. Heinl, L. M¨uller, C. K¨orner, R. F. Singer, F. A. M¨uller”, Cellular ti6al4v structures with interconnected macro porosity for bone
implants fabricated by selective electron beam melting, Acta Biomaterialia 4 (5) (2008) 1536 – 1544. doi:10.1016/j.actbio.2008.03.013.
[3] O. L. Harrysson, O. Cansizoglu, D. J. Marcellin-Little, D. R. Cormier, H. A. W. II, Direct metal fabrication of titanium implants with
tailored materials and mechanical properties using electron beam melting technology, Materials Science and Engineering: C 28 (3)
(2008) 366 – 373. doi:10.1016/j.msec.2007.04.022.
[4] C. K¨orner, E. Attar, P. Heinl, Mesoscopicsimulation of selective beam melting processes, Journal of Materials Processing Technology
211 (6) (2011) 978. doi:http://dx.doi.org/10.1016/j.jmatprotec.2010.12.016.
[5] F. Higuera, J. Jimenez, Boltzmann approach to lattice gas simulations, Europhysics Letters 9.
[6] Z. Guo, C. Zheng, B. Shi, T. Zhao, Thermal lattice boltzmann equation for low mach number ﬂows decoupling model, Physical Review
E 75.
[7] F. J. Alexander, Lattice boltzmann thermohydrodynamics, Physical Review E 47 (1993) R2249– R2252.
[8] C. Teixera, H. Chen, D. M. Freed, Multi-speed thermal lattice boltzmann method stabilization via equilibrium under-relaxation, Computer Physics Communications 129 (2000) 207–226.
[9] M. Watari, M. Tsutahara, Possibility of constructing a multispeed bhatnagar-gross-krook thermal model of the lattice boltzmann method,
Physical Review E 70.
[10] G. McNamara, B. Alder, Stabilization of thermal lattice boltzmann methods, J. Stat. Phys. 81 (1995) 395.
[11] X. Shan, Simulation of rayleigh-b´enard convection using a lattice boltzmann method, Physical Review E 55 (1997) 2780–2788.
[12] B. Palmer, D. Rector, Lattice boltzmann algorithm for simulating thermal ﬂow in compressible ﬂuids, Journal of Computational Physics
161 (2000) 1–20.
[13] Y. Zu, Y. Y. Yan, W. Shi, L. Ren, Numerical method of lattice boltzmann simulation for ﬂow past a rotating circular cylinder with heat
transfer, International Journal of Numerical Methods for Heat & Fluid Flow 18 (2008) 766–782.
[14] F. Massaioli, R.Benzi, S. Succi, Exponential tails in two-dimensional rayleigh-b´enard convection, Europhysics Letters 21 (1993) 305.
[15] X. He, S. Chen, G. Doolen, A novel thermal model for the lattice boltzmann method in incompressible limit, Journal of Computational
Physics 146 (1998) 282 – 200.
[16] S. Chen, G. D. Doolen, Lattice Boltzmann method for ﬂuid ﬂows, Annu. Rev. Fluid Mech. 30 (1998) 329–364.
[17] X. He, L.-S. Luo, A priori derivation of the lattice boltzmann equation, Physical Review E 55 (1997) R6333–R6336.
[18] X. He, L.-S. Luo, Theory of the lattice boltzmann method: From the boltzmann equation to the lattice boltzmann equation, Physical
Review E 56.
[19] P. Bhatnagar, E. Gross, M. Krook, A model for collision process in gases 1: small amplitude processes in charged and neutral onecomponent systems, Physical Review 50.
[20] L.-S. Luo, Theory of the lattice boltzmann method: Lattice boltzmann models for non-ideal gases, Physical Review E 62 (2000) 4982–
4996.
[21] D. Chatterjee, S. Chakraborty, A hybrid lattice boltzmann model for solid-liquid phase transition in presence of ﬂuid ﬂow, Physical
Letters A 351 (2006) 359–367.
[22] B. Shi, Z. Guo, Lattice boltzmann model for nonlinear convection-diﬀusion equations, Phys. Rev. E 79 (2009) 016701.
doi:10.1103/PhysRevE.79.016701.
[23] T. Pohl, High performance simulation of free surface ﬂows using the lattice Boltzmann method, Ph.D. thesis, University of ErlangenNuremberg (2007).
[24] E. Attar, Simulaton of selective electron beam melting processes, Ph.D. thesis, University of Erlangen-Nuremberg (2011).
[25] C. K¨orner, M. Thies, T.Hofmann, N. Th¨urey, U. R¨ude, Lattice boltzmann model for free surface ﬂow for modeling foaming, Journal of
Statistical Physics 121 (2005) 179–196.
[26] E. Mar´ın, Characteristic dimensions for heat transfer, Latin-American Journal of Physics Education 4 (1) (2010) 56–60.
[27] K. Kanaya, S. Okayama, Penetration and energy-loss theory of electrons in solid targets, Journal of Physics D: Applied Physics 5 (1972)
43–58.
[28] J. G¨otz, S. Donath, C. Feichtinger, K. Iglberger, U. R¨ude, Concepts of waLBerla prototype 0.1, Tech. rep., Lehrstuhl f¨ur Informatik 10
(Systemsimulation), Institut f¨ur Informatik, University of Erlangen-Nuremberg (2007).
[29] K. Iglberger, Software design of a massively parallel rigid body framework, Ph.D. thesis, University Erlangen-Nuremberg (2010).

