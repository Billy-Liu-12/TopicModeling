Available online at www.sciencedirect.com

Procedia Computer Science 18 (2013) 1919 – 1928

International Conference on Computational Science, ICCS 2013

Retrospective cost optimization for adaptive state estimation,
input estimation, and model reﬁnement
Anthony M. D’Amatoa , Asad A. Alib , Aaron Ridleyc , Dennis S. Bernsteinb,∗
a Ford Motor Company, Dearborn, MI, USA
Engineering Department, University of Michigan, Ann Arbor, MI 48109, USA
c AOSS Department, University of Michigan, Ann Arbor, MI 48109, USA

b Aerospace

Abstract
Retrospective cost optimization was originally developed for adaptive control. In this paper, we show how this technique is
applicable to three distinct but related problems, namely, state estimation, input estimation, and model reﬁnement. To illustrate
these techniques, we give two examples. In the ﬁrst example, retrospective cost model reﬁnement is used with synthetic data
to estimate the cooling dynamics that are missing from a model of the ionosphere-thermosphere. In the second example,
retrospective cost adaptive state estimation is used with data from a satellite to estimate a solar driver in the ionospherethermosphere, with performance gauged by using data from a second satellite.
Keywords: Model reﬁnement; state estimation; input estimation

1. Introduction
System theory encompasses several distinct but richly interrelated problems. These problems can roughly be
categorized as control, estimation, and identiﬁcation. The latter two problems are especially relevant to DDDAS
(dynamic data-driven application systems), which uses adaptive measurement strategies to enhance the accuracy
of model predictions.
In this paper we show how retrospective cost adaptive control provides the foundation for estimation and
identiﬁcation algorithms in the form of retrospective cost state estimation, retrospective cost input estimation, and
retrospective cost model reﬁnement. These techniques facilitate dynamic data-driven applications by enabling
ensemble-free state and driver estimation as well as model reﬁnement for attaining higher ﬁdelity models.
2. Retrospective Cost Adaptive Control
Retrospective Cost Adaptive Control (RCAC). RCAC was developed for aerospace applications, such as noise
and vibration control, control of aircraft under failure conditions (e.g., icing and wing damage), and spacecraft
attitude control [1, 2, 3, 4]. The RCAC algorithm and associated theory are described in [5, 6, 7, 8, 9]. The
basic idea behind RCAC is simple and intuitive. During control-system operation, RCAC collects and stores
∗ Corresponding

author.
E-mail address: dsbaero@umich.edu.

1877-0509 © 2013 The Authors. Published by Elsevier B.V. Open access under CC BY-NC-ND license.
Selection and peer review under responsibility of the organizers of the 2013 International Conference on Computational Science
doi:10.1016/j.procs.2013.05.361

1920

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

performance data over a trailing window. RCAC then re-optimizes the control inputs used over the trailing window
by minimizing a retrospective cost function. In a kind of “thought experiment,” RCAC asks itself, “What control
values would have given me improved performance were I able to go back into the past and replace the actual
past control inputs with diﬀerent values?” Of course, the re-optimized control inputs cannot be used, but they
can suggest how the controller can be modiﬁed so that the future performance is improved. This process of reoptimization and controller update comprises the adaptive control algorithm. In eﬀect, RCAC learns from the
past to do better in the future. A block diagram of the RCAC control law is shown in Figure 1(a), where the
performance signal zˆ is used by RCAC to update the Adaptive Feedback Controller.

Ideal Control System

Physical System

Ideal Plant

Main Physical
System

Ideal Feedback
Controller

Unknown Physical
Subsystem

Physical Plant

Main System
Model

Adaptive Feedback
Controller

Unknown Subsystem
Model

Controller Update

Physical Control System
(a)

Model Update

Model Refinement System
(b)

Fig. 1. These identical block diagrams illustrate the fact that, with appropriate signal reinterpretation, adaptive control and

model reﬁnement are essentially the same problem. In the case (a) of adaptive control, the Adaptive Feedback Controller is
updated by RCAC so as to reduce the error variable z, which may represent, for example, an aircraft ﬂight control or spacecraft
attitude control objective. Since RCAC is an adaptive control algorithm, it uses minimal modeling information about the
system it is controlling, and it can update the Adaptive Feedback Controller as needed in response to plant variations and
unknown disturbances. In the case (b) of model reﬁnement, the Unknown Subsystem Model is updated by RCMR as data are
collected. Analogous to the case of adaptive control, RCMR updates the Unknown Subsystem Model so as to reduce the error
variable z, which measures the discrepancy between the Physical System and the Model Reﬁnement System. RCMR operates
by estimating the inaccessible signal u in the Main Physical System; it then uses the estimate uˆ along with the computed output
yˆ to update the Unknown Subsystem Model.

3. Retrospective Cost Model Reﬁnement
It turns out, somewhat surprisingly, that RCAC can be used for an entirely diﬀerent purpose. Speciﬁcally,
by reinterpreting the signals and systems in the adaptive control problem, the same algorithm can be applied to
model reﬁnement in the form of retrospective cost model reﬁnement (RCMR). To do this, we model the uncertain
component of the system as an Unknown Physical Subsystem connected to the Main Physical System as shown
in Figure 1(b). The goal of the Model Reﬁnement System is to iteratively update the Unknown Subsystem Model

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

1921

by using the error signal z. The relationship between model reﬁnement and adaptive control is due to the fact that
the Unknown Subsystem Model is exactly analogous to the Adaptive Feedback Controller.
A key feature of RCMR is its ability to use data to construct models of system components that are not
accessible. In terms of Figure 1(b), this means that the interconnection signals y and u are not measured. To
illustrate this point, think of diagnosing a spark plug in a car by operating only the gas pedal and measuring
only the car’s acceleration. RCMR thus has the ability to use available measurements to identify inaccessible
subsystems. This ability is crucial in situations where physical measurements are limited and the drivers and
response of poorly understood phenomena cannot be directly measured.
As shown in Figure 1, RCMR operates in the same way as RCAC except that the signals and operations have
diﬀerent interpretations. In the case of RCMR, the re-optimized input uˆ serves as an estimate of the output u of
the Unknown Physical Subsystem. This estimate is used along with the computed signal yˆ from the Main System
Model to update (through regression techniques) the estimate of the Unknown Physical Subsystem. The goal is
to reduce the discrepancy between the Physical System and the Model Reﬁnement System in the sense that the
error based on the diﬀerence between the measured output y0 and the computed output yˆ 0 is minimized. Just
as RCAC learns from the past to do better in the future, RCMR uses data to learn about the Unknown Physical
Subsystem, thereby enhancing the ability of the Main System Model and Unknown Subsystem Model to match the
dynamics of the Physical System. Again, RCMR is virtually identical to RCAC in the sense that the computational
techniques are the same but the results of the operations in the two cases are completely diﬀerent. This conceptual
insight is crucial to the multidisciplinary nature of the proposed research.
Within control systems research, system identiﬁcation is widely used to provide models for controller analysis
and synthesis [10, 11, 12, 13, 14, 15, 16]. RCMR belongs within this ﬁeld, but provides a unique tool due to its
ability to estimate an inaccessible subsystem. In contrast, system identiﬁcation techniques generally aim to model
the overall system rather than a targeted, unknown subsystem.
We have demonstrated RCMR using both experimental and simulated data. In laboratory test cases using real
measurements, we used RCMR in [17] to estimate the parameters of an electronic circuit, while in [18] we used
RCMR to update a model of a structural component. These experimental implementations of RCMR show its
potential for working with physical measurements corrupted by noise. In addition, using synthetic (simulated)
data from a truth model in [17], we used RCMR to estimate a thermal conductivity coeﬃcient in the ionosphere.
4. Applicability to Nonlinear Systems
The derivation of the retrospective cost algorithm used by RCAC and RCMR is based on linear models.
However, RCAC and RCMR have been demonstrated on a variety of nonlinear models. For example, RCAC has
been used to control plants with input nonlinearities in [19], spacecraft with nonlinear rotational dynamics and
attitude kinematics in [20], and diesel engines with nonlinear air ﬂow dynamics in [21]. Likewise, RCMR has been
used for model reﬁnement and state estimation in nonlinear ionospheric dynamics [17, 22] and nonlinear battery
dynamics in [23]. These examples demonstrate that RCAC and RCMR are eﬀective for nonlinear systems. The
eﬀectiveness of RCMR for nonlinear systems is a consequence of the fact that the retrospective cost algorithm does
not require an explicit model of the system being reﬁned. Instead, RCMR is implemented with a single copy of the
nonlinear system dynamics (which may be in the form of a computer code) and requires knowledge of extremely
limited modeling information, namely, components of the impulse response; in many cases, only one component
is needed. For the case of nonlinear systems, these impulse response parameters can be estimated based on the
qualitative behavior of the system. In practice, this means that tuning RCMR typically requires selection of a
single number. The sign of this number (positive or negative) must be correctly chosen, and the magnitude of
this number can be adjusted to inﬂuence the convergence rate of the RCMR estimates of the Unknown Physical
Subsystem.
5. Case Study: Retrospective Cost Model Reﬁnement for GITM
We now present a case study in which the goal is to reﬁne an initial model by estimating dynamics that are
“missing” from the model. This objective supports the goals of DDDAS by enhancing model accuracy. The goal

1922

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

of the study is to determine whether RCMR can provide an estimate of the Unknown Physical Subsystem corresponding to the NO cooling dynamics. For this purpose, the Main System Model is simply the GITM code without
the NO cooling dynamics. The “missing” NO cooling dynamics are replaced by the Unknown Subsystem Model,
which is the estimated NO cooling dynamics updated by RCMR. Figure 2 shows the output of the Unknown Subsystem Model estimated by RCMR. These results were obtained by implementing RCMR in FORTRAN within
the context of GITM. For this study we use a 1D version of the Global Ionosphere-Thermosphere Model (GITM)
[24, 25] to play the role of the Physical System to generate truth data for use by RCMR.
0.5 Days

0.8 Days

500

500
Exact @ Peak
Estimated @ Peak

400

400

350

350

300

300

250

250

200

200

150

150

100

0

0.5

1

1.5
°C/s x 1000

2

Exact @ Peak
Estimated @ Peak

450

Altitude

Altitude

450

100

2.5

(a) NO cooling as a function of altitude at 0.5 days.

0

0.2

0.4

0.6
0.8
°C/s x 1000

1.6 Days

1.4

2.7 Days
500
Exact @ Peak
Estimated @ Peak

450
400

400

350

350

300

300

250

250

200

200

150

150

0

0.5

1

1.5

2
2.5
°C/s x 1000

3

3.5

4

Exact @ Peak
Estimated @ Peak

450

Altitude

Altitude

1.2

(b) NO cooling as a function of altitude at 0.8 days.

500

100

1

4.5

(c) NO cooling as a function of altitude at 1.6 days.

100

0

0.5

1

1.5

2
2.5
°C/s x 1000

3

3.5

4

(d) NO cooling as a function of altitude at 2.7 days.

Fig. 2. In this example from [17], RCMR was used to construct a model of “missing physics,” namely, the nitrous oxide (NO)

cooling dynamics in the GITM truth model of the ionosphere. The cooling rate at various altitudes and times is shown for a
truth model playing the role of the Physical System; the same plots show the cooling rates for the Main System Model (that is,
the truth model with the cooling dynamics removed) connected with the estimated Unknown Subsystem Model as updated by
RCMR. These plots show the diﬀerence between the actual NO cooling included in the truth model and the cooling estimated
by RCMR as a function of altitude at a given time. Cooling is along the horizontal axis, while altitude is along the vertical axis.
The blue dashed line is the estimated value. To reﬂect conditions under which RCMR would be performed under real-world
conditions, the data made available to RCMR consists of measurements of the thermospheric density at 407 km altitude, which
for this study are obtained from the simulated GITM truth model (including NO cooling). The vertical dashed lines in Figure
2(a) are the time instances at which the altitude versus NO cooling plots (a)–(d) are taken. These plots indicate that RCMR
has constructed a dynamic model that captures the Unknown Physical Subsystem Model of the “missing” cooling dynamics.

To reproduce the dynamics of the cooling, three linear dynamic equations are derived, one for each of the
three chosen altitudes. This yields a proﬁle that resembles the natural logarithm of the NO density [26, 27],
indicating that this may be the source of the cooling, which it actually is. Figures 3(a) and 3(b) compare the model
without correction versus the model with correction, both of which are baselined against the truth model. Without
data-based model reﬁnement, the estimated density measurements degrade as time increases.

1923

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

NO Exact
NO Estimated

5
4.5
4

−11

° C/s x 1000 @ 152 km

3

x 10

3.5
3

2.5

2.5

2

Density − Truth Model
Density − with Refined Cooling
Density − without Refined Cooling

2
1.5

1.5
1

1

0.5

0.5

0
0

0.5

1

1.5

2
2.5
Time (Days)

3

3.5

4

(a) Comparison of truth and reﬁned cooling models.

0
0

0.5

1

1.5

2
2.5
Time (Days)

3

3.5

4

(b) Comparison of truth, reﬁned, and “missing” cooling models.

Fig. 3. (a) shows the diﬀerence between the actual NO cooling included in the GITM truth model and the cooling in the reﬁned

GITM model as a function of time at a speciﬁc altitude (152 km). The vertical dashed lines are the time instances at which the
altitude versus NO cooling plots in Figure 2 are taken. (b) shows the diﬀerence between the density measurements for the initial
model, where no correction is made, and the model with the reﬁned subsystem versus the truth model. With adaptive model
reﬁnement, the reﬁned model is able to track the truth model, whereas, if no correction is made, the density measurements
degrade as time increases.

6. Retrospective Cost Adaptive State Estimation
Although the objective of RCMR is to update the Unknown Subsystem Model, it also has the tendency to
drive the internal states of the Main System Model toward the states of the Main Physical System. The states of
the Main System Model thus serve as estimates of the states of the Main Physical System. Consequently, RCMR
provides an adaptive technique for data assimilation as demonstrated in [28]. Retrospective cost adaptive state
estimation (RCASE) was used for state and driver estimation within the context of a parallel implementation of
3D GITM in [22].
For data assimilation, RCMR does not propagate an estimate of the error covariance as in the case of particle
and ensemble methods [29]. Rather, RCMR provides “point” estimates without an associated probability distribution. Consequently, for data assimilation, RCMR does not provide the depth of statistical insight that ensemble
data assimilation methods provide; accordingly, it does not require any prior statistical information. In addition,
since RCMR is based on an adaptive algorithm, it does not require an ensemble of models to propagate state
estimates; this means that RCMR is highly computationally eﬃcient. For example, for the simulations of RCMR
in [22], a single copy of GITM (which is all that RCMR requires) was run on a 4-processor implementation, and
the added computational burden of RCMR was about 1%. Similar comments can be made in comparing RCMR
to data assimilation codes based on adjoint methods [30]; in fact, RCMR does not require an adjoint model, and
none exists for GITM.
Beyond state estimation, data assimilation techniques can be used for model reﬁnement in the case of parameter estimation. The classical approach is to use the extended Kalman ﬁlter [31]. Along the same lines, particle
ﬁlter techniques, ensemble methods, sigma point ﬁlters, and Fokker-Planck solvers [32, 33, 34, 35, 36, 37] can
be used to estimate constant and time-varying parameters modeled as ﬁctitious states. These techniques can also
be used to compensate for (but not correct) model deﬁciencies due to numerical discretization, parameter errors,
and uncertain physics [38]. All of these techniques generate statistical measures of the accuracy of the parameter
estimates and thus rely on prior statistical information and require an ensemble of models. Consequently, these
techniques tend to be computationally expensive. In addition, RCMR treats the parameter estimation problem as
an inherently linear problem, which makes RCMR suitable for estimating large numbers of uncertain parameters.
Finally, RCAC has the ability to update high-order dynamic models.

1924

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

7. Retrospective Cost Adaptive Input Estimatioin
State estimation techniques, such as the Kalman ﬁlter and its variants, use measurements to recursively reﬁne
state estimates. The input to the system is typically modeled as a combination of an unknown zero-mean stochastic
signal and a known deterministic signal. The deterministic signal is injected numerically into the observer, thereby
enhancing the accuracy of the estimated states. In practice, however, the deterministic input may be unknown,
and treating this signal as part of the stochastic input may yield poor state estimates. Consequently, extensive
research has been devoted to developing state estimators that are either insensitive to the lack of knowledge of
the deterministic input or attempt to estimate this signal along with the states. These techniques are referred to as
unbiased Kalman ﬁlters, unknown input observers, and state estimators with input reconstruction [39, 40, 41, 42,
43, 44, 45, 46, 47, 48]. The ability to estimate inputs is crucial to applications where the system is strongly driven
and entrainment eﬀects are the overriding phenomenon [49, 50, 51].
Retrospective cost adaptive input estimation was demonstrated in [52]. The paper demonstrates the core of the
retrospective cost approach, namely, the ability to adaptively estimate the input to a system, which may be either
an external or internal signal (in the case of a subsystem). This technique forms the basis for estimating the signal
uˆ in Figure 1(b).
8. Case Study: Retrospective Cost State and Input Estimation for GITM
We now present a case study where the goal is to estimate the unknown input to a system. This objective
supports the goals of DDDAS by enhancing prediction accuracy. In particular, state and input estimation are
considered in [22] based on the 3D GITM model with both synthetic and real measurements. Here we consider
the case of real measurements from the CHAMP satellite.
This study is motivated by the fact that radio propagation and satellite drag are aﬀected by the Sun’s inﬂuence
on the ionosphere and thermosphere. In particular, extreme ultraviolet (EUV) and X-ray radiation produce photoionization, which, in turn, through chemistry and heating, drives the formation of the ionosphere and shapes
the thermosphere. In addition, the eﬀect of the EUV and X-ray radiation is suﬃcient to render the ionospherethermosphere a strongly driven system [49, 50, 51].
Since a signiﬁcant portion of EUV and X-ray radiation is absorbed by the atmosphere, it is not possible to
measure these quantities from the ground. Instead, a proxy is used. The most common proxy for EUV and X-ray
radiation is the ﬂux solar irradiance at a wavelength of 10.7 cm (F10.7 ), which is measured (in units of 10−22 W
Hz−1 m−2 = 1 solar ﬂux unit (SFU)) by the Dominion radio observatory in Penticton, Canada [53]. A shortcoming
of this technique is that F10.7 does not have a one-to-one correlation with each of the wavelengths in the EUV and
X-ray bands, and thus the measured F10.7 is often a misrepresentation of the true solar spectrum.
Although our ultimate goal is to estimate the true ﬂux in multiple EUV and X-ray wavelength bins, a more
attainable intermediate goal is to estimate the value of F10.7 that best characterizes the ionosphere and thermosphere. The ability to estimate F10.7 from alternative measurements can provide a cross check on the available
measurements, while also providing an illustrative proof-of-concept demonstration of RCASE as a ﬁrst step toward estimating X-ray and EUV in multiple bands. Furthermore, current models do not fully capture the dynamics
of the ionosphere-thermosphere, in which case F10.7 can be used as an input to the model in order to eliminate the
errors between real measurements and synthetic (simulated) measurements. This study thus attempts to specify
F10.7 based on simulated measurements of the atmosphere as well as with real satellite data. The speciﬁed F10.7 can
then be used to obtain improved estimates of the state of the ionosphere and thermosphere globally and possibly
predict its future evolution. This is a problem of state and input estimation.
To estimate F10.7 , we use the Global Ionosphere Thermosphere Model (GITM) [24]. GITM simulates the density, temperature, and winds in the thermosphere and ionosphere across the globe from 100 km to 600 km altitude,
depending on the solar conditions at the time. The main inputs to GITM are the high-latitude electrodynamics
(i.e., the aurora and the associated electric ﬁelds), tides from the lower atmosphere, and the brightness of the sun at
various wavelengths, which can be proxied through the use of F10.7 . GITM solves for the chemistry, dynamics, and
thermodynamics of the upper atmosphere self-consistently by accounting for interactions among various species
of ions and neutrals.

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

1925

In [22] we used the retrospective cost adaptive state estimation (RCASE) technique [28] to estimate the unknown solar driver F10.7 using the Global Ionosphere-Thermosphere Model and satellite measurements. RCASE
assumes that the input to the system is unknown, and uses retrospective optimization to construct an input to
the adaptive estimator that minimizes the retrospective cost function. The retrospectively optimized input is then
used to asymptotically drive the error between the measured output and the estimator output to zero. In this
way, RCASE asymptotically estimates the unknown input to the system and the unknown states of the system.
A useful feature of RCASE is that an explicit nonlinear or linearized model is not required. In addition, unlike
ensemble-based data-assimilation algorithms [32, 33, 34], RCASE uses only one copy of the system model and
thus is ensemble-free.
For the case of real satellite data case, the neutral mass density data measured by CHAMP (the “truth data”) is
labeled y(k), while the neutral mass density data measured by GRACE is labeled yG (k). First, we run GITM with
the measured F¯ 10.7 (k) and record the neutral mass density at CHAMP locations and GRACE locations, which are
labeled yˆ m (k) and yˆG,m (k), respectively. Next, we combine RCASE and GITM, and use y(k) to estimate F¯ 10.7 (k)
and states. The neutral mass density output from GITM with RCASE at CHAMP and GRACE locations are
labeled yˆ (k) and yˆG (k), respectively. Note that data from GRACE are used only as a metric for assessing the
accuracy of state estimates, and are not used by RCASE. We further divide this setup into two cases. First, in
RCASE, we use GITM with photoelectron heating. When photoelectron heating is used in GITM, then the neutral
density output from GITM at CHAMP locations using measured F¯ 10.7 (k) closely matches CHAMP neutral density
measurements. However, it should be noted that the photoelectron heating eﬃciency coeﬃcient that yields low
error between GITM and CHAMP is obtained by trial and error, and cannot be calculated or measured. In the
second case, in RCASE, we use GITM without photoelectron heating. In this case, GITM with measured F¯ 10.7 (k)
yields a large error between the outputs from GITM at CHAMP locations and CHAMP measurements. In this
case, RCASE will use Fˆ¯ 10.7 (k) as an input to GITM in order to correct the errors between CHAMP measurements
and the output from GITM at CHAMP locations, and thus account for the inaccuracies incurred by removing
photoelectron heating from GITM.
Let p(k) ∈ R be an arbitrary signal, and let T be a positive integer. Then, for all k ≥ T , deﬁne the windowed
average of the signal p(k) as
μT,p (k) =

1
T

k

p(i),
i=k−T +1

where T is the interval over which the signal is averaged. Similarly, for all k ≥ T , deﬁne the windowed standard
deviation of the signal p(k) as
σT,p (k) =

1
T

k

2

p(i) − μT,p (i) .
i=k−T +1

The root mean square value of p(k) is denoted by RMS(p).
When GITM is used with RCASE, we keep Fˆ¯ 10.7 (k) at a constant value of 100 SFU for the ﬁrst 24 h, after
which RCASE is turned on. This allows the response due to initial conditions to decay signiﬁcantly. We implement
GITM on four processors with a resolution of 5◦ latitude by 5◦ longitude. The time step for GITM is set at 2 sec,
and RCASE is used to update Fˆ¯ 10.7 (k) every 60 sec. In all ﬁgures in this section, the vertical black line indicates
when RCASE is switched on. Finally, the numerical experiments consider the period from 2002-11-24 to 200212-06.
We consider the case where the truth data are recorded by CHAMP from 2002-11-24 to 2002-12-06 and we
use GITM with photoelectron heating. We calculate the RMS of z(k) after 144 h in order to minimize the eﬀect of
transients in yˆ (k) generated during the convergence of the adaptive subsystem. First, we consider the measurements
from CHAMP. Figure 4(a) shows the windowed mean and variance of y(k), yˆ (k), and yˆ m (k). For this example,
GITM with measured F¯ 10.7 (k) yields RMS(z) = 6.5 × 10−13 , and GITM with RCASE yields RMS(z) = 6.1 × 10−13 .
In other words, GITM with RCASE yields 6% reduction in RMS(z) compared to GITM with measured F¯ 10.7 (k).
Figure 5 shows the measured and estimated F¯ 10.7 (k). This plot shows that μ1440,Fˆ¯ 10.7 (k) (the average of Fˆ¯ 10.7 (k)
over 1 day) converges to within 6 SFU of the measured values of F¯ 10.7 (k) in 72 h.

1926

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

Finally, we consider data from GRACE to assess the quality of the state estimates. Deﬁne zG (k) = yG (k)−ˆyG (k).
Figure 4(b) shows the windowed mean and variance of yG (k), yˆG (k), and yˆG,m (k). For this example, GITM with
measured F¯ 10.7 (k) yields RMS(zG ) = 4 × 10−13 , whereas GITM with RCASE yields RMS(zG ) = 3.6 × 10−13 .
Therefore, GITM with RCASE yields 11% reduction in RMS(zG ) compared to GITM with measured F¯ 10.7 (k).
−12

−12

8

x 10

μ 90,y (k)

7

μ 90,ˆy (k)

6

μ 90,ˆym (k)

2.5

μ 90,yG (k)
μ 90,ˆyG (k)

2

5

μ 90,ˆyG,m (k)

1.5

μ

μ

x 10

4

1
3
2

0.5

1
0
1.8

0
0
24
−12
x 10

48

72

96

120

144

168

192

216

240

1.6

σ90,ˆy (k)

1.4

σ90,ˆym (k)

0

24

48

72

96

120

144

168

192

216

240

−12

σ90,y (k)

1.5

x 10

σ90,yG (k)
σ90,ˆyG (k)
σ90,ˆyG,m (k)

1.2

1

σ

σ

1
0.8
0.6

0.5

0.4
0.2
0

0

24

48

72

96

120

144

Time (h)

168

192

216

240

(a) Output-matching performance of RCASE for GITM using driver
estimates.

0

0

24

48

72

96

120

144

Time (h)

168

192

216

240

(b) State-estimation performance of RCASE for GITM.

Fig. 4. (a) μ90,y (k), μ90,ˆy (k), μ90,ˆym (k), σ90,y (k), σ90,ˆy (k), and σ90,ˆym (k) for the case of real CHAMP satellite data and GITM with

photoelectron heating. For this example, GITM with RCASE yields 6% lower RMS(z) compared to GITM with measured
F¯ 10.7 (k). (b) This plot shows μ90,yG (k), μ90,ˆyG (k), μ90,ˆyG,m (k), σ90,yG (k), σ90,ˆyG (k), and σ90,ˆyG,m (k) for real GRACE satellite data and
the case of real CHAMP satellite data and GITM with photoelectron heating. For this example, GITM with RCASE yields
11% reduction in RMS(zG ) compared to GITM with measured F¯ 10.7 (k).

9. Extensions to Nonlinear Models
To ascertain subsystem model order, RCMR can be run with various model orders, and the spectral content
of the error signal can be used to determine whether the dynamic order of the Unknown Subsystem Model is
suﬃciently high for representing the dynamics of the Unknown Physical Subsystem. This can easily be done by
varying the order of the linear Unknown Subsystem Model. However, many applications require that RCMR have
the ability to represent a large class of nonlinear Unknown Subsystem Models. This can be done in the following
way. In RCMR, the Unknown Subsystem Model has the form of an ARMAX time series model, where the next
output uˆ (k + 1) is a function of the previous outputs uˆ (k − i) and past inputs yˆ (k − j). RCMR uses a regression
technique to update the coeﬃcients of this model. However, this technique can be applied to nonlinear functions
of the past outputs and inputs. The resulting nonlinear ARMAX model (called a NARMAX model) provides a
rich class of model structures that can enable the search for eﬃcient and accurate subsystem models.
NARMAX models have been used extensively for nonlinear system identiﬁcation [54, 55, 56, 57, 58, 59, 60],
and they can be used within RCMR to represent the Unknown Subsystem Model [61, 61]. To do this, it is necessary
to examine the eﬀectiveness of various basis functions such as radial basis functions and wavelets, which can be
used by RCMR for constructing NARMAX representations of the Unknown Subsystem Model.
Acknowledgments
This research was supported in part by AFOSR DDDAS grant FA9550-12-1-0401, NSF CDI grant AGS1027192, and NSF CPS grant CNS-1035236.

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

1927

¯ 10.7 (10−12 W Hz−1 m−2 )
F

180
160
140
120

ˆ
¯ 10.7 (k)
F

100

μ

(k)

¯ 10.7 (k)
F

80
60

ˆ
¯
1440,F10.7

0

24

48

72

96

120

Time (h)

144

168

192

216

240

Fig. 5. Measured and estimated F¯ 10.7 (k) for the case of real CHAMP satellite data and GITM with photoelectron heating. This plot shows that
μ1440,Fˆ¯ (k) (the average of Fˆ¯ 10.7 (k) over 1 day) converges to within 6 SFU of the measured values of F¯ 10.7 (k) in 72 h.
10.7

References
[1] G. Cruz, A. M. D’Amato, D. S. Bernstein, Retrospective cost adaptive control of spacecraft attitude, in: Proc. AIAA Guid. Nav. Contr.
Conf., Minneapolis, MN, 2012, AIAA-2012-4624-236.
[2] A. M. D’Amato, E. D. Sumer, D. S. Bernstein, Frequency-domain stability analysis of retrospective-cost adaptive control for systems
with unknown nonminimum-phase zeros, in: Proc. Conf. Dec. Contr., Orlando, FL, 2011, pp. 1098–1103.
[3] Y.-C. Cho, J. B. Hoagg, D. S. Bernstein, W. Shyy, Retrospective Cost Adaptive Flow Control of Low-Reynolds Number Aerodynamics
Using a Dielectric Barrier Discharge Actuator, in: Proc. 5th AIAA Flow Contr. Conf., Chicago, IL, 2010, aIAA-2010-4841.
[4] R. J. Fuentes, J. B. Hoagg, B. J. Anderton, A. M. D’Amato, D. S. Bernstein, Investigation of Cumulative Retrospective Cost Adaptive
Control for Missile Application, in: AIAA Guid. Nav. Contr. Conf., Toronto, 2010, aIAA 2010-7577.
[5] M. A. Santillo, D. S. Bernstein, Adaptive Control Based on Retrospective Cost Optimization, AIAA J. Guid. Contr. Dyn. 33 (2010)
289–304.
[6] J. B. Hoagg, D. S. Bernstein, Retrospective Cost Model Reference Adaptive Control for Nonminimum-Phase Systems, AIAA J. Guid.
Contr. Dyn. 35 (2012) 1767–1786.
[7] R. Venugopal, D. S. Bernstein, Adaptive Disturbance Rejection Using ARMARKOV System Representations, IEEE Trans. Contr. Sys.
Tech. 8 (2000) 257–269.
[8] J. B. Hoagg, M. A. Santillo, D. S. Bernstein, Discrete-time Adaptive Command Following and Disturbance Rejection with Unknown
Exogenous Dynamics, IEEE Trans. Autom. Contr. 53 (2008) 912–928.
[9] H. Sane, R. Venugopal, D. S. Bernstein, Disturbance Rejection Using Self-Tuning ARMARKOV Adaptive Control with Simultaneous
Identiﬁcation, IEEE Trans. Contr. Sys. Tech. 19 (2001) 101–106.
[10] O. Nelles, Nonlinear System Identiﬁcation, Springer, 2001.
[11] L. Ljung, T. Soderstrom, Theory and Practice of Recursive Identiﬁcation, The MIT Press, 1983.
[12] L. Ljung, System Identiﬁcation: Theory for the User, 2nd Edition, Prentice Hall Information and System Sciences Series, Prentice Hall,
1999.
[13] J.-N. Juang, Applied System Identiﬁcation, Prentice Hall, 1993.
[14] P. Van Overschee, B. De Moor, Subspace Identiﬁcation for Linear Systems: Theory, Implementation, Applications, Kluwer, 1996.
[15] T. Soderstrom, P. Stoica, System Identiﬁcation, Prentice Hall, 1989.
[16] R. Haber, L. Keviczky, Nonlinear System Identiﬁcation—Input-Output Modeling Approach, Vol. 1: Nonlinear System Parameter Identiﬁcation, Kluwer Academic Publishers, 1999.
[17] A. M. D’Amato, A. J. Ridley, D. S. Bernstein, Retrospective-cost-based adaptive model reﬁnement for the ionosphere and thermosphere,
Statistical Analysis and Data Mining 4 (2011) 446–458.
[18] A. M. D’Amato, B. J. Arritt, J. A. Banik, E. V. Ardelean, D. S. Bernstein, Structural health determination and model reﬁnement for a
deployable composite boom, in: Proc. AIAA SDM Conf., Palm Springs, CA, 2009, AIAA-2009-2373.
[19] J. Yan, A. M. D’Amato, D. Sumer, J. B. Hoagg, D. S. Bernstein, Adaptive control of uncertain hammerstein systems with monotonic
input nonlinearities using auxiliary nonlinearities, in: Proc. Conf. Dec. Contr., Maui, HI, 2012, pp. 4811–4816.
[20] G. Cruz, A. M. D’Amato, D. S. Bernstein, Retrospective cost adaptive control of spacecraft attitude, in: Proc. AIAA Guid. Nav. Contr.
Conf., Minneapolis, MN, 2012, aIAA-2012-4624-236.
[21] J. Yan, A. M. D’Amato, K. Butts, I. Kolmanovsky, D. S. Bernstein, Adaptive control of the air ﬂow system in a diesel engine, in: Proc.
DSCC, Fort Lauderdale, FL, 2012, DSCC2012-MOVIC2012-8597.
[22] A. A. Ali, K. Agarwal, A. J. Ridley, D. S. Bernstein, Ensemble-Free State and Driver Estimation in the Ionosphere-Thermosphere Using
Retrospective-Cost-Based Adaptive Estimation(submitted).
[23] A. M. D’Amato, J. Forman, T. Ersal, A. A. Ali, J. Stein, H. Peng, D. S. Bernstein, Noninvasive battery-health diagnostics using
retrospective-cost identiﬁcation of inaccessible subsystems, in: Proc. DSCC, Fort Lauderdale, FL, 2012, dSCC2012-MOVIC2012-8649.
[24] A. J. Ridley, Y. Deng, G. T`oth, The global ionosphere-thermosphere model, J. Atmos. Sol-Terr. Phys. 68 (2006) 839–864.
[25] R. G. Roble, E. C. Ridley, A. D. Richmond, R. E. Dickinson, A coupled thermosphere/ionosphere general circulation model, Geophys.
Res. Lett. 15 (12) (1988) 1325–1328.

1928

Anthony M. D’Amato et al. / Procedia Computer Science 18 (2013) 1919 – 1928

[26] C. A. Barth, K. D. Mankoﬀ, S. M. Bailey, S. C. Solomon, Global observations of nitric oxide in the thermosphere, J. Geophys. Res.
108(A1) (2003) 1027.
[27] D. R. Marsh, S. C. Solomon, A. E. Reynolds, Empirical model of nitric oxide in the lower thermosphere, J. Geophys. Res. 109 (2004)
A07301.
[28] A. M. D’Amato, J. Springmann, A. A. Ali, J. W. Cutler, A. J. Ridley, D. S. Bernstein, Adaptive state estimation for nonminimum-phase
systems with uncertain harmonic inputs, in: Proc. AIAA Guid. Nav. Contr. Conf., Portland, OR, 2011, aIAA-2011-6315.
[29] G. Evensen, The ensemble kalman ﬁlter: theoretical formulation and practical implementation, Ocean Dynamics 53 (2003) 343–367.
[30] A. Caya, J. Sun, C. Snyder, A Comparison between the 4DVAR and the Ensemble Kalman Filter Techniques for Radar Data Assimilation,
Monthly Weather Rev. 133 (2005) 3081–3094.
[31] L. Ljung, Asymptotic behavior of the extended kalman ﬁlter as a parameter estimator for linear systems, IEEE Trans. Autom. Control
24 (1979) 36–50.
[32] P. L. Houtekamer, H. L. Mitchell, Data assimilation using an ensemble Kalman ﬁlter technique, Monthly Weather Review 126 (1998)
796–811.
[33] G. Evensen, Sequential data assimilation with a nonlinear quasi-geostrophic model using monte carlo methods to forecast error statistics,
J. Geophys. Res. 99 (1994) 10,143–10,162.
[34] J. L. Anderson, An ensemble adjustment Kalman ﬁlter for data assimilation, Monthly Weather Review 129 (2001) 2884–2903.
[35] G. Terejanu, P. Singla, T. Singh, P. Scott, Adaptive Gaussian Sum Filter for Nonlinear Bayesian Estimation, IEEE Transactions on
Automatic Control 56 (2011) 2151–2156.
[36] M. Kumar, S. Chakravorty, P. Singla, J. L. Junkins, The Partition of Unity Finite Element Approach with hp-reﬁnement to the Stationary
Fokker-Planck Equation, Journal of Sound and Vibration 327 (2009) 144–162.
[37] S. Julier, J. Uhlmann, H. Durrant-Whyte, A new method for the nonlinear transformation of means and covariances in ﬁlters and
estimators, IEEE Trans. Autom. Control 45 (2000) 477–482.
[38] H. C. Godinez, J. Koller, Localized adaptive inﬂation in ensemble data assimilation for a radiation belt model, Space Weather 10 (2012)
1–11, doi:10.1029/2012SW000767.
[39] S. Bhattacharyya, Observer design for linear systems with unknown inputs, IEEE Trans. Autom. Control 23 (1978) 483–484.
[40] P. K. Kitanidis, Unbiased minimum-variance linear state estimation, Automatica 23 (1987) 775–778.
[41] S. Gillijns, B. De Moor, Unbiased minimum-variance input and state estimation for linear discrete-time systems, Automatica 43 (1)
(2007) 111–116.
[42] M. Hou, P. Muller, Design of observers for linear systems with unknown inputs, IEEE Trans. Autom. Control 37 (1992) 871–875.
[43] M. E. Valcher, State observers for discrete-time linear systems with unknown inputs, IEEE Trans. Autom. Control 44 (1999) 397–401.
[44] Y. Xiong, M. Saif, Unknown disturbance inputs estimation based on a state functional observer design, Automatica 39 (2003) 1389–1398.
[45] T. Floquet, J. P. Barbot, State and unknown input estimation for linear discete-time systems, Automatica 44 (2006) 1883–1889.
[46] S. Sundaram, C. N. Hadjicostis, Delayed observers for linear systems with unknown inputs, IEEE Trans. Autom. Control 52 (2007)
334–339.
[47] H. J. Palanthandalam-Madapusi, D. S. Bernstein, Unbiased minimum-variance ﬁltering for input reconstruction, in: Proc. Amer. Cont.
Conf., New York City, NY, 2007, pp. 5712–5717.
[48] S. Kirtikar, H. Palanthandalam-Madapusi, E. Zattoni, D. S. Bernstein, l-delay input and initial-state reconstruction for discrete-time
linear systems, Circ. Sys. Sig. Processing 30 (2011) 233–262.
[49] D. Angeli, A Lyapunov approach to incremental stability properties, IEEE Trans. Autom. Control 47 (2002) 410–421.
[50] G. Russo, M. di Bernardo, E. D. Sontag, Global entrainment of transcriptional systems to periodic inputs, PLOS Computational Biology
6 (2010) 1–26.
[51] E. Sontag, Contractive systems with inputs, in: J. C. Willems, S. Hara, Y. Ohta, H. Fujioka (Eds.), Perspectives in Mathematical System
Theory, Control, and Signal Processing, Vol. 398, Springer, 2010, pp. 217–228.
[52] A. M. D’Amato, D. S. Bernstein, Adaptive forward-propagation input reconstruction for nonminimum-phase systems, in: Proc. Amer.
Contr. Conf., Montreal, 2012, pp. 598–603.
[53] National Research Council Canada, Dominion radio astrophysical observatory, [accessed 6-February-2013] (2012).
URL https://www.astrosci.ca/DAO/
[54] S. A. Billings, Identiﬁcation of nonlinear systems—a survey, IEE Proc. 127 (6) (1980) 272–285.
[55] S. Chen, S. A. Billings, Representation of nonlinear systems: The narmax model, Int. J. Contr. 49 (1989) 1013–1032.
[56] S. Chen, S. A. Billings, C. F. N. Cowan, P. M. Grant, Practical identication of narmax models using radial basis function, Int. J. Contr.
52 (1990) 1327–1350.
[57] H. L. Wei, S. A. Billings, M. A. Balikhin, Wavelet based non-parametric narx models for nonlinear inputoutput system identiﬁcation,
International Journal of Systems Science 37 (2006) 1089–1096.
[58] M. A. Balikhin, R. J. Boynton, S. A. Billings, M. Gedalin, N. Ganushkina, D. Coca, H. Wei, Data based quest for solar wind—
magnetosphere coupling function, J. Geophysical Res. 37, doi:10.1029/2010GL045733.
[59] R. J. Boynton, M. A. Balikhin, S. A. Billings, H. L. Wei, N. Ganushkina, Using the NARMAX OLS-ERR algorithm to obtain the most
inﬂuential coupling functions that aﬀect the evolution of the magnetosphere, J. Geophysical Res. 116, doi:10.1029/2010JA015505.
[60] M. A. Balikhin, R. J. Boynton, S. N. Walker, J. E. Borovsky, S. A. Billings, H. L. Wei, Using the NARMAX approach to model the
evolution of energetic electrons ﬂuxes at geostationary orbit, J. Geophysical Res. 38, doi:10.1029/2011GL048980.
[61] J. Yan, A. M. D’Amato, D. S. Bernstein, Retrospective-cost adaptive control of uncertain hammerstein systems using a narmax controller
structure, in: Proc. AIAA Guid. Nav. Contr. Conf., Minneapolis, MN, 2012, AIAA-2012-4448-132.

