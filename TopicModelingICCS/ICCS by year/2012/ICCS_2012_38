Available online at www.sciencedirect.com

Procedia Computer Science 9 (2012) 764 – 773
www.elsevier.com/locate/procedia

International Conference on Computational Science, ICCS 2012

Knowledge-Based Response Correction and Adaptive Design
Specifications for Microwave Design Optimization
Slawomir Koziela*, Stanislav Ogurtsova, and Leifur Leifssona
a

Engineering Optimization & Modeling Center, School of Science and Engineering, Reykjavik University, Menntavegur 1, 101 Reykjavik, Iceland

Abstract
Simulation-based optimization has become an important design tool in microwave engineering. Yet, employing electromagnetic (EM)
solvers in the design process is a challenging task, primarily due to a high-computational cost of an accurate EM simulation. This paper
is focused on efficient EM-driven design optimization techniques that utilize physically-based low-fidelity models, normally based on
coarse-discretization EM simulations. The presented methods attempt to exploit as much of the knowledge about the system or device of
interest embedded in the low-fidelity model as possible, so as to reduce the computational cost of the design process. Unlike many other
surrogate-based approaches, the techniques discussed here are non-parametric ones, i.e., they are not based on analytical formulas. The
paper presents several specific methods, including those based on correcting the low-fidelity model response (adaptive response
correction and shape-preserving response prediction), as well as on suitable modification of the design specifications. Formulations,
application examples and the discussion of advantages and disadvantages of these techniques are also included.
Keywords: Simulation-driven design, microwave engineering, electromagnetic simulation, antenna design, surrogate models.

1. Introduction
Electromagnetic (EM) simulation has become an inherent part of contemporary microwave design process. It is
used for verification purposes, but also, more and more often, to adjust the designable parameters of the structure under
consideration so that given performance specifications are met. The EM-simulation-driven design is actually a must for
the growing number of devices, where systematic design procedures or design-ready theoretical models are not
sufficiently accurate, including substrate-integrated circuits [1], ultrawideband antennas [2] or dielectric resonator
antennas [3]. EM-based design optimization is a challenging task though. Probably the biggest obstacle is the high
computational cost of accurate full-wave simulation, which makes the use of conventional optimization algorithms
prohibitive as these techniques require a large numbers of EM simulations. Another issue is the numerical noise that is
inherent to EM simulation, particularly if the solver uses adaptive meshing. These problems can be alleviated to some
extent by using adjoint sensitivities [4] that have recently become available in some major commercial EM solvers [5],
[6]. In general, robust automated and computationally efficient EM-based optimization is still an open problem. In
practice, the most common simulation-driven design approach is to perform parameter sweeps guided by engineering
experience. This is, however, tedious and does not guarantee optimal results.
* Corresponding author. Tel.: +354-599-6376 ; fax: +354-599-6489; E-mail address: koziel@ru.is

1877-0509 © 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
doi:10.1016/j.procs.2012.04.082

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

765

A number of techniques for modeling and simulation-driven design of microwave structures have emerged over the
recent years including the methods that exploit artificial neural networks [7], [8], fuzzy systems [9], or kriging [10], as
well as surrogate-based techniques such as space mapping (SM) [11]-[16], simulation-based tuning [17], [18], and
combination of both [19], [20]. The last three approaches offer computationally efficient design optimization where,
under certain circumstances, a satisfactory design can be obtained after a few high-fidelity (or fine) EM simulations of
the structure of interest [11]. SM and tuning SM (TSM) [19], exploit physically-based low-fidelity (or coarse) model
that is a basis to build a surrogate model computationally cheap and yet reasonably accurate representation of the fine
model. The surrogate is iteratively updated and re-optimized instead of optimizing the fine model directly [11]. SM and
TSM are both potentially very efficient, but these methods may not be straightforward to implement and automate [12],
which, so far, is a limitation for their widespread use by the researchers and designers.
Probably the simplest way of exploiting physically-based coarse model to perform efficient design optimization
is through correction of the coarse model response in order to obtain zero- and (in some cases) first-order
consistency [21] between the surrogate and the fine model. The corrected coarse model becomes a reliable
prediction tool that can be used to find approximate optimum of the fine model. Several methods exploiting this
approach have been proposed in microwave engineering recently including manifold mapping (MM) [22] and multipoint response correction [23]. Formally, output SM [11] and its variations [23] also belong to this group, as well as
the neuro-space mapping techniques [8]. All of these techniques can be categorized as parametric response
correction methods, because the adjustment of the low-fidelity model is realized by means of explicit formulas,
parameters of which can be calculated using available low- and high-fidelity model data.
This paper is focused on non-parametric approaches that allow us to fully exploit the knowledge about the
structure of interest embedded in the low-fidelity model. The techniques such as adaptive response correction (ARC)
[24] and shape-preserving response prediction (SPRP) [25] do not use explicit parameters. They utilize relationships
between the low- and high-fidelity model responses as functions of the design variables, not just their value at
specific designs, which normally results in much better generalization capability when compared to parametric
approaches. The adaptively adjusted design specifications (AADS) technique [26] is based on a similar idea. In
AADS, however, the relationship between the low- and high-fidelity models is reflected in proper modification of
the design specifications without directly adjusting the low-fidelity model itself, which makes this method extremely
simple to implement and yet robust.
Here, we recall the response correction concept as well as the formulation of the optimization algorithm exploiting a
corrected low-fidelity model. We focus on the non-parametric correction techniques, however, for the sake of the paper
being self-contained, parametric approaches are recalled as well. Additionally, we discuss the adaptively adjusted design
specification method. All the techniques presented here are illustrated using representative microwave design examples.
2. Design Optimization Using Response-Corrected Physically-Based Coarse Models
The design optimization task can be formulated as a following minimization problem
x*f

arg min U R f ( x )

(1)

x

where Rf Rm denotes the response vector of a fine model of the device of interest evaluated through high-fidelity EM
simulation; x is a vector of design parameters. The response Rf(x) might be, e.g., the modulus of the reflection coefficient
|S11| evaluated at m different frequencies. U is a given scalar merit function, e.g., a norm, or a minimax function with upper
and lower specifications; xf* is the optimal design to be determined. It is assumed that Rf is evaluated through
computationally expensive EM simulation so that solving (1) directly may be impractical.
Let Rc(x) Rm be the response vector of the coarse model of the structure of interest, i.e., computationally cheap but
less accurate representation of the fine model. It is also assumed that the coarse model is physically based so that it
Rf. Typical examples include equivalent circuits or coarse-discretization
EM models. The coarse model can be used to construct a surrogate Rs of the fine model so that an approximate solution to
(1) can be obtained by optimizing Rs instead of Rf. In particular, the surrogate can be obtained as follows:
Rs ( x) C ( Rc ( x))

where C : Rm

Rm is a response correction function.

(2)

766

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

Typically, the optimization process involving surrogates is performed in an iterative manner so that the sequence x(1),
x , ..., of (hopefully) better and better approximations to xf* are obtained as
(2)

x (i

1)

arg min U Rs(i ) ( x )

(3)

x

with Rs(i) being the surrogate model at iteration i. Here, Rs(i)(x) = C(i)(Rc(x)), where C(i) is the correction function at iteration
i. For surrogates constructed using response correction, we typically request that at least zero-order consistency between
the surrogate and the fine model is satisfied, i.e., Rs(i)(x(i)) = Rf(x(i)). It can be shown [27] that satisfaction of first-order
consistency, i.e., J[Rs(i)(x(i))] = J[Rf(x(i))] (here, J[·] denotes the Jacobian of the respective model), guarantees convergence
of {x(i)} to a local optimum of Rf assuming that (3) is enhanced by the trust region mechanism [28] and the functions
involved are sufficiently smooth.
Response correction approaches can be roughly categorized into parametric techniques, where the response correction
function (2) can be represented using explicit formulas, and non-parametric ones, where the response correction is defined
implicitly through certain relations between the coarse and fine models which may not have any compact analytical form.
Output space mapping [11], [12], manifold mapping [22], and multi-point response correction [23] belong to the first
group. We describe them briefly in Section 3. The second group includes adaptive response correction [24] and shapepreserving response prediction [25] and is presented in detail in Section 4.
3. Parametric Response Correction Techniques for Microwave Optimization
In this section, we briefly review several parametric response correction techniques that have been recently developed
and applied in simulation-driven microwave optimization. More specifically, we discuss several variations of output space
mapping (OSM) [12], manifold mapping (MM) [22], as well as mention multi-point response correction [23].
The simplest realization of the response correction is output SM [11], where
Rs(i ) ( x)

Rc ( x) d (i )

(4)

Here, d(i) = Rf(x(i)) Rc(x(i)), which ensures zero-order consistency. Note that this way of creating the surrogate model is
only based on the fine model response at the most current iteration point x(i). Typically, output SM is used as a supplement
for other SM techniques [15]. Provided that the coarse model is sufficiently accurate, output SM can, also, work as a
stand-alone technique [15].
The model (4) can be enhanced as follows:
Rs(i ) ( x)

Rc ( x) d (i )

E (i ) ( x x (i ) )

(5)

where d(i) is as in (4) and E(i) = J[Rf(x(i)) Rc(x(i))], which ensures first-order consistency. Alternatively, Jacobian of
Rf(x(i)) Rc(x(i)) can be replaced by a suitable approximation obtained using, e.g., Broyden update [29]. As before,
the model (5) is normally used as a supplement but it can, also, work as a stand-alone technique, particularly when
the algorithm (3) is enhanced by a trust-region approach [28], [30].
The response correction model can be defined by explicitly using most of the available fine model data. According
to the manifold mapping (MM) approach [22], the surrogate model is defined as
Rs(i ) ( x)

R f ( x (i ) ) S (i ) Rc ( x) Rc ( x (i ) )

(6)

with S(i) being the m m correction matrix S(i) = F C where F = [Rf(x(i)) Rf(x(i 1)
Rf(x(i)) Rf(x(max{i n,0}))] and C
(i)
(i 1)
(i)
(max{i n,0})
= [Rc(x ) Rc(x
Rc(x ) Rc(x
)]. The pseudoinverse, denoted by , is defined as C = V C( C) (U C )T,
where U C, C, and V C are the factors in the singular value decomposition of C. The matrix C is the result of
inverting the nonzero entries in C, leaving the zeroes invariant [22]. Although MM does not explicitly use sensitivity
information, the surrogate and the fine model Jacobians become more and more similar to each other towards the end of
the MM optimization process (i.e., when ||x(i) x(i 1)|| 0) so that the surrogate (approximately) satisfies both zero- and
first-order consistency conditions [21] with Rf. This allows for a more accurate location of the fine model optimum.
Another way of generalizing output SM in order to exploit as much of available fine model data as possible is
multi-point response correction [23]. We omit the formulation details here for the sake of brevity.

767

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

4. Exploiting Maximum Knowledge: Non-Parametric Response Correction Techniques
In this section, we describe non-parametric response correction techniques. Here, the surrogate model is defined
implicitly through certain relations between the coarse and fine models which may not have any compact analytical
form. On the other hand, non-parametric correction is able in many cases to better exploit the knowledge about
the system embedded in the coarse model than the parametric one. We discuss the following approaches: adaptive
response correction [24], and shape-preserving response prediction [25].
4.1. Adaptive Response Correction
Adaptive response correction (ARC) is a generalization of output SM, which makes the correction term designvariable-dependent so that we have
Rs(i ) ( x)

Rc ( x)

r

( ,

(i )

(7)

)

where r(x(i),x(i)) = d(i) = Rf(x(i)) Rc(x(i)) i.e., a zero-order consistency condition is satisfied at x(i). A characteristic
feature of ARC is that the correction term is determined in such a way that this modification reflects the changes of Rc
during the process of surrogate model optimization. In particular, if the response of Rc shifts or changes its shape with
respect to a free parameter (typically, the signal frequency), the response correction term should track these changes.
The concept of ARC is best explained by an example. Consider a wideband bandstop microstrip filter [31] shown in
Fig. 1. Figure 2 shows the fine and coarse (in fact, we use a space-mapped coarse model response here [24]) at two
different designs, as well as the corresponding output SM terms d. It can be observed that the (frequency-wise) changes of
the output SM correction term correspond to the changes of the coarse/fine model responses. These changes can be
tracked by performing suitable frequency scaling of the coarse model response and then applied to the original correction
term. This is illustrated in Fig. 3, where the original output SM correction term (at certain design x(0)), as well as the
predicted one (at other design x(1)) obtained using the frequency scaling function determined by tracking the coarse model
response changes, are shown. A rigorous formulation of ARC can be found in [24]; it is omitted here for the sake of
brevity. Figure 4 shows the results of optimizing the surrogate model using the output SM correction (Fig. 4(a)) and ARC
(Fig. 4(b)). The optimized surrogate model design in Fig. 4(a) is not as good as that in Fig. 4(b) because the constant
output SM correction terms causes a significant distortion of the model response while moving away from x(0).
Table 1 shows the results of optimizing the bandstop filter in Fig. 1 using the surrogate model based on output SM and
ARC. The latter technique is able to yield a better result using only three fine model evaluations, whereas the optimization
cost with output SM is eight fine model evaluations. Figure 5 shows the fine model response at the final design obtained
with ARC.
Gc

Wc

Output

Input

Term 1
Z=50 Ohm

MLIN
TL1
W=W0 mm
L=L0 mm

MLIN
TL2
W=W0 mm
L=L0 mm

Lc

Term 2
Z=50 Ohm

MCLIN
Clin1
W=Wc mm
S=Gc mm
L=Lc mm
MTEE
Tee1
W1=Wc mm
W2=Wc mm
W3=Wr mm

Lr

MLOC
TL3
W=Wr mm
L=Lr mm

Wr
(a)
Fig. 1. Wideband bandstop filter [31]: (a) geometry, (b) coarse model (Agilent ADS).

(b)

Table 1: Optimization results for the wideband bandstop microstrip filter

*

Surrogate Model

Final Specification Error [dB]

Number of Fine Model Evaluations*

Standard Output Space Mapping
Adaptive Response Correction

1.1
2.1

8
3

Excludes the fine model evaluation at the starting point.

768

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773
0
20

-10

10

|S21|

|S21|

-20
-30

0

-40

-10

-50

-20
2

4

6
8
frequency [GHz]

10

2

4

6
8
frequency [GHz]

10

(a)
(b)
Fig. 2. Wideband bandstop filter: (a) fine (solid line) and coarse model (dashed line) responses at certain design, as well as the fine (solid line
with circle markers) and coarse model (dashed line with circle markers) responses at a different design; (b) standard output SM correction terms
corresponding to responses shown in Fig. 2.
Scaled Frequency [GHz]

20

|S21|

10
0
-10
-20

2

4

6
8
frequency [GHz]

10
8
6
4
2

10

2

4
6
8
Original Frequency [GHz]

10

(a)
(b)
Fig. 3. (a) Correction terms at certain design x(0), r(x(0), x(0)), (solid line), and at the other design x(1), r(x(1), x(0)) (dashed line). Plots obtained for the
adaptive response correction method; (b) The frequency scaling function used to obtain the dashed line in Fig. 4 (solid line). The scaling accounts for
the changes (in frequency) of the coarse model response while going from x(0) to x(1). The identity function plot is shown as dashed line.
0
10
-10

0

-20

|S21|

|S21|

-10
-20

-30

-30
-40

-40

-50
2

4

6
8
frequency [GHz]

-50

10

2

4

6
8
frequency [GHz]

10

(a)
(b)
Fig. 4. Wideband bandstop filter: (a) initial (solid line) and optimized (dashed line) surrogate model response when output SM is used to create
the surrogate; (b) initial (solid line) and optimized (dashed line) surrogate model response when ARC is used to create the surrogate. The plots in
(b) correspond to x(0) and x(1) in Fig. 5.
0
-10

|S21|

-20
-30
-40
-50

2

4

6
8
frequency [GHz]

10

Fig. 5. Wideband bandstop filter: fine model response at the design found by the adaptive response correction technique.

769

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

4.2. Shape-Preserving Response Prediction
Shape-preserving response prediction (SPRP) [25] is one of the most recent non-parametric response correction
techniques. SPRP constructs the surrogate model assuming that the change of the fine model response due to the
adjustment of the design variables can be predicted using the actual changes of the coarse model response. Therefore, it
is critically important that the coarse model is physically based, which ensures that the effect of the design parameter
variations on the model response is similar for both the fine and coarse models. The change of the coarse model
response is described by the translation vectors corresponding to certain (finite) number of characteristic points of the

0

0

-10

-10

-20

-20

|S21| [dB]

|S21| [dB]

with the actual response of Rf at the current iteration point, Rf(x(i)), used as a reference.
Figure 6(a) shows an example coarse model response, |S21| in the frequency range 8 GHz to 18 GHz, at the design x(i),
as well as a coarse model response at some other design x. The responses come from the double folded stub bandstop filter
example considered in [25]. Circles denote characteristic points of Rc(x(i)), here, selected to represent |S21| = 3 dB, |S21| =
20 dB, and the local |S21| maximum (at about 13 GHz). Squares denote corresponding characteristic points for Rc(x), while
Rc when changing the design
variables from x(i) to x. Because the coarse model is physically-based, the fine model response at a given design, here, x,
can be predicted using the same translation vectors applied to the corresponding characteristic points of the fine model
response at x(i), Rf(x(i)). This is illustrated in Fig. 6(b). Note that SPRP surrogate model does not explicitly use any
parameters, which makes it easy to implement. A rigorous formulation of SPRP can be found in [25].
As an illustration, consider the dual-band bandpass filter [32] (Fig. 7(a)). The design parameters are x = [L1 L2 S1
3 dB for
S2 S3 d g W]T mm. The fine model is simulated in Sonnet em [33]. The design specifications are |S21|
0.95 GHz and 1.75 GHz
1.85 GHz, and |S21|
20 dB for 0.5 GHz
0.7 GHz, 1.1 GHz
0.85 GHz
1.6 GHz and 2.0 GHz
2.2 GHz. The coarse model is implemented in Agilent ADS [34] (Fig. 7(b)). The
initial design is x(0) = [16.14 17.28 1.16 0.38 1.18 0.98 0.98 0.20]T mm (the optimal solution of Rc). The following
characteristic points are selected to set up the SPRP model: four points for which |S21| = 20 dB, four points with
|S21| = 5 dB, as well as 6 additional points located between 5 dB points.
For the purpose of optimization, the coarse model was enhanced by tuning the dielectric constants and the substrate
heights of the microstrip models corresponding to the design variables L1, L2, d and g (original values of r and H were
10.2 and 0.635 mm, respectively). The filter was optimized using shape-preserving response prediction, space mapping
and adaptive response correction.
Table 2 shows the optimization results. SPRP was compared to output SM as well as ARC. All of the considered
methods were able to yield solutions satisfying the design specifications, which is mostly because of using the
enhanced coarse model. However, the quality of the designs produced by SPRP better than the quality the designs
yielded by other methods. Also, computational cost of SPRP is lower than that of other approaches, particularly
output SM. Figure 8 shows the initial fine model response as well as the fine model response at the design obtained
using SPRP.

-30
-40
-50

-30
-40
-50

8

10

12
14
Frequency [GHz]

16

18

8

10

12
14
Frequency [GHz]

16

18

(a)
(b)
Fig. 6. SPRP concept: (a) Example coarse model response at the design x(i), Rc(x(i)) (solid line), the coarse model response at x, Rc(x) (dotted
(i)
line), characteristic points of Rc(x ) (circles) and Rc(x) (squares), and the translation vectors (short lines); (b) Fine model response at x(i), Rf(x(i))
(solid line) and the predicted fine model response at x (dotted line) obtained using SPRP based on characteristic points of Fig. 6(a); characteristic points of
Rf(x(i)) (circles) and the translation vectors (short lines) were used to find the characteristic points (squares) of the predicted fine model response; coarse
model responses Rc(x(i)) and Rc(x) are plotted using thin solid and dotted line, respectively [25].

770

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

S2
L1

MCLIN
CLin1
W=W mm
S=S1 mm
L=L1 mm

L2

L2

.

g

S1

Term 1
Z=50 Ohm

d
S3

MCLIN
MLIN
CLin2
TL2
W=W mm
W=W mm
S=S2 mm
L=L2-L1+d mm
L=L2 mm

MLIN
TL1
W=W mm
L=L0 mm

W

Input

MCLIN
CLin4
W=W mm
S=S1 mm
L=L1 mm

Output

MLIN
TL3
W=W mm
L=L2-d mm

MCLIN
CLin3
W=W mm
S=S2 mm
L=L2 mm

MGAP
Gap1
W=W mm
S=g mm

MCLIN
CLin5
W=W mm
S=S3 mm
L=L2/2-g mm

MCLIN
CLin6
W=W mm
S=S3 mm
L=L2/2 mm

MGAP
Gap2
W=W mm
S=g mm

(a)
Fig. 7. Dual-band bandpass filter: (a) geometry [32], (b) coarse model (Agilent ADS).

.

MLIN
TL5
W=W mm
L=L2-L1+d mm

MLIN
TL6
W=W mm
L=L0 mm

MLIN
TL4
W=W mm
L=L2-d mm

Term 2
Z=50 Ohm

(b)

0
|S21| [dB]

-10
-20
-30
-40
-50

0.6

0.8

1

1.2
1.4
1.6
1.8
2
2.2
Frequency [GHz]
Fig. 8. Dual-band bandpass filter: fine model (dashed line) and coarse model (thin dashed line) response at x(0), and the optimized fine model response
(solid line) at the design obtained using shape-preserving response prediction.

Table 2: Optimization results for dual-band bandpass filter
Algorithm
Final Specification Error [dB]
Output SM2
1.4
Output SM2 + ISM3
1.9
ARC [24]
1.8
ARC [24] + ISM3
1.5
SPRP
2.0
SPRP + ISM3
1.9
1
Excludes the fine model evaluation at the starting point.
2
The surrogate model is of the form Rs(i)(x) = Rc(x) + [Rf(x(i)) - Rc(x(i))].
3
The surrogate model is of the form Rs(i)(x) = Rc(x + c(i)); c(i) found using parameter extraction [11].

Number of Fine Model Evaluations1
8
8
3
4
3
2

5. Exploiting Maximum Knowledge: Adaptively Adjusted Design Specifications
It is not necessary to remove the discrepancies between the low- and high-fidelity models by correcting the lowspecifications. In microwave engineering, most of the design tasks can be formulated as minimax problems with
upper and lower specifications and it is easy to implement modifications by, for example, shifting the specification
levels, corresponding frequency bands. This approach, both easy to implement and efficient, is exploited by
adaptively adjusted design specifications (AADS) technique [26] described in this section. AADS consists of the
following two simple steps that can be iterated if necessary:
1. Modify the original design specifications in order to take into account the difference between the responses of Rf and
Rc at their characteristic points.
2. Obtain a new design by optimizing the coarse model with respect to the modified specifications.
Characteristic points of the responses should correspond to the design specification levels. They should also include
local maxima/minima of the respective responses at which the specifications may not be satisfied. Figure 9(b) shows
characteristic points of Rf and Rc for our bandstop filter example. The points correspond to 3 dB and 30 dB levels as
well to the local maxima of the responses. As one can observe in Fig. 9(b) the selection of points is rather straightforward.
In the first step of AADS optimization procedure, the design specifications are modified (or mapped) so that the level
of satisfying/violating the modified specifications by the coarse model response corresponds to the satisfaction/violation

771

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

0

0

-20

-20

-20

-40
8

10
12
14
16
Frequency [GHz]

18

|S21| [dB]

0

|S21| [dB]

|S21| [dB]

levels of the original specifications by the fine model response. More specifically, for each edge of the specification line,
the edge frequency is shifted by the difference of the frequencies of the corresponding characteristic points, e.g., the left
edge of the specification line of 30 dB is moved to the right by about 0.7 GHz, which is equal to the length of the line
connecting the corresponding characteristic points in Fig. 9(b). Similarly, the specification levels are shifted by the
difference between the local maxima/minima values for the respective points, e.g., the 30 dB level is shifted down by
about 8.5 dB because of the difference of the local maxima of the corresponding characteristic points of Rf and Rc.
Modified design specifications are shown in Fig. 9(c). The coarse model is subsequently optimized with respect to the
modified specifications and the new design obtained this way is treated as an approximated solution to the original design
problem (i.e., optimization of the fine model with respect to the original specifications). Steps 1 and 2 can be repeated if
necessary. As demonstrated later, substantial design improvement is typically observed after the first iteration, however,
additional iterations may bring further enhancement.
An important prerequisite of AADS is that the coarse model is physics-based, in particular, the adjustment of the design
variables has similar effect on the response for both Rf and Rc. In such a case the coarse model design that is obtained in
the second stage of the AADS procedure (i.e., optimal with respect to the modified specifications) will be (almost) optimal
for Rf with respect to the original specifications. As shown in Fig. 9, the absolute matching between the models is not as
important as the shape similarity. If the similarity between the fine and coarse model response is not sufficient the AADS
technique may not work well. A generalized version of AADS that alleviates this difficulty can be found in [26].
As an illustration that demonstrate operation and efficiency of AADS, consider the second example, consider the
bandpass microstrip filter with open stub inverter [35] (Fig. 10(a)). The design parameters are
20dB for
x = [L1 L2 L3 S1 S2 W1]T. The fine model is simulated in FEKO [36]. The design specifications are |S21|
1.5GHz
1.8GHz, |S21|
3dB for 1.95GHz
2.05GHz and |S21|
20dB for 2.2GHz
2.5GHz. The
coarse model is implemented in Agilent ADS [34] (Fig. 10(b)). The initial design is the coarse model optimal
solution x(0) = [25.00 5.00 1.221 0.652 0.187 0.100]T mm (specification error +15.7 dB).
The first iteration of AADS already yields a design satisfying the specifications, x(1) = [23.79 5.00 1.00 0.694
0.192 0.10]T mm (specification error 0.6 dB). After the second iteration, the design was further improved to
x(2) = [23.68 5.00 1.00 0.717 0.193 0.10]T mm (specification error 1.7 dB). Figure 11 shows the fine and coarse
model responses at x(0) and the fine model response at the final design. For the sake of comparison, the filter was
also optimized using the frequency SM algorithm. The design obtained in three iterations, [23.66 5.00 1.00 0.654
0.188 0.100]T mm, satisfies the design specifications, however, it is not as good at the one obtained using the
procedure proposed in this work (specification error 0.8 dB).

-40
8

10
12
14
16
Frequency [GHz]

-40

18

8

10
12
14
16
Frequency [GHz]

18

(a)
(b)
(c)
Fig. 9. Bandstop filter example (responses of Rf and Rc are marked with solid and dashed line, respectively): (a) responses of Rf and Rc at the initial design
(optimum of Rc) as well as the original design specifications, (b) characteristic points of the responses corresponding to the specification levels (here, 3 dB
and 30 dB) and to the local response maxima, (c) responses of Rf and Rc at the initial design and the modified design specifications.
S2

S2

W 1 S1

Term 1
Z=50 Ohm

Input

MLIN
TL1
W=W mm
L=L0 mm

L2
L3

L1

L3
Output
W1

MCLIN
CLin1
W=W mm
S=S2 mm
L=L1 mm
MLOC
TL2
W=W mm
L=1E-9 mm

MLOC
TL3
W=W mm
L=1E-9 mm
MLOC
TL5
W=W mm
L=L2 mm
MLIN
TL4
W=W mm
L=L3 mm

MLOC
TL7
W=W mm
L=1E-9 mm

MLIN
TL6
W=W mm
L=L3 mm
MTEE
Tee1
W1=W mm
W2=W mm
W3=W1 mm

(a)
(b)
Fig. 10. Bandpass filter with open stub inverter: (a) geometry [35], (b) coarse model (Agilent ADS).

MTEE
Tee2
W1=W mm
W2=W mm
W3=W1 mm
MLIN
MCLIN
TL11
CLin2
W=W mm MLOC W=W mm
S=S1 mm TL10 L=L3 mm
L=L1 mm W=W mm
L=L2 mm
MLOC
TL8
MLOC
W=W mm
TL12
L=1E-9 mm
W=W mm
L=1E-9 mm
MLIN
TL9
W=W mm
L=L3 mm

MLOC
TL13
W=W mm
L=1E-9 mm
MCLIN
CLin3
W=W mm
S=S2 mm
L=L1 mm
MLIN
TL14
W=W mm
Term 2
L=L0 mm
Z=50 Ohm

772

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773

0

|S21| [dB]

-5
-10
-15
-20
-25
-30
1.7

1.8

1.9
2
2.1
Frequency [GHz]

2.2

Fig. 11. Bandpass filter with open stub inverter: Rf response (solid line) at the final design obtained after two iterations of our optimization
procedure; fine (dashed line) and coarse (dotted line) model responses at the initial design.

6. Discussion and Recommendations
Here, we attempt to give a qualitative comparison of knowledge-based design techniques presented in this paper,
as well as formulate some guidelines and recommendations for the readers interested in applying these methods in
their research and/or design work. The main factors are the complexity of implementation, computational efficiency,
robustness, as well as the range of applications.
In terms of implementation, the parametric response correction techniques are very straightforward. Output space
mapping, manifold mapping and multi-point response correction construct the surrogate model by using analytical
formulas, therefore, they are easy to implement. Non-parametric methods may be more involved because the
surrogate models are constructed by considering some auxiliary quantities such as scaling functions (adaptive
response correction) or characteristic points and translation vectors (SPRP), which generally depend on the response
shape. Also, in SPRP, the user is responsible for defining the characteristic points on case-to-case basis. On the other
hand, the AADS approach described in Section 5 is probably the easiest to implement out of all the methods
considered in this work.
In terms of computational complexity, non-parametric methods prove to be more efficient. The reason is that
both ARC and SPRP, as well as AADS, exploit the knowledge embedded in the low-fidelity model to a larger extent
than the parametric methods which only do a local model alignment. As indicated by the examples, ARC and SPRP
are capable of yielding a satisfactory design after two or three iterations, whereas output SM or MM typically
require more iterations. On the other hand, parametric techniques tend to be more robust, particularly when
embedded in the trust-region framework which improves their convergence properties. Also, the use of (even
approximated) fine model sensitivity improves their ability to locate the fine model optimum accurately. Parametric
techniques are also more generic than ARC, SPRP and AADS. For the latter, some considerations are necessary in
order to select a proper realization of the scaling function (ARC), the definition of the characteristic points (SPRP),
or the analysis of the model responses to properly modify design specifications (AADS). Also, the SPRP technique
assumes one-to-one correspondence between characteristic points of the coarse and fine models at all considered
design, which may be difficult to satisfy for certain problems.
Based on the above remarks, parametric methods, particularly output SM, are recommended for less experienced
users, and when the underlying coarse model is relatively fast (e.g., equivalent circuit). More experienced users are
encouraged to try either ARC or SPRP, particularly if the available coarse model is relatively expensive (e.g.,
obtained from coarse-discretization EM simulation). AADS, because of its simplicity, can be readily used by both
experienced and novice users; in general, it tends to be more reliable when the coarse model is more accurate (e.g.,
obtained through coarse-discretization EM simulation). In either case, the quality of the coarse model is one of the
key factors, therefore its preconditioning using any space mapping transformation is recommended.
References
1.
2.
3.

Wu, K., Substrate Integrated Circuits (SiCs) A new paradigm for future Ghz and Thz electronic and photonic systems IEEE Circuits and
Systems Society Newsletter, vol. 3, p. 1, 2009.
Schantz, H. The art and science of ultrawideband antennas, Artech House, 2005.
Petosa, A., Dielectric Resonator Antenna Handbook, Artech House, 2007.

Slawomir Koziel et al. / Procedia Computer Science 9 (2012) 764 – 773
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
37.
38.

773

Nikolova, N.K., Li, Y., Li, Y., and Bakr, M.H., Sensitivity analysis of scattering parameters with electromagnetic time-domain simulators
IEEE Trans. Microwave Theory Tech., vol. 54, pp. 1598-1610, 2006.
CST Microwave Studio, CST AG, Bad Nauheimer Str. 19, D-64289 Darmstadt, Germany, 2011.
HFSS, release 13.0, ANSYS, 2010.
Kabir, H., Wang, Y., Yu, M., and Zhang, Q.J. Neural network inverse modeling and applications to microwave filter design IEEE Trans.
Microwave Theory Tech., vol. 56, pp. 867-879, 2008.
Zhang, L., Zhang, Q. J., and Wood, J., Statistical neuro-space mapping technique for large-signal modeling of nonlinear devices IEEE
Trans. Microwave Theory Tech., vol. 56, pp. 2453-2467, 2008.
Miraftab, V., and Mansour, R.R., EM-based microwave circuit design using fuzzy logic techniques IEE Proc. Microwaves, Antennas &
Propagation, vol. 153, pp. 495-501, 2006.
Couckuyt, I., Declercq, F., Dhaene, T., Rogier, H., and Knockaert, L., Surrogate-based infill optimization applied to electromagnetic
problems Int. J. RF and Microwave CAE, vol. 20, pp. 492-501, 2010.
Bandler, J.W., Cheng, Q.S., Dakroury, S.A., Mohamed, A.S., Bakr, M.H., Madsen, K., and Sondergaard, J. Space mapping: the state of the
art IEEE Trans. Microwave Theory Tech., vol. 52, pp. 337-361, 2004.
Koziel S., Bandler J.W., and Madsen, K. A space mapping framework for engineering optimization: theory and implementation IEEE
Trans. Microwave Theory Tech., vol. 54, pp. 3721-3730, 2006.
Amari, S., LeDrew, C., and Menzel, W. Space-mapping optimization of planar coupled-resonator microwave filters
IEEE Trans.
Microwave Theory Tech., vol. 54, pp. 2153-2159, 2006.
Ismail, M.A., Smith, D., Panariello, A., Wang, Y., and Yu, M. EM-based design of large-scale dielectric-resonator filters and multiplexers
by space mapping IEEE Trans. Microwave Theory Tech., vol. 52, pp. 386-392, 2004.
Koziel, S., Cheng, Q.S., and Bandler, J.W. Space mapping IEEE Microwave Magazine, vol. 9, pp. 105-122, 2008.
Quyang, J., Yang, F., Zhou, H., Nie, Z., and Zhao, Z. Conformal antenna optimization with space mapping J. of Electromagn. Waves and
Appl., vol. 24, pp. 251-260, 2010.
Rautio, J.C. Perfectly calibrated internal ports in EM analysis of planar circuits IEEE MTT-S Int. Microwave Symp. Dig., Atlanta, GA, pp.
1373-1376, 2008.
Swanson, D., and Macchiarella, G. Microwave filter design by synthesis and optimization IEEE Microwave Magazine, 8, pp. 55-69, 2007.
Cheng, Q.S., Rautio, J.C., Bandler, J.W., and Koziel, S. Progress in simulator-based tuning the art of tuning space mapping IEEE
Microwave Magazine, vol. 11, pp. 96-110, 2010.
Koziel, S., Meng, J., Bandler, J.W., Bakr, M.H., and Cheng, Q.S. Accelerated microwave design optimization with tuning space mapping
IEEE Trans. Microwave Theory and Tech., vol. 57, pp. 383-394, 2009.
Alexandrov, N.M., and Lewis, R.M. An overview of first-order model management for engineering optimization Optimization and
Engineering, vol. 2, pp. 413-430, 2001.
Echeverria, D., and Hemker, P.W. Space mapping and defect correction CMAM The International Mathematical Journal Computational
Methods in Applied Mathematics, vol. 5, pp.107-136, 2005.
Koziel, S. Improved microwave circuit design using multipoint-response-correction space mapping and trust regions Int. Symp. Antenna
Technology and Applied Electromagnetics, ANTEM 2010, Ottawa, Canada, 2010.
Koziel, S., Bandler, J.W., and Madsen, K. Space mapping with adaptive response correction for microwave design optimization IEEE
Trans. Microwave Theory Tech., vol. 57, pp. 478-486, 2009.
Koziel, S. Shape-preserving response prediction for microwave design optimization IEEE Trans. Microwave Theory and Tech., vol. 58,
pp. 2829-2837, 2010.
Koziel, S. Adaptively adjusted design specifications for efficient optimization of microwave structures Progress in Electromagnetic
Research B (PIER B), vol. 21, pp. 219-234, 2010.
Alexandrov, N.M., Dennis, J.E., Lewis, R.M., and Torczon, V. A trust region framework for managing use of approximation models in
optimization Struct. Multidisciplinary Optim., vol. 15, pp. 16-23, 1998.
Conn, A.R., Gould, N.I.M., and Toint, P.L., Trust Region Methods, MPS-SIAM Series on Optimization, 2000.
Broyden, C.G., A class of methods for solving nonlinear simultaneous equations Math. Comp., vol. 19, pp. 577-593, 1965.
Koziel, S., Bandler, J.W., and Cheng, Q.S. Robust trust-region space-mapping algorithms for microwave design optimization IEEE
Trans. Microwave Theory and Tech., vol. 58, pp. 2166-2174, 2010.
Hsieh, M.Y., and Wang, S.M. Compact and wideband microstrip bandstop filter IEEE Microwave and Wireless Component Letters, vol.
15, pp. 472-474, 2005.
Guan, X., Ma, Z., Cai, P., Anada, T., and Hagiwara, G., A microstrip dual-band bandpass filter with reduced size and improved stopband
Microwave and Opt. Tech. Lett., vol. 50, pp. 618-620, 2008.
Sonnet Software, Inc., em TM Version 12.54, 100 Elwood Davis Road, North Syracuse, NY 13212, USA, 2010.
Agilent ADS, Agilent Technologies, 1400 Fountaingrove Parkway, Santa Rosa, CA 95403-1799, 2008.
Lee, J.R., Cho, J.H., and Yun, S.W. New compact bandpass filter using microstrip /4 resonators with open stub inverter IEEE
Microwave and Guided Wave Letters, vol. 10, pp. 526-527, 2000.
FEKO, Suite 6.0, EM Software & Systems-S.A. (Pty) Ltd, 32 Techno Lane, Technopark, Stellenbosch, 7600, South Africa, 2010.
Bandler, J.W., Cheng, Q.S., Nikolova, N.K., and Ismail, M.A. Implicit space mapping optimization exploiting preassigned parameters
IEEE Trans. Microwave Theory Tech., vol. 52, pp. 378-385, 2004.
Rayas-Sánchez, J. E., and Gutiérrez-Ayala, V. EM-based Monte Carlo analysis and yield prediction of microwave circuits using linearinput neural-output space mapping IEEE Trans. Microwave Theory Tech., vol. 54, pp. 4528-4537, 2006.

