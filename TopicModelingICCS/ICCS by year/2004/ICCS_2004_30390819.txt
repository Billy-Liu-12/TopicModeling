On Approximation of Average Expectation
Prices for Path Dependent Options in Fractional
Models
Bartosz Ziemkiewicz
Faculty of Mathematics and Computer Science,
Nicolaus Copernicus University,
ul. Chopina 12/18, 87-100 Toru´
n, Poland
bartek@mat.uni.torun.pl
Abstract. Using integral representation of a fractional Brownian motion (fBm) we propose a new method of approximation of its trajectories
as well as trajectories of a geometric fBm. We give the rate of convergence in Lp -norm of the approximation. Applications to pricing of path
dependent options in a fractional model are considered. Lookback and
Asian options are examined in detail.

1

Introduction

Let (BtIH )t∈[0,T ] be a fractional Brownian motion (fBm) with Hurst index
IH ∈ (1/2, 1), i.e. B IH is a centered Gaussian process with covariance EBtIH BsIH =
1
2IH
+ s2IH − |t − s|2IH deﬁned on some probability space (Ω, F, P ). We de2 t
note by (Ft )t∈[0,T ] the ﬁltration generated by (BtIH ). We consider a continoustime market model with two assets, the riskless bond (Bt )t∈[0,T ] , and the risky
stock (St )t∈[0,T ] . The dynamics for the prices are
Bt = ert ,

IH

St = S0 eµt+σBt ,

where S0 > 0 and µ ∈ R, r, σ > 0. It is convenient to make the assumption
that there are no dividends, and no transaction costs. An option will be any
non-negative FT -measurable random variable fT .
Note that if IH = 12 , the above model coincides with the well known BlackScholes model. In this case a fair price of the option is the discounted expectation
of fT with respect to the martingale measure of this model.
If IH = 12 , then B IH is not a semimartingale, and martingale measures do not
exist (see e.g. [4]), so we need a diﬀerent method for option pricing. Instead of
martingale measures we will use the so-called average risk neutral measures.
Deﬁnition 1 ([6]). If the measure Q is equivalent to the measure P , and
E Q (St ) = ert
for all t ∈ [0, T ] then Q is called the average risk neutral measure.
Existence and uniqueness of Q was proved by Valkeila [6].
Research supported by Komitet Bada´
n Naukowych under grant 1 P03A 022 26
M. Bubak et al. (Eds.): ICCS 2004, LNCS 3039, pp. 819–826, 2004.
c Springer-Verlag Berlin Heidelberg 2004

820

B. Ziemkiewicz

Deﬁnition 2. The average expectation price C(fT ) of option fT is deﬁned by
C(fT ) = e−rT E Q fT .

(1)

If IH = 12 , the price C(fT ) coincides with the classical one for the Black-Scholes
model. Deﬁnition 2 extends the one given by Valkeila [6], where C(fT ) is deﬁned
for options depending only on the price of S at the expiration time T , i.e. fT =
h(ST ) for some h : IR+ → IR+ . In this case we have the following explicit formula
1
C(fT ) = e−rT √
2π

+∞
−∞

h S0 exp{σyT IH + rT −

y2
σ 2 2IH
T } e− 2 dy .
2

(2)

In the present paper we focus on path dependent options, i.e. options whose
payoﬀs depend on the whole path of S. For example, the payoﬀ of a lookback
option depends on the minimum or maximum price of S, while the payoﬀ of an
Asian option depends on the average price of S during the life of option. Evaluation of path dependent options in fractional models is diﬃcult and analytic
formulas like (2) are not known. In the paper we will estimate C(fT ) using the
Monte Carlo method.

2

Approximation of fBm

In the paper we introduce a new method of approximating of B IH based on the
integral representation of fBm as provided in [2]. Deﬁne the so-called fundamental martingale (Mt ) by
Mt =

t

cIH
2IH

s1/2−IH dWs ,

(3)

0

where cIH is a constant depending on IH and W is a standard Brownian motion.
M is a Gaussian martingale with independent increments. Now, if we put
t

Yt = 2IH

(t − s)IH−1/2 dMs

0

then the process
BtIH =

t

sIH−1/2 dYs

0

is a fractional Brownian motion (for the proof we refer to [2]).
To implement this method we proceed as follows.
1. Let M n be a discretization of M , i.e. Mtn = M k for t ∈ [tk , tk+1 ), where
n
tk = nk , k = 0, 1, . . . , [nT ]. We can simulate the increments of Mtn using the
− t2−2IH
fact that Mtnk − Mtnk−1 ∼ N (0, C(t2−2IH
k
k−1 )).

On Approximation of Average Expectation Prices

821

2. Next, we deﬁne the approximation Y n of Y by
Ytn = 2IH
tk

≤t∗

(t∗ − tk−1 )IH−1/2 (Mtnk − Mtnk−1 ) ,

where t∗ = max{tk ; tk ≤ t}. It is worth noting that (t∗ − tk )IH−1/2 can be
IH−1/2
written in the form ( m
, where m, n ∈ IN, m ≤ [nT ], so to compute
n)
n
Y it is suﬃcient to compute mIH−1/2 for m = 1, . . . , [nT ].
3. Finally, we approximate B IH by sums of the form
IH−

Btn =
tk ≤t∗

Let

·

p

1

tk−12 (Ytnk − Ytnk−1 ) .

(4)

denotes the usual Lp -norm.

Theorem 1. Let (Btn ) be a process deﬁned by (4). Then for any p ≥ 1,
and T ∈ IR+
sup |BtIH − Btn |

t≤T

=O

p

1
∗
nIH −

>0

,

where IH∗ = min(1 − IH, IH − 1/2).
Proof. From (3) it follows that at = [M ]t = Ct2−2IH , where C is a constant
depending on IH. Hence Mt = W at where W is a standard Brownian motion.
Using the known estimates on the modulus of continuity of W (see e.g. [5]) we
get
sup |Mt − Mtn |

t≤T

p

≤ ωM (1/n, T )

p

= ωW a (1/n, T )

≤ ωW (a(1/n), T )
√
ln n
≤ Const 1−IH ,
n

p

p

≤ Const a(1/n) ln(a(1/n)−1 )

1/2

(5)

where ωx (δ, T ) = sup{|xt − xs |; s, t ∈ [0, T ], |s − t| ≤ δ}, δ > 0, T ∈ IR+ ,
x ∈ C([0, T ], IR+ ).
We next turn to estimating supt≤T |Yt − Ytn | p . Using the integration by
parts formula, we obtain
t

Yt = 2IH

t

(t − s)IH−1/2 dMs = −2IH

0

Ms d(t − s)IH−1/2 .

(6)

0

The process Y n can be written as
Ytn = 2IH
tk ≤t∗

(t∗ − tk−1 )IH−1/2 (Mtnk − Mtnk−1 )

= −2IH
tk

≤t∗
t∗

= −2IH
0

Mtnk (t∗ − tk )IH−1/2 − (t∗ − tk−1 )IH−1/2

ˆ sn d(t∗ − s)IH−1/2 ,
M

(7)

822

B. Ziemkiewicz

ˆ n = M k+1 for t ∈ [ k , k+1 ). Note that (5) still holds if we replace M n
where M
t
n
n
ˆ n . Now,
by M

n

sup |Yt − Ytn |

≤ Const( sup |Yt − Yt∗ |

p

t≤T

p

t≤T

+ sup |Yt∗ − Ytn |
t≤T

p)

= I1 + I2 .
Combining (5) with (6) and (7) gives
t∗

I2 ≤ Const sup
t≤T

0

ˆ n )d(t∗ − s)IH−1/2
(Ms − M
s
p

ˆ tn |
≤ Const sup E|Mt − M

p

t≤T

√
≤ Const

ln n

.

n1−IH

(8)

To estimate I1 , we ﬁrst prove that for any t1 , t2 ∈ [0, T ] and q ≥ 1
E|Yt2 − Yt1 |q ≤ Const|t2 − t1 |q(IH−1/2) .
Indeed, by the Burkholder-Davis-Gundy inequality we have
t1

E|Yt2 − Yt1 |q = E

0
t2

+
t1

(t2 − s)IH−1/2 − (t1 − s)IH−1/2 dMs
q

(t2 − s)IH−1/2 dMs
t1

≤ Const E

2

(t2 − s)IH−1/2 − (t1 − s)IH−1/2 d[M ]s

0
t2

+E
t1

q/2

(t2 − s)2IH−1 d[M ]s
t1

≤ Const (t2 − t1 )q(IH−1/2)

q/2

Cs1−2IH ds

0
t2

+
t1

q/2

Cs1−2IH ds
T

≤ Const(t2 − t1 )q(IH−1/2)

q/2

Cs1−2IH ds

0

≤ Const(t2 − t1 )q(IH−1/2) .
Let q > max(p, (IH − 1/2)−1 ). By the Kolmogorov continuity theorem,
q

|Yt2 − Yt1 | 

< +∞
E  sup
α 
t1 ,t2 ≤T |t2 − t1 |
t1 =t2

for 0 < α < (IH − 1/2) − 1/q. Since p < q, from the above it follows that

q/2

On Approximation of Average Expectation Prices

I1 ≤ (E sup |Yt − Yt∗ |q )1/q ≤ Const
t≤T

for every

823

1

(9)

nIH−1/2−

> 0. By (8) and (9),
sup |Yt − Ytn |

t≤T

p

≤ Const

1
∗
nIH −

.

(10)

It remains to show that supt≤T |BtIH − Btn | p ≤ Const supt≤T |Yt − Ytn |
Using once again the integration by parts formula we obtain
t

BtIH =

t

sIH−1/2 dYs = tIH−1/2 Yt −

p.

Ys dsIH−1/2 ,

0

0

and
t

Btn =

0

−

sIH−1/2 dYsn = tIH−1/2 Ytn −
(Ytnk − Ytnk−1 )(tk

IH−1/2

tk ≤t

−

t

Ysn dsIH−1/2
0
IH−1/2
tk−1 ) .

(11)

Hence
sup |BtIH − Btn |

t≤T

p

≤ Const | sup |tIH−1/2 Yt − tIH−1/2 Ytn |
t≤T

t

+ sup
t≤T

0

(Ys − Ysn )dsIH−1/2
(Ytnk −

+ sup
t≤T

tk ≤t

p

p

IH−1/2
Ytnk−1 )(tk


−



IH−1/2
tk−1 )
p

= I4 + I5 + I6 .
It is easily seen that I4 and I5 are bounded by Const supt≤T |Yt − Ytn |
estimate I6 we observe ﬁrst that
n
n
sup |Ytnk − Ytnk−1 | = sup |Ytn − Yt−
| = sup (Ytn − Yt−
) − (Yt − Yt− )

tk ≤T

t≤T

t≤T

≤ 2 sup |Yt − Ytn | .
t≤T

Hence
I6 ≤ T IH−1/2 sup |Ytnk − Ytnk−1 |
tk ≤T

which completes the proof.

p

≤ Const sup |Yt − Ytn |
t≤T

p

,

p.

To

824

3

B. Ziemkiewicz

Approximation of Prices for Path Dependent Options

The method described in the previous section can be used to approximate the
price evolution process S. Let S n be the approximation of S deﬁned by
n

Stn = S0 eµt+σBt

for all t ∈ [0, T ]. The following result is a consequence of Theorem 1.
Theorem 2. For any p ≥ 1,

> 0 and T ∈ IR+

sup |St − Stn |

t≤T

p

1
∗
nIH −

=O

.

Proof. Without loss of generality we may and will assume that S0 = 1, µ =
0, σ = 1. Observe ﬁrst that by the Schwarz inequality,
sup |St − Stn |

t≤T

IH

p

IH

= sup |eBt [e(Bt

−Btn )

t≤T

IH

≤ sup |eBt |
t≤T

− 1]|
IH

sup |e(Bt

2p

p
−Btn )

t≤T

− 1|

2p

.

Since |ex − 1| ≤ |x|e|x| , we have
IH

sup |e(Bt

−Btn )

− 1|

t≤T

IH

2p

≤ sup |BtIH − Btn | · e|Bt

−Btn |

≤ sup |BtIH − Btn |

sup e|Bt

t≤T
t≤T

2p
IH

4p

−Btn |

t≤T

4p

.

By Theorem 1,
|| sup |BtIH − Btn | ||4p = O
t≤T

1
∗
nIH −

,

IH

n

so it remains to show that supt≤T eBt 8p < +∞ and supn supt≤T eBt 8p <
+∞. Novikov and Valkeila [3] proved that supt≤T |BtIH | ≤ C supt≤T |Mt | for
some constant C > 0. Therefore, by the Doob submartingale inequality,
IH

sup eBt

t≤T

IH

8p

= (Eesupt≤T (8p|Bt

|) 1/(8p)

)

≤ (E sup e8p C|Mt | )1/(8p)
t≤T

≤ (4 Ee8p C|MT | )1/(8p) < +∞ ,
because M is a Gaussian martingale. Finally, by (11) and (7),
sup |Btn | ≤ T IH−1/2 sup |Ytn | + T IH−1/2 sup |Ytn |

t≤T

t≤T

+T

IH−1/2

2 sup |Ytn |
t≤T

t≤T

≤ 4T

≤ 8IHT 2IH−1 sup |Mtn | .
t≤T

IH−1/2

sup |Ytn |

t≤T

(12)

On Approximation of Average Expectation Prices

825

Therefore, similarly to (12) we get
n

sup sup eBt
n

t≤T

8p

≤ sup(4 Ee64p IHT

2IH−1

|MTn | 1/(8p)

)

n

≤ (4 Ee64p IHT

2IH−1

|MT | 1/(8p)

)

< +∞

and the proof is complete.
Deﬁnition 3. We say that an operator H : C([0, T ], IR+ ) → IR is Lipschitz if
there exists L > 0 such that for any x, y ∈ C([0, T ], IR+ )
|H(x) − H(y)| ≤ L · sup |xt − yt | .
t≤T

From Theorem 1 and Deﬁnition 3 we obtain immediately the following corollary.
Corollary 1. If H : C([0, T ], IR+ ) → IR is Lipschitz then for any p ≥ 1,
H(S) − H(S n )

p

=O

1

>0

.

∗
nIH −

By choosing appropriately a Lipschitz operator H we obtain interesting examples
of path dependent options of the form fT = H(S).
Example 1 (Floating strike lookback call option).
In this case H(S) = ST − inf t≤T St . Note that for any x, y ∈ C([0, T ], IR+ )
|H(x) − H(y)| = |(xT − yT ) + ( inf yt − inf xt )|
t≤T

t≤T

≤ 2 sup |xt − yt | .
t≤T

Example 2 (Fixed strike lookback call option with the strike price K).
Here H(S) = (supt≤T St − K)+ and for any x, y ∈ C([0, T ], IR+ )
|H(x) − H(y)| ≤ | sup xt − sup yt | ≤ sup |xt − yt | .
t≤T

t≤T

t≤T

Example 3 (Asian call option with the strike price K and continuous arithmetic
averaging).
For such options
H(S) =
and it is easily seen that

1
T

T
0

+

St dt − K

,

826

B. Ziemkiewicz

|H(x) − H(y)| =
≤

T

1
T
1
T

+

xt dt − K

−

0
T

1
T

T

+

yt dt − K

0

(xt − yt )dt ≤ sup |xt − yt | ,
t≤T

0

for any x, y ∈ C([0, T ], IR+ ).

4

Numerical Results

The method described in Sections 2 and 3 we have applied to evaluate prices
of the lookback and Asian options. We have simulated 100000 trajectories of S
with step-size 1/1000.
Table 1 gives prices of the ﬂoating strike lookback options (LB1), ﬁxed strike
lookback options with the strike price K1 = 5 (LB2) and Asian options with
the strike price K2 = 5 (AS) for diﬀerent choises of the Hurst index IH. The
initial asset price S0 is set equal to 5, parameters r and σ are equal 0.1 and 0.3
respectively.
Table 1. The prices of LB1, LB2 and AS (S0 = 5, K1 = 5, K2 = 5, σ = 0.3, r = 0.1,
T = 1).
IH

0.6

0.7

0.8

0.9

LB1 1.1381 1.0288 0.9399 0.8861
LB2 1.2727 1.1177 1.0013 0.9138
AS 0.4464 0.4358 0.4234 0.4207

References
1. Kwok Y.K.: Mathematical Models of Financial Derivatives. Springer, Singapore
(1998)
2. Norros I., Valkeila E., Virtamo J.: An elementary approach to a Grisanov formula
and other analytical results on fractional Brownian motions. Bernoulli 5(4) (1999)
571–587
3. Novikov A., Valkeila E.: On some maximal inequalities for fractional Brownian
motions. Statistics & Probability Letters 44 (1999) 47–54
4. Shiryaev A.N.: On Arbitrage and Replication for Fractal Models. Research Report
20, MaPhySto, Centre for Mathematical Physics and Stochastics, September (1998)
5. Slomi´
nski L.: Euler’s approximations of solutions of SDEs with reﬂecting boundary.
Stochastics Processes and their Applications 94 (2001) 317–337
6. Valkeila E.: On some properties of geometric fractional Brownian motions. Preprint
(1998)

