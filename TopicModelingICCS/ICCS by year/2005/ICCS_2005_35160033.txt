3D Finite Element Modeling of Free-Surface
Flows with Eﬃcient k − Turbulence Model and
Non-hydrostatic Pressure
C´elestin Leupi1 and Mustafa Siddik Altinakar2
1

ISE-STI-LIN, Ecole Polytechnique F´ed´erale,
Lausanne 1015, Switzerland
Phone: +41.21.693.25.07, Fax + 41.21.693.36.46
celestin.leupi@epfl.ch
2
NCCHE, The University of Mississipi,
Carrier Hall Room 102 University, MS 38677 USA

Abstract. Validation of 3D ﬁnite element model for free-surface ﬂow
is conducted using a high quality and high spatial resolution data set.
The present research ﬁnds its motivation in the increasing need for efﬁcient management of geophysical ﬂows such as estuaries (multiphase
ﬂuid ﬂow) or natural rivers with the complicated channel geometry (e.g.
strong channel curvature). A numerical solution is based on the unsteady Reynolds-averaged Navier-Stokes equations without conventional
assumption of hydrostatic pressure. The model uses implicit fractional
step time stepping, with the characteristic method for convections terms .
The eddy viscosity is calculated from the eﬃcient k − turbulence model.
The RANS are solved in the multi-layers system (suitable for the vertical stratiﬁed ﬂuid ﬂow ) to provide the accurate resolution at the bed
and free-surface. The model is applied to the 3D curved open channels
ﬂows for which experimental data are available for comparison. Good
agreement is found between numerical computations and experiments.
Keywords: Validation; Characteristic method; 3D Curved open channel; secondary currents; Non-hydrostatic pressure.

1

Introduction

Nowadays with the increasing computer power, several 3D computations have
been successfully conducted for geophysical ﬂows modeling. Most of these models have used the conventional hydrostatic pressure assumption. However, the
natural rivers mostly have complicated geometry with the strong channel curvature. Such ﬂows are of more importance for environmental hydraulic engineering
and some related important features such as the secondary ﬂows generated by
the channel curvature and the related background turbulence eﬀects, need to be
well understood while a 3D description of the velocity ﬁeld is required. Thus it
is useful to resort to a more accurate model in which the hydrostatic assumption
V.S. Sunderam et al. (Eds.): ICCS 2005, LNCS 3516, pp. 33–40, 2005.
c Springer-Verlag Berlin Heidelberg 2005

34

C. Leupi and M.S. Altinakar

is removed. Nevertheless, the importance of non-hydrostatic pressure in computational ﬂuid problems was demonstrated and many researchers have applied
3D non-hydrostatic models to simulate the curved open channel ﬂows. Wu et
al. [13] and Olsen [10] used 3D numerical models to study the ﬂow structure
and mass transport in curved open channel. Xiabo et al. [2] have simulated the
3D unsteady curved open channel with standard k − turbulence model and
the non-hydrostatic pressure on the conformal mesh, but conformal mesh could
poorly performed for some complicated bathymetry. Lai et al. [4] have used
ﬁnite volume method on the unstructured grid to simulate 3D ﬂow in meandering channel. For the free surface treatment, most of these 3D models employed
the rigid-lid approximation, which have some weaknesses especially in strongly
curved open channel ﬂows (see [5]).
Based on the novel approach developed by Leupi et al. [6], the present model
adopts the ﬁnite element conservative formulation in the multi-layers system for
providing an accurate resolution at the bed and the free-surface.
The present work aims at validating the 3D ﬁnite element model against
well-known non-uniform and unsteady ﬂows in curved open channel ﬂows using
a high quality and high spatial resolution data set. The model uses the nonhydrostatic pressure and the state-of-art k − turbulence model closure to solve
the Reynolds-averaged Navier-Stokes equations (RANS).
In this study, the free-surface movement is controlled through the so-called
integrated continuity equation. The full 3D governing equations are solved using
implicit fractional time marching stepping where ﬁnal velocity ﬁeld and pressure
term are computed from the hydrodynamic correction. Euler or Runge-Kutta
scheme is used to obtain a set of algebraic equations from discretization. An eﬃcient fractional step algorithm from Mohammadi and Pironneau [9] is introduced
for the k − model. This paper deals with the simulation of the 3D turbulent
ﬂow in the open curved channel for which experimental data are available.

2

Governing Equations

Let us consider an incompressible ﬂuid body in a three-dimensional time varying
domain Ω (see also [6]) with Ω the projection of Ω on the xy horizontal plane. Ω
is bounded by the free-surface Γs given by z = η(x, y, t), the bottom topography
Γb given by z = −h(x, y), the open boundary denoted by Γo . Where h(x, y) is
the distance between the bottom and the reference plane xy and η(x, y, t) the
elevation of the free-surface with the respect to the horizontal plane xy. For
description of the turbulent motion, the pressure p can be written as the sum of
p,
an hydrostatic term ph and an hydrodynamic correction pnh = ρ˜
p (x, t) = ph + pnh = pa + gρo (η − z) + g

η

∆ρdz + ρ˜
p (x, t)

(1)

z

The 3D non hydrostatic Reynolds Averaged Navier-Stokes (RANS) equations
reads

3D Finite Element Modeling of Free-Surface Flows

∇H · U +

∂w
=0
∂z

DU
∂U
∂
+ g∇H η − ∇H (νT ∇H U) −
νT
Dt
∂z
∂z

∂η
+ ∇H ·
∂t

η
−h

(2)
η

+ g∇
h

Dw
∂w
∂
− ∇H (νT ∇H w) −
νT
Dt
∂z
∂z

35

+

∆ρ
1
p = Fxy
dz + ∇˜
ρo
ρ
(3)

1 ∂ p˜
=0
ρ ∂z

(4)

Udz = 0

T

(5)
T

where U = (u, v) is the horizontal velocity vector , Fxy = (fv, −fu) is vector
of body forces with f the Coriolis parameter, g is the gravitational acceleration,
νT is the eddy viscosity, (see Rodi [12]). (∇·) is the 3D divergence operator,
D
Dt represents the material derivative, and (∇H ·) stands as the 2D horizontal
divergence operator. ∆ρ = ρ − ρ0 ; ρ, ρ0 are respectively the ﬂuid density and
the basic water density.
In eq.(3), the vertical eddy viscosity is deﬁned as
νT = ν + cµ

k2
ε

(6)

in which ν is the kinematic viscosity.
The k − ε trubulence equations read ([9]),
Dk
k2
k2
− ∇ · cµ ∇k = cµ G − ε
Dt
ε
ε

(7)

Dε
c1
k2
ε2
− ∇ · cε ∇ε = kG − c2
Dt
ε
2
k

(8)

The turbulent constants are given: c1 = 0.126, c2 = 0.07, cµ = 0.09, cε = 1.92.
The production is represented by the squared shear frequency, G, (see [7]),
such as :
1
2
∇V + ∇V T
(9)
2
where . stands as the Euclidian norm, V = V (u, v, w) is the 3D velocity
vector.
The depth-integrated continuity equation eq. (5) allow the model to follow
the free-surface position. This equation is obtained by integrating the (local)
continuity equation (2) in the z direction using the suitable kinematic free-surface
and bottom boundary conditions.
G=

36

C. Leupi and M.S. Altinakar

The horizontal velocity is approximated combining the lowest order RaviartThomas element (RT0 ) in xy plane with the P1 elements along the vertical
direction (see [6], [8], [11]). To discretize the convective term a method based
on a Lagrange-Galerkin (or characteristics Galerkin) approach is considered (see
[8], [9]) using either Euler scheme or more accurate Runge-Kutta. At each time
step it is only required to solve a set of the positive deﬁnite symmetric and
tridiagonal matrices for the ﬂuxes using the conjugate gradient solver. For the
turbulence modeling, the combinaison of the characteristics method with the
fractional time stepping algorithm from Mohammadi and Pironneau ([9], [6]) can
allow to preserve the positivity of k, ε as well as the stability of the scheme (see
[9], [12]). To avoid spurious numerical oscillations, the source term, G, has been
discretised explicitly while the sink term has been discretised using the quasiimplicit forms with the consequence that linear terms are linearized (see [9]).

3

Numerical Results

The present model has been applied for simulating a 3D curved open channel ﬂow
in Figure 1, for which experimental data are available (see Blanckaert [1]). The
90
120

60
30

150
α
180
0.5[m]

m05
0.5[m]

p05
2[m]

1[m]

5[m]

p15

m25

1[m]

p25

Section A−A

1[m]
9[m]

p35

s
h=0.11[m]
A

11
00
00
11

A

n

B=1.3 [m]

111111111111
000000000000
000000000000
111111111111
000000000000
111111111111
110
00
000000000000
111111111111
1
000000000000
111111111111
000000000000
111111111111
z
000000000000
111111111111
000000000000
111111111111
000000000000
111111111111
000000000000
111111111111
000000000000
111111111111
000000000000
111111111111

Fig. 1. A 193o Curved open-channel

n

3D Finite Element Modeling of Free-Surface Flows

37

1

Experiment
Nonhydro+linear k- ε
Hydro+linear k-ε

2

(H-Hm)/(U0/2g)

0.5

0

-0.5

-1
-0.5

-0.25

0

0.25

0.5

(r-ri)/B

Fig. 2. Experiments versus computed free-surface solutions at section α = 120o using
linear k − Turbulence model : Experiment (♦) ; Hydrostatic (dashed line) ; Non
hydrostatic (solid line)

discharge is set to Q = 0.089[m3 /s], the bed slope (i.e. channel bottom slope) is
S0 = 0.000624 . The rough bed is characterized by an equivalent roughness height,
ks = 0.0022[m]. The ﬂow depth at the outﬂow (downstream end of the ﬂume) is
0.159[m]. The grid is composed of 50.000 elements and 30.000 nodes. The time
step is set to 0.1 [s], and the computation is performed till the ﬂow is well developed at T=1300 [s]. Computations were conducted with the hydrostatic pressure
assumption for diﬀerent cross-sections with the curvature increasing, to determine
the conditions where the non-hydrostatic pressure component become signiﬁcant.
Computed solutions predict the gross ﬂow features, whereas the water surface proﬁle is under-estimated at the out bank, and over-estimated at the inner bank.
Figure 2 shows the cross-section at α = 120o , where are found the weaknesses of
the hydrostatic pressure solution. Hence agreement with experiments is rather better for non-hydrostatic solutions particularly with the increasing curvature. This
suggest that the separation may occur in the vertical ﬂow and the the pressuredriven secondary eﬀects are important. Thus the free surface must be more accurately computed to accounts for its damping eﬀects on the turbulent ﬂow. As observed in ﬁgure 3, both hydrostatic and non-hydrostatic pressure solutions show
only one secondary ﬂow circulation rotating clockwise from inner bank to outer
bank. These predictions do not capture suﬃciently the magnitude of the secondary
motion. The maximum under prediction in the secondary currents for each vertical examined in this cross-section is ranged between 25 and 95% for the nonhydrostatic solutions and between 30 and 105% for the hydrostatic pressure. In Figure 3 the center of vortex is located at about z = 0.25[m] for the hydrostatic, about
z = 0.35[m] for the non hydrostatic solutions which is more closed to experiments
located at z = 0.4[m]. The predicted secondary currents intensities are weaker than

38

C. Leupi and M.S. Altinakar

Fig. 3. Experiments versus computed solutions of the of cross-stream velocity vector
at section α = 120o : A) Experiment ; B) Hydrostatic ; C) Non hydrostatic

3D Finite Element Modeling of Free-Surface Flows

39

measured, and the transverse velocities are under predicted. The anisotropic stress
caused by walls and the junction region is not captured by the model, and the reduced momentum is transfered towards the outer region of the bend as well as the
position of the longitudinal velocity maximum. This suggest that the turbulencedriven secondary eﬀects are non-linear. Consequently, as shown by Gatsky et al.
[3], the related weaker turbulence-driven secondary motion cannot be reproduced
by linear and isotropic eddy-viscosity turbulence models. It should be pointed out
that the major ﬂow features such as the presence and rotational sense of the major secondary currents are reproduced and agrees well with experiments. The nonhydrostatic pressure inﬂuence is found to be more signiﬁcant with the increasing
curvature region, and although being more expensive, it become useful. This suggest that the pressure-driven secondary currents is relatively important for the accurated description of the velocity ﬁeld and the use of anisotropic turbulence models is prerequisite to more accurate ﬂow ﬁeld prediction.

4

Conclusion

Validation of the 3D ﬁnite element solver for the RANS equations with the Eﬃcient k − turbulence model is conducted successfully using a high quality and
high spatial resolution data set. The convection terms have been discretized using
the Lagrange-Galerkin approach with advantage that, the CFL restriction is well
performed. Moreover, addition of this characteristic method to the conservative
form of the PDE and the implicit fractional step time stepping, allow to preserve
the mass balance, the positivity of k and , as well as the stability of the scheme.
In computed solutions, the weaker secondary currents were not reproduced, but
it shlould be noticed that more reﬁne turbulence modeling can produce improvement for such problem. Computations with and without non-hydrostatic
are compared for the same trench to test the validity of the conventional hydrostatic pressure assumption. The model predicts reasonably the complex major
features and the 3D ﬂow tests were performed successfully against well-known
unsteady non-uniform curved open channel ﬂows.The non-hydrostatic pressure
inﬂuence is found to be more signiﬁcant with the increasing curvature region
(e.g. cross-section α = 120o ). This suggest that the non-hydrostatic pressure
may be useful and well suited for complicated geometry ﬂows where its inﬂuence is thought to be signiﬁcant. Further study is needed to improve the general
applicability of the model, and the next stage of this work will be focus on the
anisotropic turbulence-driven secondary motion.

Acknowledgment
The ﬁrst author gratefully acknowledged Funding from the Swiss National Science Foundation through grant number 21-65095.01. Michel Deville, Alﬁo Quarteroni, Edie Miglio and Koen Blanckaert are acknowledged for their fruitfully
discussions.

40

C. Leupi and M.S. Altinakar

References
1. Koen Blanckaert. Flow and turbulence in sharp open-channel bends. PhD thesis,
Ecole polytechnique de Lausanne- EPFL, N0. 2545, 2002.
2. Xiabo Chao, Yafei jia, and Sam S. Y. Wang. Three-dimensional simulation of
buoyant heat transfer in a curved open channel. In Proc. Int. Conf. on Advances
in hydro-Science and -Engineering, ICHE, NCCHE Mississipi,USA, vol 6, pages
18–19 & on CDROM, 2004.
3. Thomas B. Gatski, M. Yousuﬀ Hussaini, and John L. Lumley. Simulation and
Modeling of Turbulent Flows. Oxford University Press, 198 Madison Avenue, New
York, New York 10016, 1996.
4. Yong G. Lai, Larry J. Weber, and Virendra C. Patel. Three-dimensional model for
hydraulic ﬂow simulation. i: formulation and veriﬁcation. ASCE, J. Hydr. Engrg.,
129(3):196–205, 2003.
5. Michael A. Leschziner and Wolfang Rodi. Calculation of strongly curved open
channel ﬂow. ASCE, J. Hydr. Div., 103(10):1297–1314, 1979.
6. C´elestin Leupi, Edie Miglio, Mustafa Altinakar, Alﬁo Quarteroni, and Michel Deville. Quasi-3d ﬁnite element shallow-water ﬂow with k − ε turbulence model. In
Proc. Int. Conf. on Advances in hydro-Science and -Engineering, ICHE, NCCHE
Mississipi,USA, vol 6, pages 400–401 & on CDROM, 2004.
7. Patrick J. Luyten, John Eric Jones, Roger Proctor, Andy Tabor, Paul Tett, and
Karen Wild-Allen. Coherens- a coupled hydrodynamical-ecological model for regional and shelf seas. Technical Report MUMM report, Management unit of the
Mathematical Models of North Sea, 914pp, COSINUS, 1999.
8. Edie Miglio, Alﬁo Quarteroni, and Fausto Saleri. Finite element approximation of quasi-3D shallow water equations. Comput. Methods Appl. Mech. Engrg.,
174(34):355–369, 1999.
9. Bijan Mohammadi and Olivier Pironneau. Analysis of k − epsilon Turbulence
Model. Research in Applied Mathematics. John Wiley & Sons, Chichester, 1994.
10. Nils Reidar B. Olsen. Three-dimensional cfd modeling of self-forming meandering
channel. ASCE, J. Hydr. Engrg., 129(5):366–372, 2003.
11. Pierre Arnaud Raviart and Jean Marie Thomas. A mixed finite element method
for 2nd order elliptic problems. Springer-Verlag, Mathematical Aspects of Finite
Element Methods, Lecture notes in Methematics.
12. Wolfang Rodi. Turbulence models and their applications in hydraulics. Technical
Report 2nd edition, IAHR, Delft, Netherlands, 1984.
13. Weiming Wu, Wolfgang Rodi, and Thomas Wenka. 3D numerical modeling of ﬂow
and sediment transport in open channels. ASCE,J. Hydr. Engrg., 126(1):4–15,
2000.

