Available online at www.sciencedirect.com

ScienceDirect
This Procedia
space isComputer
reserved
for 108C
the Procedia
header,
Science
(2017) 1963–1972
This space is reserved for the Procedia header,
This space is reserved for the Procedia header,
This space is reserved for the Procedia header,

do
do
do
do

not
not
not
not

use
use
use
use

it
it
it
it

International Conference on Computational Science, ICCS 2017, 12-14 June 2017,
Zurich, Switzerland

Application of the Path Tubes Method to the
Application
of
Method
ApplicationNavier-Stokes
of the
the Path
Path Tubes
Tubes
Method to
to the
the
Equations
ApplicationNavier-Stokes
of the Path Tubes
Method
to
the
Equations
Navier-Stokes
Equations
2
Fábio Ferreira11 ,Navier-Stokes
Mauricio Kischinhevsky
, and Nélio Henderson3
Equations
Fábio Ferreira , Mauricio Kischinhevsky2 , and Nélio Henderson3
2
Fábio Ferreira11, INFES
Mauricio
Kischinhevsky
, and Nélio Henderson3
- Universidade
Federal 2Fluminense
11
Fábio Ferreira , INFES
Mauricio
Kischinhevsky
, and Nélio Henderson3
- Universidade
FederalBrazil
Fluminense
Niterói,
Rio de Janeiro,
1

2
2
2
2

INFES
- Universidade
FederalBrazil
Fluminense
Niterói,
de Janeiro,
fabio Rio
pacheco@id.uff.br
Niterói,
Rio
de
Janeiro,
Brazil
INFES
Universidade
Federal
Fluminense
pacheco@id.uff.br
IC - UFFfabio
(permanent
address) and CS - UBC
fabio
pacheco@id.uff.br
Niterói,
Rio
de
Janeiro,
Brazil
IC - UFF
(permanent
address) Brazil
and CS - UBC
Niterói,
Rio de Janeiro,
IC - UFF
(permanent
address) Brazil
and CS - UBC
fabio
pacheco@id.uff.br
Niterói,
Rio
de Janeiro,
kisch@ic.uff.br
Niterói,
Rio de Janeiro,
(permanent
address) Brazil
and CS - UBC
3IC - UFF
kisch@ic.uff.br
Universidade do Estado do Rio de Janeiro,
kisch@ic.uff.br
Niterói,
Rio
de
Janeiro,
Brazil
3
Universidade
do Estado
Rio deBrazil
Janeiro,
Nova Friburgo,
Rio de do
Janeiro,
3
Universidade
do Estado
do
Rio deBrazil
Janeiro,
kisch@ic.uff.br
Nova
Friburgo,
Rio
de
Janeiro,
henderson@gmail.br
3
Nova Friburgo,
Rio
de
Janeiro,
Brazil
Universidade
do
Estado
do
Rio
de
Janeiro,
henderson@gmail.br
henderson@gmail.br
Nova Friburgo,
Rio de Janeiro, Brazil
henderson@gmail.br
1

Abstract
Abstract
This work deals with an extension of the Path Tubes method for the solution of the timeAbstract
This work
deals with an
extension
Path Tubes method
for the
solution
of thefrom
time-a
dependent
Navier-Stokes
equations
forofanthe
incompressible
Newtonian
fluid.
Departing
Abstract
This work
deals with an
extension
Path Tubes method
for the
solution
of thefrom
time-a
dependent
Navier-Stokes
equations
forofon
anthe
incompressible
Newtonian
fluid.
Departing
physically
intuitive
methodology
based
the
theoretical
basis
of
the
mechanics
of
continuous
This work
deals with an
extension
ofanthe
Path Tubes method
for the
solution
of thefrom
time-a
dependent
Navier-Stokes
equations
for
incompressible
Newtonian
fluid.
Departing
physically
intuitive
methodology
based
on the theoretical
basisofofthe
the
mechanics
of continuous
media,
a robust
numerical
technique
is obtained.
This version
Path
Tubes
method
drawsa
dependent
Navier-Stokes
equations
for
an the
incompressible
Newtonian
fluid.
Departing
from
physically
intuitive
methodology
based
on
theoretical
basis
of
the
mechanics
of
continuous
media,
a robust numerical
technique is obtained.
This version
of the Path
Tubes method
draws
on
a semi-Lagrangian
time-discretization
employs
the
Reynolds’
transport
theorem,
and
physically
intuitive
methodology
based
onthat
the theoretical
basis
the
mechanics
of continuous
media,
a robust
numerical
technique
is obtained.
This version
ofofthe
Path
Tubes method
draws
on
a semi-Lagrangian
time-discretization
that employs
the Reynolds’
transport
theorem,
and
a
localization
approach,
to
establish
an
implicit
semi-Lagrangian
algorithm
that
allows
the
media,
a robust numerical
technique is obtained.
This version
of the Path
Tubes method
draws
on
a semi-Lagrangian
time-discretization
that employs
the Reynolds’
transport
theorem,
and
a
localization
approach,
to spatial
establish
an implicit
semi-Lagrangian
algorithm
that
allows
the
use
of
classical
schemes
for
discretization,
such
as
central-difference
formulas,
without
on
a semi-Lagrangian
time-discretization
that employs
the Reynolds’
transport
theorem,
and
a
localization
approach,
to spatial
establish
an implicit
semi-Lagrangian
algorithm
that
allows
the
use
of
classical
schemes
for
discretization,
such
as central-difference
formulas,
without
the
need
to
use
upwind
techniques,
or
high-order
corrections
for
time
derivatives.
Some
of
a localization
approach,
to spatial
establish
an implicit such
semi-Lagrangian
algorithm
that allows
the
use
of
classical
schemes
for
discretization,
as
central-difference
formulas,
without
the extensive
need to use
upwindtests
techniques,
or high-order
corrections
for
time derivatives.
Some of
numerical
are
shown
herein,
in
particular
for
Reynolds’
numbers
typical
use
of
classical
schemes
for
spatial discretization,
such
as central-difference
formulas, Some
without
the
need
to use
upwindtests
techniques,
or high-order
corrections
time derivatives.
of
the
extensive
numerical
aretests
shown
herein,
in particular
forfor
Reynolds’
typical of
advection
dominated
flows.
The
show
the method
is accurate,
even derivatives.
fornumbers
coarse grids.
the extensive
need to
use
upwind
techniques,
or
high-order
corrections
for
time
Some of
numerical
tests
are
shown
herein,
in
particular
for
Reynolds’
numbers
typical
advection dominated flows. The tests show the method is accurate, even for coarse grids.
the
extensive
numerical
tests
are
shown
herein,
in particular
for Reynolds’
typical
of
Keywords:
Path
Tubes
method,
Semi-Lagrangian
equation,
Implicit
scheme,
advection
dominated
flows.
tests
show
thealgorithm,
method
isNavier-Stokes
accurate,
even
fornumbers
coarse
grids.
©
2017
The Authors.
Published
byThe
Elsevier
B.V.
Keywords:
Path
TubesAdvection
method,
equation,
Implicit
scheme,
advection under
dominated
flows.
tests show
thealgorithm,
method
isNavier-Stokes
accurate,
even
for
coarse
grids.
Peer-review
responsibility
of The
theSemi-Lagrangian
scientific
committee
of the International
Conference
on Computational
Science
Interpolation
formula,
dominated
flow.
Keywords: Path Tubes method, Semi-Lagrangian algorithm, Navier-Stokes equation, Implicit scheme,
Interpolation formula, Advection dominated flow.
Keywords:
Path
TubesAdvection
method, Semi-Lagrangian
Interpolation
formula,
dominated flow. algorithm, Navier-Stokes equation, Implicit scheme,
Interpolation formula, Advection dominated flow.

1 Introduction
1
Introduction
1
Introduction
The displacement
of an incompressible Newtonian fluid is governed by the Navier-Stokes equa1
Introduction
The
of an incompressible
fluid is governed
by the
equations,displacement
which are second
order nonlinearNewtonian
partial differential
equations.
DueNavier-Stokes
to the relevance
of

The
displacement
of an incompressible
Newtonian
fluid is governed
by the
Navier-Stokes
equations,
which are in
second
order nonlinear
partialphenomena
differential
equations.
Due
to
the relevance
of
these
equations
of different
and
processes
ofNavier-Stokes
importance
to
the
The
displacement
ofthe
ansimulation
incompressible
Newtonian
fluid is governed
by the
equations,
which
are
second
order
nonlinear
partial
differential
equations.
Due
to
the
relevance
of
these equations
in
the
simulationthe
of different
phenomena
and processes
oftoimportance
to the
applied
sciences
and
engineering,
development
of
numerical
techniques
solve
the
Naviertions,
which are in
second
order nonlinear
partialphenomena
differential and
equations.
Due
to
the relevance
of
these
equations
the
simulation
of
different
processes
of
importance
to
the
appliedequations
sciences and
engineering,
theinterest
development
of researchers,
numerical techniques
toone
solve
Stokes
has
attracted
the
of phenomena
many
being still
of the
the Naviercentral
these
equations
in
the
simulation
of
different
and
processes
of
importance
to
the
applied
sciences and
theinterest
development
of researchers,
numerical techniques
solve
the
NavierStokes equations
hasengineering,
attractedfluid
the
of(CFD),
many
being approach
stilltoone
of
the
central
aspects
of the computational
dynamics
[7]. A numerical
forthe
the
timeapplied
sciences
and
engineering,
the
development
of researchers,
numerical
techniques
toone
solve
NavierStokes
equations
has
attracted
the
interest
of
many
being
still
of
the
aspects of the
computational
fluid dynamics
(CFD),
[7]. Atheir
numerical
approach
forand
thecentral
timedependent
Navier-Stokes
equations
must
take
into
account
description
in
time
space,
Stokes
equations
has attractedfluid
the interest of(CFD),
many researchers,
being approach
still one of
aspects
of the
computational
[7]. Atheir
numerical
forthe
thecentral
timedependent
Navier-Stokes
equations dynamics
must take into account
description
in time
and
space,
aspects
of the
computational
fluid dynamics
[7]. Atheir
numerical
approach
forand
the space,
timedependent
Navier-Stokes
equations
must take (CFD),
into account
description
in time
1
dependent Navier-Stokes equations must take into account their description in time and space,
1
1877-0509 © 2017 The Authors. Published by Elsevier B.V.
1
Peer-review under responsibility of the scientific committee of the International Conference on Computational Science
1
10.1016/j.procs.2017.05.182

1964	

Ferreira
(2017) Kischinhevsky,
1963–1972
Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson

besides an appropriate treatment of the nonlinearities. The unsteady and advective terms of the
momentum equations bring to the Navier-Stokes equations a non-linear hyperbolic character,
while the unsteady and diffusive (viscous) terms of these equations are similar to their counterparts in a typical linear parabolic partial differential equation, such as the heat conduction
equation. Thus, depending on Reynolds’ number, one of these characteristics may prevail over
the other, turnning the numerical treatment of the Navier-Stokes equations into a complex problem. No difficulties are found to solve the Navier-Stokes equations at low Reynolds’ number,
employing different numerical approaches typically used in the discretization of parabolic equations, such as central-difference approximations. However, at high Reynolds’ number, where the
advective phenomenon is dominant, these equations are difficult to solve [13]. Particularly, in a
semi-implicit Eulerian method, where advection is treated explicitly, time step sizes are subject
to a stability condition, [12]. Generally, such stability condition imposes severe restrictions on
the time step size. Thus, this constraint may make a semi-implicit Eulerian scheme prohibitive
at high Reynolds’ numbers. This is exactly what happens when centered finite differences
are used to discretize the convective terms, [14]. Generally, fully implicit Eulerian methods
for Navier-Stokes equations are unconditionally stable, [7]. Since many of these fully implicit
methods require a very fine discretization grid, then they can become expensive. As initially
verified by [10], a semi-Lagrangian time-discretization can be a good alternative for the numerical treatment of the Navier-Stokes equations. Since an advantage of these semi-Lagrangian
methods lies in the fact that they usually are not subject to restrictions imposed by stability
conditions, historically such methodologies have long been used for numerical computation of
advection equations when large time steps become necessary, as in meteorology for numerical
weather prediction, [2], [3], [11]. The main drawback of most semi-Lagrangian schemes is that
they formally do not conserve mass (or other conservative propriety) which can compromise
the accuracy of numerical solutions generated by these methods. The Path Tubes method is
a semi-Lagrangian algorithm introduced by [8] for advection equations, whose formulation is
based on the fundaments of the mechanics of continuous media. This semi-Lagrangian algorithm is physically intuitive and uses the Reynolds’ transport theorem to establish judiciously
its main property written on the basis of conservative integral equations. In the present work,
we extend the application of the Path Tubes method to the Navier-Stokes equations. The
proposed methodology has the property of integrating the Navier-Stokes equations over the
space-time, so that (after the use of the Reynolds’ theorem and of a localization procedure) the
advective terms are no longer part of the resulting partial differential equations. In fact, the
resulting equations have an essentially parabolic form equipped with a semi-Lagrangian timediscretization for the material derivatives. This approach allows the use of classical schemes
for spatial discretization, such as central-difference formulas employed here, without the need
to use upwind techniques, or high-order corrections for time derivatives. To determine values
at upstream points, many semi-Lagrangian methods use backtracking processes in time. Since
the calculated upstream points may not coincide with computational grid points, in general,
semi-Lagrangian methods depend on interpolations of initial profiles, [5]. The choice of the
interpolation formula can have an impact on the accuracy of the numerical solution. In this
study, we use a simplified version of the inverse distance weighted interpolation formula. This
numerical technique is a well-established interpolation formula, which was originally developed
by [4] to be used in the development of geographic information systems. As shown in previous
tests conducted by [8], this simplified version of the Shepards interpolation formula is appropriate to equip the Path Tubes method. In order to test the numerical performance of the proposed
methodology for the Navier-Stokes equations, we employ two-dimensional benchmark problems
available in the literature, where exact solutions are known analytically. After intensive numer-

2

	

Ferreira
(2017) Kischinhevsky,
1963–1972
Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson

ical tests, we can establish that the Path Tubes method for the Navier-Stokes equations proved
to be accurate. The remainder of this paper is organized as follows. In Section 2, we describe
the Path Tubes method for Navier-Stokes equations. In Section 3, the interpolation formula
and the iterative method used to solve the system resulting from the space-time discretization
are briefly discussed. In Section 4, some numerical results for a test problem are presented.
Concluding remarks are presented in Section 5, with some comments on future work.

2

The Path Tubes Method for the Navier-Stokes Equations

Let Ω denote a bounded region of E with a continuous boundary ∂Ω. In the following, we
consider the Navier-Stokes equations, a mathematical model for the linear momentum balance
of incompressible Newtonian fluids [6], given by.
1
∂V
+ (∇V ).V −
∆V + ∇p = F
(1)
∂t
Re
The partial differential equation 1 is written in its dimensionless form. In this equation, Re
denotes the Reynolds number, the ratio of inertial forces to viscous forces, which is the most
important dimensionless number in fluid dynamics, p is the pressure and F denotes the body
forces. In addition, we consider the law of conservation of mass for an incompressible fluid,
∇ · V = 0,

(2)

which is also written in dimensionless form.
We study Eqs. 1 and 2 with the boundary condition V = Vb on ∂Ω, and the initial condition
V (t = 0) = V0 , where Vb and V0 are known functions.
Observing the Navier-Stokes equations, Eq. 1, we can note a well-known fact. The terms
∂V /∂t + (∇V ) · V bring to this partial differential equation a non-linear hyperbolic character,
while the terms ∂V /∂t − 1/Re∆V seek to make this equation as of the parabolic type. Thus,
depending on the value of the Reynolds number, one of these characteristics may prevail over
the other, making the numerical treatment of the Navier-Stokes equations a difficult problem.
Using the result obtained in [9], we can write Eq. 1 in the approximate form:
V (X, t + ∆t) +

∆t
1
[∇p(X, t + ∆t) −
∆V (X, t + ∆t) − F (X, t + ∆t)]
2
Re
1
∆t
[∆p(X̂, t) −
∆V (X̂, t) − F (X̂, t)],
= V (X̂, t) −
2
Re

(3)

onde X̂ is obtained by backtracking as defined below.
The set Ωt can be determined by backtracking processes of the path lines, starting of points
on Ω(t + ∆t), at time t + ∆t, and ending in points on Ωt, at time t, see Fig. 1. Thus,
mathematically we can treat this set Ωt as the image of Ω(t + ∆t), via the one-to-one mapping
ϕt : Ωt+∆t ⊂ E → E given by
ϕt (X) = X̂ ∈ Ωt ; X ∈ Ωt+∆t ,

(4)

where X̂ denotes the solution of the system of first order ordinary differential equations, with
an additional condition, which indicates that at t + ∆t the solution is a given point X =
X(t + ∆t) ∈ Ωt+∆t .
3

1965

1966	

Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson
Ferreira
(2017)Kischinhevsky,
1963–1972

Figure 1: Ωt determined by backtracking of the path lines starting of points on Ωt+∆t .
Now, free from the previously existing competition between the so-called convective and
diffusive terms of the Navier-Stokes equations, we can treat the discretization of the spatial
derivatives that remain in Eq. 3 simply using classical techniques, such as the central-difference
formulas. In order to discretize the domain Ω ⊂ R2 , at a time t+∆t, we consider a uniform cellcentered grid, such that anarbitrary block of this grid is described by Ωr,s = [xr−1/2 , xr+1/2 ] ×
[ys−1/2 , ys+1/2 ], with grid spacing in x -direction and y-direction given by ∆x = xr+1/2 − xr−1/2
and ∆y = xs+1/2 − xs−1/2 , respectively. The point (xr , ys ) denotes the grid node located in
the block Ωr,s . The time level n is associated with the time t = n∆t, where ∆t is the time step
size of the numerical scheme. Then, using a classic notation employed in the literature of finite
difference methods, for each block Ωr,s , where |Ωr,s | = ∆x∆y is supposed to be sufficiently
small, we can write Eq. 3 as




n+1
2 n+1
2 n+1
u
u
∂p
∂
∂
1
∆t
r,s
r,s
r,s
un+1
−
+
− F1 n+1
r,s +
r,s
2
∂x
Re
∂x2
∂y 2
(5)

 2


1
∂ û ∂ 2 û
∆t ∂ p̂
−
+ 2 − F1 (x̂(t), ŷ(t)) ,
= û −
2 ∂x Re ∂x2
∂y




n+1
n+1
∂ 2 vr,s
∂ 2 vr,s
1
∆t ∂pn+1
r,s
n+1
n+1
−
+
− F2 r,s
vr,s +
2
∂y
Re
∂x2
∂y 2
(6)


 2

1
∂ 2 v̂
∆t ∂ p̂
∂ v̂
−
+ 2 − F2 (x̂(t), ŷ(t))
= v̂ −
2 ∂y Re ∂x2
∂y
where p̂ = p(x̂(t), ŷ(t)), û = u(x̂(t), ŷ(t)), v̂ = v(x̂(t), ŷ(t)) and (x̂(t), ŷ(t)) is the solution of the
ordinary differential equations system

dx/dt = u(x, y, t)
(7)
dy/dt = v(x, y, t)
that satisfies the additional conditions
x(t + ∆t) = xr ; y(t + ∆t) = ys .

(8)

n+1
Note that un+1
r,s and vr,s are variables of the system of equations shown in Eqs. 5 and 6.
Then, we do not know any values of u and v in the time interval (t, t + ∆t]. This fact requires

4

	

Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson
Ferreira
(2017)Kischinhevsky,
1963–1972

an approximation for the ordinary differential equations (ODEs) system shown in Eq. 7 . Here,
for all τ ∈ [t, t + ∆t], we employ the following approximation, which uses a linear extrapolation
of the velocity values at t and t − ∆t,


dx/dτ = [(u(x(t), y(t)) − u(x(t − ∆t), y(t − ∆t)))/∆t](τ − t) + u(x(t), y(t))
dy/dτ = [(v(x(t), y(t)) − v(x(t − ∆t), y(t − ∆t)))/∆t](τ − t) + v(x(t), y(t))

(9)

For each block Ωr,s , this approximate system of two ODEs (Eq. 9) is equipped with the
additional condition shown in Eq. 8.
Using central-difference formulas, the left sides of Eqs. 5 and 6 are discretized as follows
 n+1
 n+1

n+1
n+1
n+1
n+1
ur+1,s − 2un+1
un+1
1
∆t pr+1,s − pr−1,s
r,s + ur−1,s
r,s+1 − 2ur,s + ur,s−1
−
+
+
2
2∆x
Re
∆x2
∆y 2

−(F1 )n+1
− h1 (x̂(t), ŷ(t)) = 0,
r,s
 n+1
 n+1
(10)
n+1
n+1
n+1
n+1
n+1
n+1
p
v
v
−
p
−
2v
+
v
−
2v
+
v
1
∆t
r,s
r,s
r,s+1
r,s−1
r+1,s
r−1,s
r,s+1
r,s−1
n+1
vr,s
−
+
+
2
2∆y
Re
∆x2
∆y 2

−(F2 )n+1
− h2 (x̂(t), ŷ(t)) = 0,
r,s
(11)
where h1 (x̂(t), ŷ(t)) and h2 (x̂(t), ŷ(t)) are respectively the right sides of Eqs. 5 and 6.
Here the partial derivatives that appear in h1 (x̂(t), ŷ(t)) and h2 (x̂(t), ŷ(t)) are also approximated using central-difference formulas. Finally, for each block Ωr,s , we approximate the law
of conservation of mass for incompressible fluid (Eq. 2) by
un+1
r,s

n+1
n+1
n+1
vr,s+1
− vr,s−1
un+1
r+1,s − ur−1,s
+
= 0.
2∆x
2∆y

(12)

From the theoretical framework presented, the next task involves the choices of implementation strategies.

3
3.1

Implementation aspects
Interpolation

Since (X̂, Ŷ ) is obtained by backtracking, then this point is not necessarily the node of a grid
block at time level n. As all the functions are defined only on the grid nodes, then an interpolation technique is necessary for the effective computation of the h1 (x̂(t), ŷ(t)) and h2 (x̂(t), ŷ(t)).
A simplified version of the inverse distance weighted interpolation formula developed by [4] was
tested by [8] in the context of a formulation of the Path Tubes method for advection equations.
In this work, the inverse distance weighted interpolation formula is employed. Let h be a function defined only on the grid nodes. Given (xr , ys ) ∈ Ωr,s at time t + ∆t, we want to calculate
h(X̂), where X̂ = (x̂(t), ŷ(t)) is the solution of the system of ODEs in 9, with the additional
condition shown in Eq. 8. To this end, assume that X̂ ∈ Ω̂(i, j), where Ω̂(i, j) denote a grid
block at time t = n∆t, whose node is X̂(i, j). Also, at this time t, consider the nearest blocks.
For example, if Ω̂(i, j) is an inner block, then consider the four neighboring blocks Ω̂(i + 1, j),
Ω̂(i − 1, j), Ω̂(i, j + 1) and Ω̂(i, j − 1), whose nodes are, respectively, X̂(i + 1, j), X̂(i − 1, j),
5

1967

1968	

Application of the Path Tubes
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson
Fábio
Ferreira
(2017) Kischinhevsky,
1963–1972

X̂(i, j + 1) and X̂(i, j − 1). Thus, using a simplified version of the inverse distance weighted
interpolation formula proposed by [4], we consider the approximation h(X̂) ∼
= ĥ(X̂), where
 j+1 i+1
−1
 l=j−1
k=i−1 h(X̂k,l )dk,l
j+1 i+1
, if X̂ = X̂i,j ;
−1
d
(13)
ĥ(X̂) =
k=i−1 k,l
l=j−1
 h(X̂ ), if X̂ = X̂ .
i,j
i,j
In Eq. 13, all sums span the indexes of the block Ω̂(i, j) and its nearest neighbors. The
function dk,l measures the Euclidean distance between the points X̂ and x̂k,l , i.e., dk,l = X̂ −
x̂k,l , for all pairs (k, l).

3.2

DFSANE method

In this work, we use the DFSANE algorithm (Derivative-Free Spectral Algorithm for Nonliner
Equations) that was originally developed by La Cruz [15] for the resolution of large linear
systems or not, without the use of derivatives. In fact, such a method does not even employ
resolutions of linear systems, being a direct search method that essentially uses, at each iteration, the value of the application that defines the system at the current point. In [9] DFSANE is
shown to deal effectively and efficiently with the linear systems resulting from the discretization
of the Navier-Stokes equations via the Path Tubes method.
In other words, given a differentiable function f : RN → R, there are several iterative
methods developed to solve the optimization problem

M inf (x)
x ∈ R,
Which seek to determine x∗ , such that ∇f (x∗ ) = 0, where ∇f denotes the gradient vector of f .


In fact, considering f (x) = F (x)2 , we can show that ∇f (x) = 2F (x)T F (x). Thus, is F (x∗ )
is invertible, then ∇f (x∗ ) = 0 if, and only if, F (x) = 0. The DFSANE algorithm seeks to solve
the problem of nonlinear least squares

M inf (x) = F (x)2
x ∈ RN

4

Numerical Results

In this section, we present numerical results obtained using the methodology developed here.
In the Path Tubes method a backward integration over time has to take place in order to
reach the information at the preceding time step. This computation is performed through the
interpolation described above, and the computed values of the previous time step are employed
as auxiliary data for the evaluation of the new time step’s approximation. The system of
ordinary differential equations shown in Eq. 9 is solved employing two steps of the fourth order
Runge-Kutta method. Moreover, since values for u and v are required to compute the backward
solver, and these would still be computed, estimates are provided through extrapolation from
two previously available successive time steps’ values for u and v. Thus, to overcome this
problem, we use the same interpolation described in Eq. 13. In other words, to calculate the
downstream points, in the present work we use linear extrapolations for u and v, at t, along
with interpolations of these functions at points of the spatial domain. Besides, in tests we use
a uniform cell-centered grid with ∆x = ∆y.
6

	

Application of the Path Tubes
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson
Fábio
Ferreira
(2017) Kischinhevsky,
1963–1972

This example is based on a test problem used by Chorin (1968) [1]. Here the two-dimensional
domain is the square Ω = [0, 1]2 , and F is chosen to satisfy exact solutions of the form
u(x, y, t) = −(cos x sin y)e−2t ,
−2t

v(x, y, t) = (sin x cos y)e

(14)

,

(15)

Re
(cos 2x + cos 2y)e−4t + C,
(16)
4
where the pressure is function of Re, and C is an arbitrary constant. The initial conditions and
boundary conditions for u, v and p are chosen according to Eqs. 14, 15 and 16.
Table 1 shows the standard deviations eu and ev generated by the Path Tubes method
p(x, y, t) = −

 N y N x

(Ψn −Ψexact (xk ,yl ,n∆t))2

]1/2 , where the scalar
for this test problem defined as eΨ = [ l=1 k=1 k,lNx ×Ny
function Ψ is stand for u or v. The results in Table 1 were obtained using Re = 10, ∆t = 10−4 ,
and three different time step numbers, between 10 and 10000, together with three different
discretization grids, from a coarse grid (10 × 10) to a fine grid (100 × 100). We can also notice
that, regardless of the dimensions of the grid blocks, the orders of magnitude of eu and ev
decrease to 10−4 after 10000 time steps. This shall be due to the behaviour of the test problem
chosen. In fact, the problem exhibits a transient regime for t  1 that evolves to a very slow
varying behaviour for t  0. Thus, at the slow varying regime, the numerical treatment of the
problem becomes easier. Therefore, the transient regime is the most challenging test for the
present methodology. In particular because of the choice for a linear extrapolation in time as
the setup for the backtracking step (for more details and extensive tests, see [9]).
Time step number
10

1000

10000

Nx × N y
10 × 10
50 × 50
100 × 100
10 × 10
50 × 50
100 × 100
10 × 10
50 × 50
100 × 100

eu
1.047 × 10−3
1.319 × 10−3
1.339 × 10−3
2.115 × 10−3
4.198 × 10−3
4.351 × 10−3
5.139 × 10−4
6.984 × 10−4
6.755 × 10−4

ev
1.031 × 10−3
1.323 × 10−3
1.339 × 10−3
2.108 × 10−3
4.198 × 10−3
4.350 × 10−3
5.079 × 10−4
6.964 × 10−4
6.745 × 10−4

Table 1: Standard deviations of numerical solutions obtained by the Path Tubes method employing at Re = 10 and ∆t = 10−4 .
Fig. 2 compares the contour curves of u and v generated for by the Path Tubes method,
Fig. 2(a) and Fig. 2(c), respectively, using ∆t = 10−4 and Nx = Ny = 100, after 10000 time
steps, against the contour curves of the exact solution for u and v at t = 1, Fig. 2(b) and Fig.
2(d), respectively.
In Fig. 3 we compared the image of the velocity field generated by the Path Tubes method
after 10000 time steps (using ∆t = 10−4 and Nx = Ny = 10) against the image of the exact
velocity field at t = 1.
Observing Figs. 2 and 3 we note that for the present example the solutions generated by
the Path Tubes method are in good visual agreement with the exact solutions described in
Eqs. 14 and 15, even using a coarse grid. This example presents another interesting feature
shown in Eq. 16, where the pressure field depends on the Reynolds number. This fact may
7

1969

1970	

Ferreira
(2017) Kischinhevsky,
1963–1972
Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson

Figure 2: Contour curves of u and v at t = 1 using Nx = Ny = 100, ∆t = 10−4 , and 10000
time steps with Re = 10: (a) analytical solution of u, (b) numerical solution of u, (c) analytical
solution of v, (d) numerical solution of v.

Figure 3: Velocity field V = ue1 + ve2 at t = 1: (a) analytical solution, (b) numerical solution,
using Nx = Ny = 10, ∆t = 10−4 , and 10000 time steps witha Re = 10.
represent an additional difficulty in solving the linear system described by Eqs. 10, 11 and
12, mainly for large Reynolds numbers, being, in this way, a challenging test for the DFSANE
algorithm. Considering Nx = Ny = 50 and ∆t = 10−4 , in Table 2 we show the values of eu
and ev obtained by the Path Tubes method after 100 time steps, using four different values of
Re varying between 1 and 1000. Observing the results shown in the Table 2, we note that the
errors eu and ev , in the order of 10−3 , for all values of Re considered here. This shows that the
DFSANE algorithm was able to work with pressure fields that depend on Reynolds numbers.
Now, we analyze the variations of eu and ev generated by the Path Tubes method for this
test problem with respect to the time step size. Considering Re = 10 and Nx = Ny = 20, in
Table 3 we have the values these standard deviations at t = 1, obtained using different values
8

	

Ferreira
(2017) Kischinhevsky,
1963–1972
Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson

Re
1
100
1000

eu
1.228 × 10−3
4.689 × 10−3
5.429 × 10−3

ev
1.237 × 10−3
4.689 × 10−3
5.422 × 10−3

Table 2: Standard deviations of numerical solutions obtained by the Path Tubes method with
respect to Reynolds number after 100 times steps.
of ∆t.
Time step number
10000
1000
100
10
2
1

∆t
10−4
10−3
10−2
10−1
0.5
1

eu
5.562 × 10−4
6.800 × 10−4
1.178 × 10−3
1.305 × 10−2
1.055 × 10−1
3.627 × 10−1

ev
5.538 × 10−4
6.792 × 10−4
1.171 × 10−3
1.305 × 10−2
1.044 × 10−1
3.682 × 10−1

Table 3: Behavior of the standard deviations of numerical solutions obtained by the Path Tubes
method with respect to time size at t = 1, using Re = 10 and Nx = Ny = 20.
According to Table 3, the errors eu and ev generated by the Path Tubes method apparently
always increase (up to ≈ 10−1 ) as ∆t increases. However, the standard deviations described in
Table 4 show that such a statement is not true. Indeed, employing Re = 10, Nx = Ny = 50,
and three different values of ∆t ≥ 1 (1, 10 and 100), from Table 4 we can see that using ∆t ≥ 1
the errors remain very small, after several time steps.
Time step number
10
100
1000

∆t
100
10
1

eu
1.295 × 10−6
1.475 × 10−5
4.153 × 10−5

ev
6.890 × 10−7
7.829 × 10−6
2.508 × 10−5

Table 4: Standard deviations of numerical solutions obtained by the Path Tubes method using
different values of ∆t ≥ 1, with Re = 10 and Nx = Ny = 50, after several time steps.

5

Conclusion and Future Work

In this work the Path Tubes method was extended to the Navier-Stokes equations. An implicit
semi-Lagrangian algorithm was obtained. Classical schemes for spatial discretization, such as
central-diference formulas can be employed, without the need for upwind techniques, or highorder corrections for time derivatives. From a variety of numerical experiments traditionally
available in the literature, a representative two dimensional test problem was used herein to show
the new technique is accurate and effective even with coarse grids. Moreover, the method shows
effectiveness for a variety of values for Reynolds’ number, even for those related to convection
dominated flows. Such results suggest that this new version of the Path Tubes method can
be used in effective numerical simulations to determine the velocity field of an incompressible
Newtonian fluid’s flow.
9

1971

1972	

Ferreira
(2017)Kischinhevsky,
1963–1972
Application of the Path TubesFábio
Method.
. . et al. / Procedia Computer Science 108C
Ferreira,
Henderson

5.1

Acknowledgments
The authors gratefully acknowledge the financial support provided by FAPERJ (Agência
de Fomento à Ciência, à Tecnologia e à Inovação do Estado do Rio de Janeiro) and CNPq
(Conselho Nacional de Desenvolvimento Cientifico e Tecnológico, Ministry of Science and
Technology,Brazil). The research of N.H. has also been carried out in the framework of
project PROCIENCIA-UERJ funded by FAPERJ.

References
[1] Chorin A. Numerical solution of the navier-stokes equations. Math. Comp., 22:745–762.
[2] Robert A. Astable numerical integration scheme for the primitive meteorological equations. Atmos.
Ocean., 19:35–46.
[3] Staniforth A. and Côté J. Semi-lagrangian integration schemes for atmospheric models a review.
Monthly Weather Rev, 119:2206–2223.
[4] Shepard D. A two-dimensional interpolation function for irregularly-spaced data. In Proc. 23rd
ACM National Conf., page 517, New York, USA. ACM.
[5] Xiao F. A class of single-cell high-order semi-lagrangian advection schemes. Monthly Weather
Rev, 128:1165–1176.
[6] Slattery J.C. Advanced Transport Phenomena. Cambridge University Press, New York, 1999.
[7] Ferziger J.H. and M. Peric. Computational Methods for Fluid Dynamics. 3rdedition, Springer,
New York, 2002.
[8] Henderson N., Sampaio M., and Pena L. Path tubes method: A semi-lagrangian approach for
linear advection equations. Chem.Eng.Sci., 64:3138–3146.
[9] Henderson N., Ferreira F. P., and Kischinhevsky M. Numerical solution of the navier-stokes
equations usingthe path tubes method. Submitted to Chemical Engineering Science, 2017.
[10] Pironneau O. On the transport-diffusion algorithm and its applications to the navier-stokes equations. Numer. Math., 38:309–332.
[11] Smolarkiewicz P.K. and Pudykiewicz J.A. A class of semi-lagrangian approximations for fluids. J.
Atmos.Sci, 49:2082–2096.
[12] Bulgarelli U., Cassuli V., and Greenspan D. Pressure Methods for the Numerical Solution of Free
Surface Fluid Flows. Pineridge Press, Swansea, 1984.
[13] Ghia U., Ghia K.N., and C.T. Shin. High-re solutions for incompressible flow using the navierstokes equations and a multigrid method. J. Comput. Phys, 48:387–411.
[14] Cassulli V. Eulerian-lagrangian methods for the navier-stokes equations at high reynolds number.
Journal of Broadcasting and Electronic Media, 8:1349–1360.
[15] LaCruz W., Martı́nez J.M., and M. Raydan. Spectral residual method without gradient information for solving large-scale nonlinear systems of equations. Math. Comp., 75:1429–1448.

10

