Procedia Computer Science
Volume 80, 2016, Pages 2236–2240
ICCS 2016. The International Conference on Computational
Science

Cryptographic Properties of Equivalent Ciphers
Amparo F´
uster-Sabater1 and Sara D. Cardell2
1

2

Instituto de Tecnolog´ıas F´ısicas y de la Informaci´
on (CSIC), Spain.
amparo@iec.csic.es
Instituto de Matem´
atica, Estat´ıstica e Computa¸c˜
ao Cient´ıﬁca, UNICAMP, Brazil.
sdcardell@ime.unicamp.br

Abstract
In this work the use of nonlinear ﬁltering functions applied to Linear Feedback Shift Registers
(LFSRs) to generate cryptographic sequences has been studied. Emphasis is on the class of
equivalent nonlinear ﬁlter generators whose elements produce exactly the same sequence. Given
a pair (ﬁltering function, LFSR), the work develops a method of computing equivalent ﬁltering
functions applied to diﬀerent LFSRs, where all these ﬁlters generate exactly the same cryptographic sequence. The security of a cipher is that of its weakest equivalent. Thus this article
allows one to compute weaker equivalents of apparently secure generators.
Keywords: Nonlinear ﬁlter, equivalence, sequence, stream cipher, cryptanalysis

1

Introduction

Typically, keystream generators (sequence generators with application in private key cryptography) are based on maximal-length Linear Feedback Shift Registers (LFSRs) [5] whose output
sequences, the so-called PN -sequences, are combined nonlinearly to produce cryptographic sequences. One general technique to design keystream generators is the use of nonlinear ﬁltering
functions applied to LFSRs. In this way, the ﬁltered sequence is generated as the image of a
nonlinear Boolean function f in the LFSR stages. The nonlinear ﬁlter generators here analyzed
(see Fig. 1) consist of two parts.
1. A LFSR with length L, characteristic polynomial p(x) = xL + p1 · xL−1 + · · · + pL−1 · x + pL
with binary coeﬃcients that, from an initial state IS, generates a PN -sequence.
2. A nonlinear Boolean function f : GF (2)L → GF (2), whose input variables are the successive L-bit states of the LFSR and whose image is the binary keystream sequence {zn }.
In fact, the stream cipher SNOW 3G, the heart of the 3GPP conﬁdentiality and integrity
algorithms [1] for LTE and LTE-Advanced, is the most representative example of a practical
ﬁlter generator.
2236

Selection and peer-review under responsibility of the Scientiﬁc Programme Committee of ICCS 2016
c The Authors. Published by Elsevier B.V.

doi:10.1016/j.procs.2016.05.391

Cryptographic Properties of Equivalent Ciphers

F´
uster-Sabater and D. Cardell

Figure 1: A Nonlinear Filtering Generator

2

Fundamentals and basic notation

PN-sequence or maximal-sequence: Binary sequence {sn } generated by a maximal-length LFSR
of L stages with characteristic polynomial p(x), see [5]. Its generic term sn can be written in
i

terms of the roots α2 (i = 0, 1, . . . , L − 1) of p(x) as: sn = T r(C αn ) =
L

L−1
i=0

i

(Cαn )2 ,

n≥0

where C ∈ GF (2 ). If C = 1, then {sn } it is said to be in its characteristic phase.
Nonlinear ﬁltering function: A L-variable Boolean function f (x0 , x1 , . . . , xL−1 ) of degree
r ≤ L.Typically, a nonlinear ﬁlter is deﬁned by the pair (f , LFSR): a Boolean ﬁltering function
f and a LFSR to whose stages the function is applied.
Filtered sequence: Sequence {zn } is the output sequence of the nonlinear function f applied
to the L stages of the LFSR.
Equivalent nonlinear ﬁlters: Two nonlinear ﬁltering functions f1 and f2 applied to LFSR1
and LFSR2, respectively, are equivalent if the pairs (f1 , LFSR1) and (f2 , LFSR2) generate
exactly the same ﬁltered sequence.
Cyclotomic coset: An equivalence relation R is deﬁned on the elements q1 , q2 ∈ Z2L −1 such
as q1 R q2 if there exists an integer j, 0 ≤ j ≤ L − 1, such that 2j · q1 = q2 mod 2L − 1. The
resultant equivalence classes into which Z2L −1 is partitioned are called the cyclotomic cosets
mod 2L − 1, see [5].

3

A Method of Computing Equivalent Nonlinear Filters

The characteristic parameters of the pair (f1 , LFSR1) are summarized as follows: L1 = L is the
length of the LFSR1, p1 (x) is the L-degree characteristic polynomial of LFSR1, α ∈ GF (2L ) is
a root of p1 (x), {an } is the PN -sequence generated by the LFSR1 and f1 is a nonlinear Boolean
function of degree r1 such that f1 (an , an+1 , . . . , an+L−1 ) = zn for n ≥ 0.
The characteristic parameters of the pair (f2 , LFSR2) are summarized as follows: L2 = L is
the length of the LFSR2, p2 (x) is the L-degree characteristic polynomial of LFSR2, β ∈ GF (2L )
is a root of p2 (x), {bn } is the PN -sequence generated by the LFSR2 and f2 is a nonlinear Boolean
function of degree r2 or ﬁltering function equivalent to f1 such that f2 (bn , bn+1 , . . . , bn+L−1 ) =
zn for n ≥ 0. The computation method follows the next steps.
Step 1 : Computation of the relationship between the roots of p1 (x) and p2 (x).
In fact, the root α of p1 (x) and the root β of p2 (x) are related as follows: β = αk and
2237

Cryptographic Properties of Equivalent Ciphers

F´
uster-Sabater and D. Cardell

α = β j , where k and j are integers.
Step 2 : Expression of f1 (an , an+1 , ..., an+L−1 ) in terms of its cosets.
Supposed that the sequence {an } is in its characteristic phase, we can write:
an+i = αi αn + α2i α2n + . . . + α2

L−1

i

α2

L−1

n

.

(1)

Given the ﬁltering function f1 (an , an+1 , ..., an+L−1 ) and substituting each variable an+i (0 ≤
i ≤ L − 1) for the trace function given in (1), we get the expression of f1 in terms of its cosets
such as follows:
L−1

f1 (an , an+1 , ..., an+L−1 ) =

i

(C1 )2 α2

i

·E1 ·n

L−1

+

i=0

i

(C2 )2 α2

i

·E2 ·n

+···

i=0

where Ck ∈ GF (2L ) 1 ≤ k ≤ Nr1 , Ek are the leaders of the diﬀerent cosets with weight ≤ r1
and Nr1 the number of such cosets.
Step 3 : Calculation of the equivalent ﬁltering function f2 .
Substituting α = β j in the previous expression
L−1

i

(C1 )2 (β j )2

f1 (an , an+1 , ..., an+L−1 ) =

i

·E1 ·n

L−1

+

i=0

i

(C2 )2 (β j )2

i

·E2 ·n

+···

i=0

and grouping terms, we obtain the function f2 in terms of its cosets:
L−1

i

(D1 )2 β 2

f2 (bn , bn+1 , ..., bn+L−1 ) =
i=0

i

·E1 ·n

L−1

+

i

(D2 )2 β 2

i

·E2 ·n

+···

i=0

where Dk ∈ GF (2L ) 1 ≤ k ≤ Nr2 , Ek are the leaders of the diﬀerent cosets with weight ≤ r2
and Nr2 the number of such cosets. In fact, each coset Ek in f1 is converted into a diﬀerent
coset Ek in f2 . Now we have to assign to the Nr2 cosets of weight ≤ r2 in f2 their corresponding
terms. After the assignation process, the equivalent ﬁltering function f2 is obtained.

3.1

Discussion of the method

The construction method above described basically involves the following computations:
• Relationship between the roots of p1 (x) and p2 (x): recall that in the expression β = αk , if
k takes the value of a coset leader Ek with weight < L, then the corresponding polynomial
i
L−1
is pk (x) = i=0 (x − αEk ·2 ).
• Calculation of the coeﬃcients associated with the terms of order ≤ r2 : this calculation
can be performed as follows.
1. The coeﬃcients associated with the terms of order r2 are computed by means of the
root presence test [5], whose application is reduced to the computation of a L-order
determinant.
2. The coeﬃcients associated with the terms of order < r2 are computed by means of
the basic ﬁltering functions that includes a unique coset with weight < r2 , see [2]
and [3] for details.
Consequently, it can be concluded that for any nonlinear ﬁlter generator (f , LFSR) diﬀerent
equivalent pairs (fi , LFSRi) can be always obtained able to generate the same sequence. The
procedure is sketched in Algorithm 1.
2238

Cryptographic Properties of Equivalent Ciphers

F´
uster-Sabater and D. Cardell

Algorithm 1. Computation of (f2 , LF SR2) equivalent to the given ﬁlter (f1 , LF SR1)
Input:
The pair (f1 , LF SR1), p1 (x), p2 (x), r1 , r2 , Nr1 , Nr2 .
01: Compute the table of coeﬃcients associated with the terms of order ≤ r2 ;
02: Compute k and j such that β = αk and α = β j ;
03: for i = 1 to Nr1 do
04:
Compute the coeﬃcient Ci of f1 ;
05: end for
06: Substitute α in f1 and group similar powers;
07: for i = 1 to Nr2 do
08:
Compute the coeﬃcient Di of f2 ;
09: end for
10: Assign the terms of f2 corresponding to the coeﬃcients Di ;
Output:
The ﬁltering function f2 in ANF representation.

3.2

Cryptographic properties of equivalent ﬁltering functions

In the previous sections, we have seen that all nonlinear ﬁlters (fi , LFSRi) in the same equivalence class generate the same keystream sequence {zn }. Thus, in order to asses the cryptographic properties of a ﬁlter generator (f , LFSR), one should check whether there exists in
the class of equivalent ﬁlters a weak version with respect to some cryptographic property. The
following example illustrates the lack of invariance of cryptographic properties in the class of
equivalent ﬁlters.
Example 1: Consider the ﬁltered sequence {zn } = {0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1,
0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1} generated by the nonlinear ﬁltering function f = a0 a1 a3 a4 +
a 0 a2 a3 a4 + a 0 a1 a4 + a0 a1 a3 + a1 a3 a4 + a0 a3 a4 + a1 a2 + a1 a3 + a2 a4 + a0 a2 + a0 a3 + a1 + a2 + a3
applied to the stages of a LFSR with L = 5 and characteristic polynomial p(x) = x5 + x3 + 1.
As there are φ(25 − 1)/5 = 6 primitive polynomials of degree 5, we determine the other 5 ﬁlters
equivalent to the original ﬁlter. The coset leaders modulo 25 − 1 are k = {1, 3, 5, 7, 11, 15}, then
i
L−1
fk denotes the equivalent ﬁltering functions and pk (x) = i=0 (x − αEk ·2 ) their corresponding
characteristic polynomials. From the computation method described previously, we obtain:
f1 =
f3 =
f5 =
f7 =
f11 =
f15 =

a 0 a 1 a 3 a 4 + a0 a 2 a 3 a 4 + a 0 a 1 a 4 + a0 a 1 a 3 + a1 a 3 a 4 + a 0 a 3 a 4 + a1 a 2 + a 1 a 3 + a2 a 4 + a0 a 2
+ a0 a 3 + a 1 + a 2 + a 3
a 0 a 1 a 2 a 3 + a0 a 1 a 3 a 4 + a 1 a 2 a 3 a 4 + a0 a 1 a 2 + a0 a 1 a 4 + a 0 a 3 a 4 + a1 a 3 a 4 + a 2 a 3 a 4 + a0 a 1
+ a1 a 3 + a 2 a 4 + a 2 + a 3
a 0 a 1 a 2 a 4 + a0 a 2 a 3 a 4 + a1 a 2 a 3 a 4 + a0 a 1 a 2 + a0 a 1 a 3 + a 0 a 2 a 3 + a1 a 2 a 3 + a0 a 1 a 4
+ a0 a 3 a 4 + a 0 a 2 + a 0 a 4 + a 1 a 4 + a 2 a 4 + a 2 + a 3
a 0 a 1 a 3 + a0 a 2 a 3 + a1 a 2 a 4 + a 1 a 3 a 4 + a2 a 3 a 4 + a1 a 2 + a 0 a 3 + a0 a 4 + a1 a 4 + a 3 a 4 + a0 + a3
a 0 a 1 a 2 + a 0 a 2 a 3 + a1 a 2 a 3 + a0 a 1 a 4 + a 1 a 2 a 4 + a0 a 1 + a 0 a 2 + a1 a 3 + a0 a 4 + a 2
a 0 a 2 + a 1 a 2 + a2 a 3 + a3 a 4 + a 1 + a3

In Table 1, n is the number of variables, r is the function degree, WH denotes the Hamming
weight of the functions, N L denotes nonlinearity, AI denotes algebraic immunity, CI denotes
correlation immunity and SS denotes sum of squares indicator.
As expected, the Hamming weight WH and the number of variables n remains the same
for each function. Nevertheless, recall that none of the other properties remains the same
with respect to the transformation in the same class of equivalence. Protection against, for
2239

Cryptographic Properties of Equivalent Ciphers

F´
uster-Sabater and D. Cardell

instance, algebraic attacks is reached by using ﬁltering functions of high degree [4]. In fact,
algebraic degree and algebraic immunity are two properties of Boolean functions which are
aﬃne invariant. Nevertheless, both properties are not invariant with respect the equivalence of
nonlinear ﬁlters. In order to launch an algebraic attack against these ﬁlters, one would choose
to attack the ﬁlter generator with the weakest ﬁltering function, that is f15 .
n
r
wH
NL
AI
CI
SS

f1
5
4
16
10
2
0
2432

f3
5
4
16
10
3
0
2816

f5
5
4
16
10
2
0
2816

f7
5
3
16
8
2
1
3584

f11
5
3
16
12
3
0
2048

f15
5
2
16
8
2
1
8192

Table 1: Cryptographic parameters of the nonlinear ﬁltering functions

4

Conclusions

In this work, the problem of computing equivalent nonlinear ﬁlters producing the same sequence
as that of a given ﬁlter has been addressed. In fact, known a pair (f , LFSR) generating a
sequence {zn }, we have showed how to determine an equivalence class of ﬁlters, consisting of
all the ﬁlter generators that produce {zn } as output sequence. In general, several properties of
cryptographic relevance are not invariant among the element of such an equivalence class. In
particular, this paper shows that two structures with diﬀerent security level can produce the
same keystream sequence. Indeed, this result means that the actual security level of a ﬁlter
generator is the security level of the weakest element in its class of equivalent ﬁlters. This
analysis makes it clear that one cannot generally analyse the components of a cryptographic
sequence generator separately as it is usual in practice.

Acknowledgment
This work has been funded by M.E.C. Spain under grant TIN2014-55325-C2-1-R (ProCriCiS)
and by C.A.M. under grant S2013/ICE-3095-CM (CIBERDINE).

References
[1] ETSI-SAGE. Speciﬁcation of the 3GPP Conﬁdentiality and Integrity Algorithms UEA2 and UIA2.
Document 3: SNOW 3G Speciﬁcation, version 2.0, http://www.3gpp.org/ftp/
[2] F´
uster-Sabater, A.: Computing Classes of Cryptographic Sequence Generators. Procedia Computer
Science 18, 2440-2443 (2013)
[3] F´
uster-Sabater, A.: Computation of Filtering Functions for Cryptographic Applications. Procedia
Computer Science 29, 2013-2023 (2014)
[4] Ronjom, S.,Cid, C. Nonlinear equivalence of stream ciphers. Fast Software Encryption, pp. 40–54.
Springer-Verlag, 2010.
[5] Rueppel, R.A.: Analysis and Design of Stream Ciphers. Springer, New York (1986)

2240

