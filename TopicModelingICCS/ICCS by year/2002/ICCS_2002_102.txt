FEM-based Structural Optimization with
Respect to Shakedown Constraints
Michael Heitzer
Central Institute for Applied Mathematics (ZAM),
Forschungszentrum Jülich, D–52425 Jülich, Germany
m.heitzer@fz-juelich.de
http://www.fz-juelich.de/zam/ZAMPeople/heitzer.html

Abstract. In this paper, a mathematical programming formulation is
presented for the structural optimization with respect to the shakedown
analysis of 3-D perfectly plastic structures on basis of a finite element
discretization. A new direct algorithm using plastic sensitivities is employed in solving this optimization formulation. The numerical procedure
has been applied to carry out the shakedown analysis of pipe junctions
under multi-loading systems. The new approach is compared to so-called
derivative-free search methods. The computational effort of the proposed
method is much lower compared to this methods.

1

Introduction

In many technically meaningful problems of structures (e.g. in the plant manufacturing) under variable loads the nonlinear behaviour of the material must be
considered. Inelastic analyses of the plastic (time-independent) or viscous (timedependent) behaviour are increasingly used to optimize industrial structures
for safety and for an economic operation. Incremental analyses of the pathdependent plastic component behaviour are very time-consuming. The shakedown analysis belongs to the so-called direct or simplified methods which do not
achieve the full details of plastic structural behaviour. The objective of shakedown analysis is the determination of an operation regime (i.e. safety margin,
load carrying capacities) in which no early failure by plasticity effects has to
be expected. Depending on the magnitude of loading, a structure can show the
following structural failure modes:
– plastic collapse by unrestricted plastic flow at limit load,
– incremental collapse by accumulation of plastic strains over subsequent load
cycles (ratchetting),
– plastic fatigue by alternating plasticity in few cycles, (low cycle fatigue),
– plastic instability of slender compression members (not considered here).
Within the Brite-EuRam Project LISA [17] a procedure is developed using the finite element discretization for direct calculation of the limit and shakedown load
of structures made of ductile material. The shakedown analysis is formulated as

optimization problem, such that it is easily reformulated for use in a structural
optimization process. Determining optimal values for relevant design variables
characterizing the geometrical shape as well as the material behaviour requires
an efficient strategy to perform sensitivity analyses with respect to the design
variables. Heyman [9] was the first to study the problem of optimal shakedown
design. Recently, optimal plastic design of plates with holes under multi-loading
systems [16] have been performed. The presented approach is suitable to general
3-d structures which can be analyzed by a Finite Element code. In the new approach the sensitivity analysis is integrated in the formulation of the shakedown
analysis. This permits an integrated treatment of structural and sensitivity analysis and results into easily applicable and efficient numerical algorithms. For a
general review of sensitivity methods in nonlinear mechanics see [12]. Different
types of problems may be considered in structural optimization:
– maximum shakedown load for a given structure (shape).
– optimum shape (e.g. minimum weight) for given shakedown load.
In this contribution we maximize the shakedown range of pipe junctions of variable thickness of the pipe and the junction.

2

Concepts of Shakedown Analysis

Static shakedown theorems are formulated in terms of stress and define safe
structural states leading to an optimization problem for safe load domains. The
maximum safe load domain is the load domain avoiding plastic failure (with the
exception of plastic buckling). We restrict our presentation to perfectly plastic
material and no elastic failure modes are considered (i.e. no elastic buckling or
high cycle fatigue).
2.1

Static or Lower Bound Shakedown Analysis

The shakedown analysis starts from Melan’s lower bound theorem for time variant loading for perfectly plastic material. Let us suppose that the loads vary in
a convex load domain L0 such that every load P (t) = (b(t), p(t)) which lays in
L0 is generated by N V non-degenerated load vertices Pj . The equilibrium conditions of the shakedown analysis and the yield criterion for the actual stresses
have to be fulfilled at every instant of the load history. For the following considerations the von Mises function F is preferred. The maximum enlargement of
L0 is searched for which the structure is safe. The structure is safe against low
cycle fatigue and against ratchetting if there is a stress field σ(t) such that the
equilibrium equations are satisfied and the yield condition (with yield stress σy )
is nowhere and at no instant t violated.
max α
s.t. F (σ(t)) ≤ σy

in V

divσ(t) = − αb0 (t) in V
σ(t) n = αp0 (t) on ∂Vσ

(1)

for body forces αb0 (t), surface loads αp0 (t). By convexity of L0 the constraints
need to be satisfied only in the load vertices Pj . This makes the problem time
invariant for any deterministic or stochastic load history.
Problem (1) can be transformed into a finite optimization problem by FEM
discretization. For structures with N G Gaussian points in the FEM model one
has to handle O(N G) unknowns and O(N G) constraints. The number of Gaussian points becomes huge for realistic discretizations of industrial structures and
no effective solution algorithms for discretizations of the nonlinear optimization
problem (1) are available. A method for handling such large–scale optimization
problems for perfect plasticity is called basis reduction technique or subspace
iteration [7], [18], [15]. This reduction technique generalizes the line search technique, well–known in optimization theory. Instead of searching the whole feasible
region for the optimum a sequence of subspaces with a smaller dimension is chosen and one searches for the best value in these subspaces.

3

Optimization Techniques

Hooke and Jeeves coined the phrase direct search in a paper that appeared in
1961 [10]. It describes direct search by the sequential examination of trial solutions involving comparison of each trial solution with the best obtained up
to that time together with a strategy for determining (as a function of earlier
results) what the next trial solution will be. Many of the direct search methods are based on heuristics which guarantee global convergence behavior analogous to the results known for globalized quasi-Newton techniques. Direct search
methods succeed because many of them can be shown to rely on techniques of
classical analysis like bisection or golden section search algorithms. For simplicity, we restrict our attention here to unconstrained maximization of function
f : IRn → IR. We assume that f is continuously differentiable, but that information about the gradient of f is either unavailable or unreliable. Because
direct search methods neither compute nor approximate derivatives, they are
often described as derivative-free. For a recent survey on direct search methods
and genetic algorithms see [14] and [6], respectively. A classification of the most
methods for numerical optimization can be done according to how many terms
of the expansion they need [14], e.g.:
– Newton’s method (second order)
assumes the availability of first and second derivatives and uses the secondorder Taylor polynomial to construct local quadratic approximations of f.
– Steepest descent (first order)
assumes the availability of first derivatives and uses the first-order Taylor
polynomial to construct local linear approximations of f.
In this classification, zero-order methods do not require derivative information
and do not construct approximations of f, such that they rely only on values
of the objective function. For comparison with the proposed new method using
plastic sensitivities the optimization codes PDS2 [14], SIMANN [5] and PIKAIA
[1] are used.

3.1

Quasi-Newton Methods

A technique used for iteratively solving unconstrained optimization problems is
the line search method. The method determines the optimal point on a given line
(search direction). A back tracking algorithm is used which starts from an initial
step length and decreases the step length until it is sufficient. The algorithm
of Dennis/Schnabel is used to omit the exact solution of the one-dimension
optimization on the search line [3].
The IMSL routines BCONF and BCONG are used for the maximization [11]
if analytic gradients are available or not, respectively. BCONF/BCONG use a
quasi-Newton method and an active set strategy to solve maximization problems
subject to simple bounds l, u on the variables. From a given starting point xc ,
an active set IA, which contains the indices of the variables at their bounds,
is built. A variable is called a free variable if it is not in the active set. The
routine then computes the search direction for the free variables from a positive
definite approximation of the Hessian and the gradient evaluated at xc ; both
are computed with respect to the free variables. Routine BCONF calculates
the gradient by a finite-difference method evaluated at xc . The search direction
for the variables in IA is set to zero. A line search is used to find a better
point xn = xc + λd, λ ∈ (0, 1]. Finally, the optimality conditions are checked
for a suitable gradient tolerance. Another search direction is then computed to
begin the next iteration. The active set is changed only when a free variable
hits its bounds during an iteration or the optimality condition is met for the
free variables but not for all variables in IA, the active set. In the latter case,
a variable that violates the optimality condition will be dropped out of IA. For
more details on the quasi-Newton method and line search, see [3].
The line search method needs for solving optimization problems a search
direction d. Here the search line is given by the gradients of the shakedown
factor with respect to the design parameters. The shakedown factor is a solution
of a nonlinear optimization problem and therefore the gradients are given by
the sensitivities with respect to the design parameters. Using the chain rule the
problem of the plastic structural behaviour can be reduced to the sensitivity
analysis of the elastic structural response, which is a significant reduction of
computational effort (see [8],[4]). The sensitivity analysis of the elastic response
is performed by a finite-difference method for a small number of parameters, see
[12] for alternative techniques.
3.2

Pattern Search Method

Pattern search methods are characterized by a series of exploratory moves that
consider the behavior of the objective function at a pattern of points, all of
which lie on a rational lattice. The exploratory moves consist of a systematic
strategy for visiting the points in the lattice in the immediate vicinity of the
current iterate [14]. For each move the parameter is varied and it is decided if
there is an improvement, such that the procedure is a direct search. The used

multi-directional search algorithm proceeds by reflecting a simplex through the
centroid of one of the faces [14].
If one replaces a vertex by reflecting it through the centroid of the opposite
face, then the result is also a simplex. The first single move is that of reflection
which identifies the worst vertex in the simplex (i.e. the one with the least desirable objective value) and then reflects the worst simplex through the centroid of
the opposite face. If the reflected vertex is still the worst vertex, then next choose
the next worst vertex and repeat the process. The ultimate goals are either to
replace the best vertex or to ascertain that the best vertex is a candidate for a
maximizer. Until then, the algorithm keeps moving the simplex by flipping some
vertex (other than the best vertex) through the centroid of the opposite face.
An expansion step allows for a more progressive move by doubling the length of
the step from the centroid to the reflection point, whereas a contraction steps
allow for more conservative moves by halving the length of the step from the
centroid to either the reflection point or the worst vertex. These steps allow a
deformation of the shape of the original simplex.
3.3

Simmulated Annealing

Simulated annealing is a global optimization method that distinguishes between
different local maxima. Starting from an initial point, it randomly chooses a trial
point within the step length of the user selected starting point. The function is
evaluated at this trial point and its value is compared to its value at the initial
point. When maximizing a function, any uphill step is accepted and the process
repeats from this new point. An downhill step may be accepted, such that it can
escape from local maxima. Downhill moves may be accepted; the decision is made
by the Metropolis criteria. It uses T (temperature) and the size of the downhill
move in a probabilistic manner. The smaller T and the size of the downhill move
are, the more likely that move will be accepted. If the trial is accepted, the
algorithm moves on from that point. If it is rejected, another point is chosen
instead for a trial evaluation. As the optimization process proceeds, the length
of the steps decline and the algorithm closes in on the global optimum. Since the
algorithm makes very few assumptions regarding the function to be optimized,
it is quite robust with respect to non-quadratic surfaces.
The simulated annealing algorithm of Corana et al. [2] was implemented and
modified in [5] and is obtained from net NETLIB collection of mathematical
software.
3.4

Genetic Algorithms

Genetic algorithms are a class of search techniques inspired from the biological
process of evolution by means of natural selection. A top-level view of a canonical
genetic algorithm could be as follows: Start by generating a set (population) of
trial solutions, usually by choosing random values for all model parameters; then:
1. Evaluate the goodness of fit (fitness) of each member of the current population.

2. Select pairs of solutions (parents) from the current population, with the
probability of a given solution being selected made proportional to that
solution’s fitness.
3. Breed the two solutions selected in (2) and produce two new solutions (offspring).
4. Repeat steps (2)-(3) until the number of offspring produced equals the number of individuals in the current population.
5. Use the new population of offspring to replace the old population.
6. Repeat steps (1) through (5) until some termination criterion is satisfied.
The probability of a given solution being selected for breeding is proportional
to the fitness, such that better trial solutions breed more often, the computational equivalent of natural selection. The production of new trial solutions from
existing ones occurs through breeding. This involves encoding the parameters
defining each solution as a string-like structure (chromosome), and performing
genetically inspired operations of crossover and mutation to the pair of chromosomes encoding the two parents. The end result of these operations are two
new chromosomes defining the two offsprings that incorporate information from
both parents. No derivatives of the goodness of fit function with respect to model
parameters need to be computed. In most real applications, the model will need
to be evaluated a great number of times, such that the evaluation is computationally expensive.
The used PIKAIA subroutine[1] maximizes a user-supplied FORTRAN function using uniform one-point crossover, and uniform one-point mutation.

4

Pipe-junction Subjected to Internal Pressure and
Temperature Loads

A pipe-junction subjected to internal pressure and temperature loads is analyzed
as a simple example. The shakedown analyses are performed for perfectly plastic
material with a yield stress σy = 250N/mm2. The inner diameters D = 39mm
and d = 15mm of the pipe and of the junction are fixed, respectively. The
length of the pipe and of the junction are L = 81.9mm and l = 17.1mm fixed,
respectively. The variable dimensions are the wall-thickness s and t of the pipe
and the junction, respectively. The meshes of the pipe-junction are generated
my an automatic mesh-generator. The different models are discretized with 125
solid 20-node hexahedron elements (HEXEC20). The dimensions of the model
are based on a pipe benchmark problem of PERMAS [15]. The FE-mesh and
the essential dimensions of the different pipe-junctions are represented in Fig. 1.
The pipe junction is subjected to two-parameter loading. Pressure P and temperature difference T vary independentally
0 ≤ P ≤ αµ1 P0 ,
0 ≤ Ti ≤ αµ2 T0 ,

0 ≤ µ1 , µ2 ≤ 1.

P0 and T0 are a reference pressure and temperature difference, respectively.

d

t
l
s
D

L

Fig. 1. FE-mesh and dimensions of the pipe-junction

The goal of the structural optimization in this example is to maximize the
shakedown factor α for the wall-thickness s and t varying in given bounds:
max αs
s.t. 0 < s, t ≤ 7.5.

(2)

For pure pressure variation the optimal wall thickness of the pipe and of the
junction will tend to infinity because of the decreasing elastic stresses. On the
other hand for pure temperature variation the wall thickness of the pipe and of
the junction will tend to zero. Therefore, different finite positive ratios between
the initial pressure P0 and the initial temperature T0 are chosen. The design
variables vary between bounds 0 < s, t ≤ 7.5mm to guarantee that the chosen
mesh of the pipe-junction is not degenerated, otherwise the chosen automatic
mesh-generator leads to meshes with degenerated elements. The shakedown factor αs is the solution of the corresponding shakedown optimization problem with
the load domain L0 defined by P0 and T0 .
Five different mathematical optimization codes using the FEM-based shakedown analysis are compared in the example. The direct methods PDS2, PIKAIA,
SIMANN without the use of gradients and the IMSL routines BCONF and
BCONG, using finite-difference method and analytical gradients, respectively.
All codes use the same subroutine to calculate the shakedown load factor αs .
The default parameters are used for all methods. PDS2 uses a fixed search pattern. BCONF performs a finite-difference method to estimate the gradient, such
that for each gradient at least two additional shakedown analyses have to be
performed. BCONG uses the given analytical gradients. The sensitivities are
calculated using a finite-difference method for the elastic stresses and the algorithm described above.
A comparison of the different methods is shown in Table 1. In addition to
the optimal values s∗ , t∗ and the corresponding shakedown load magnitudes
Ps = αs P0 and Ts = αs T0 the number of function calls (i.e. shakedown analyses) are given. The results for the methods are comparatively close. The values
s∗ , t∗ decrease for increasing temperatures as expected. The PDS2 algorithm is

quite sensitive to the initial starting points, because of its fixed search scheme.
Nevertheless with improved starting values the results for the pattern search
method correspond well with the BCONG routine using the new implemented
sensitivities. In allmost all cases the new method is the fastest method in terms
of function calls. It is evident, that the use of the analytical gradients (BCONG)
is preferable to the use of the finite-difference gradients (BCONF).
Table 1. Comparison of the different methods
Ti0 /P 0 [K/MPa] Method s∗ [mm]
PDS2
7.4665
GA
6.3342
40
SIMANN 5.5894
BCONF 5.5654
BCONG 7.5000
PDS2
6.9828
GA
6.6958
80
SIMANN 5.9183
BCONF 4.1465
BCONG 7.1101
PDS2
5.1344
GA
6.3168
100
SIMANN 6.8760
BCONF 4.5733
BCONG 4.1404
PDS2
6.9835
GA
7.3553
120
SIMANN 6.6813
BCONF 7.5000
BCONG 7.5000
PDS2
5.2488
GA
5.5639
160
SIMANN 4.4377
BCONF 4.9742
BCONG 3.8007
PDS2
6.0650
GA
5.3168
200
SIMANN 4.5928
BCONF 4.4038
BCONG 3.9576

t∗ [mm] Ps [MPa]
6.8200
19.90
5.1185
20.72
3.8753
19.56
3.7504
18.08
6.3041
19.75
6.6913
13.52
5.4724
14.44
4.5799
13.56
5.7304
11.65
4.9480
13.15
4.0902
10.07
4.5315
11.97
4.7475
12.21
3.4209
10.71
4.2517
10.10
6.6906
10.35
5.0235
10.47
5.0391
10.61
4.4788
9.13
6.7115
10.57
4.6217
7.21
5.0309
8.35
3.2308
7.50
4.0640
7.81
2.9375
6.96
5.7721
6.60
3.5315
6.26
3.7583
6.52
3.9833
6.43
3.5771
6.03

Ts [K] function calls
796
17
829
17
782
59
720
52
790
12
1082
50
1155
10
1085
16
932
45
1052
4
1007
22
1197
13
1221
13
1072
41
1011
9
1242
7
1256
4
1273
19
1096
27
1268
6
1154
41
1336
11
1200
21
1249
75
1114
12
1320
15
1252
13
1304
12
1286
68
1207
5

It has to be noticed that the function f (s, t) = αs is not convex, such that
probably local maxima exist in the region 0 < s, t ≤ 7.5mm. For instance in
load level Ti0 /P 0 = 100 [K/MPa] the resulting shakedown load magnitudes Ps
and Ts are close for BCONG and PDS2, but for GA and SIMANN the values

s∗ , t∗ are fairly different. This may indicate that the global maximum in the
region 0 < s, t ≤ 7.5mm has not yet reached by BCONG and PDS2 but with
the global methods GA and SIMANN. Additional computations suggest, that
the temperature difference Ts ≈ 1400 K is the highest allowable temperature
load in the region 0 < s, t ≤ 7.5mm.

5

Conclusion

Shakedown theorems are exact theories of classical plasticity for the direct computation of safety factors or of the load carrying capacity under varying loads.
This method can be based on static and kinematic theorems for lower and upper
bound analysis. Using Finite Element Methods more realistic modeling can be
used for a more rational design. A mathematical programming formulation is
presented for the structural optimization with respect to the shakedown analysis of 3-D perfectly plastic structures. A new direct algorithm using plastic
sensitivities is employed in solving this optimization formulation. The numerical
procedure has been applied to carry out the shakedown analysis of pipe junctions
under multi-loading systems. The computational effort of the proposed method
is lower compared to so-called derivative-free direct search methods.

6

Acknowledgements

Parts of this research have been funded by the Brite-EuRam III project LISA:
FEM-Based Limit and Shakedown Analysis for Design and Integrity Assessment
in European Industry (Project N◦ : BE 97-4547, Contract N◦ : BRPR-CT970595).

References
1. Charbonneau, P.: Genetic Algorithms in Astronomy and Astrophysics, The Astrophysical Journal (Supplements), 101 (1995) 309-334
2. Corana A., Marchesi M., Martini C., Ridella S.,: Minimizing Multimodal Functions
of Continuous Variables with the ”Simulated Annealing” Algorithm, ACM Transactions on Mathematical Software 13 (1987) 262-280
3. Dennis, J.E., Schnabel, R.B.: Numerical methods for unconstrained optimization,
Engelwood Cliffs, N.J., Prentice Hall (1983)
4. Fiacco, A.: Introduction to Sensitivity and Stability Analysis in Nonlinear Programming, New York, Academic Press (1983)
5. Goffe, W.L., Ferrier,G., Rogers, J.: Global Optimization of Statistical Functions
with Simulated Annealing, Journal of Econometrics 60 (1994) 65-99
6. Goldberg, D.E.: Genetic Algorithms in Search, Optimization, and Machine Learning
Addison Wesley (1989)
7. Heitzer, M.: Traglast– und Einspielanalyse zur Bewertung der Sicherheit passiver
Komponenten, Berichte des Forschungszentrums Jülich Jül–3704 (1999)
8. Heitzer, M.: Structural optimization with FEM-based shakedown analyses Journal
of Global Optimization (to appear).

9. Heyman, J.: Minimum weight of frames under shakedown loading. Journal of Engineering Mechanics, ASCE 84 (1958) 1–25
10. Hooke, R., Jeeves, T.A.: Direct search solution of numerical and statistical problems. J. Assoc. Comput. Mach. 8 (1961) 212–229
11. IMSL: Fortran Subroutines for Mathematical Application, Math/Library Vol. 1 &
2 Visual Numerics, Inc. (1997)
12. Kleiber, M., Antúnez, H., Hien, T.D., Kowalczyk, P.: Parameter Sensitivity in
Nonlinear Mechanics: Theory and Finite Element Computations, New York, J. Wiley
& Sons (1997)
13. König, J. A.: Shakedown of Elastic–Plastic Structures, Amsterdam and Warsaw,
Elsevier and PWN (1987)
14. Lewis, R.M., Torczon, V., Trosset, M.W.: Direct search methods: then and now,
Journal of Computational and Applied Mathematics 124 (2000) 191–207
15. PERMAS: User’s Reference Manuals, Stuttgart, INTES Publications No. 202, 207,
208, 302, UM 404, UM 405 (1988)
16. Schwabe, F.: Einspieluntersuchungen von Verbundwerkstoffen mit periodischer
Mikrostruktur, Phd-Thesis, RWTH-Aachen (2000)
17. Staat, M., Heitzer M.: LISA a European Project for FEM-based Limit and Shakedown Analysis, Nuclear Engineering and Design 206 (2001) 151-166
18. Stein, E., Zhang, G., and Mahnken, R.: Shakedown analysis for perfectly plastic and
kinematic hardening materials, in Stein, E. (ed.): Progress in computational analysis
of inelastic structures, Wien, Springer, 175–244 (1993)

