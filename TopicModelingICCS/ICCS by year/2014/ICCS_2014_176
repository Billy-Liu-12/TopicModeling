Procedia Computer Science
Volume 29, 2014, Pages 1156–1170
ICCS 2014. 14th International Conference on Computational Science

Integration of artiﬁcial neural networks into operational
ocean wave prediction models for fast and accurate
emulation of exact nonlinear interactions
Ruslan M. Puscasu12
1

The University of Queensland, St Lucia, QLD, 4072 Australia
Swinburne University of Technology, VIC, 3122, Australia
r.puscasu@uq.edu.au

2

Abstract
In this paper, an implementation study was undertaken to employ Artiﬁcial Neural Networks
(ANN) in third-generation ocean wave models for direct mapping of wind-wave spectra into
exact nonlinear interactions. While the investigation expands on previously reported feasibility
studies of Neural Network Interaction Approximations (NNIA), it focuses on a new robust neural
network that is implemented in Wavewatch III (WW3) model. Several idealistic and real test
scenarios were carried out. The obtained results conﬁrm the feasibility of NNIA in terms of
speeding-up model calculations and is fully capable of providing operationally acceptable model
integrations. The ANN is able to emulate the exact nonlinear interaction for single- and multimodal wave spectra with a much higher accuracy then Discrete Interaction Approximation
(DIA). NNIA performs at least twice as fast as DIA and at least two hundred times faster than
exact method (Web-Resio-Tracy, WRT) for a well trained dataset. The accuracy of NNIA is
network conﬁguration dependent. For most optimal network conﬁgurations, the NNIA results
and scatter statistics show good agreement with exact results by means of growth curves and
integral parameters. Practical possibilities for further improvements in achieving fast and highly
accurate emulations using ANN for emulating time consuming exact nonlinear interactions are
also suggested and discussed.
Keywords: Artiﬁcial neural networks, nonlinear wave-wave interaction, exact nonlinear interaction,
ocean wave forecast, wind-wave models, oceanic models, data assimilation, numerical climate and
weather prediction

1

Introduction

Numerical wave modelling plays an important role in the provision of marine forecasts at a
large number of weather centres around the globe. In order to provide forecasts of the sea
state meteorological centres run wave models that compute the dynamics of the sea surface by
1156

Selection and peer-review under responsibility of the Scientiﬁc Programme Committee of ICCS 2014
c The Authors. Published by Elsevier B.V.
doi:10.1016/j.procs.2014.05.104

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

solving transport equation that describes the evolution of interacting weakly-nonlinear waves
[22, 9]. Third-generation (3G) ocean wave models such as WAM [22], SWAN [15], WW3 [17, 23],
TOMAWAC [3], CREST [1] are widely used. Although wave generation, dissipation and nonlinear interaction (NI) processes are described explicitly in all these 3G models, operationally they
employ approximations, instead of exact methods, in the calculation of NI. The computation
of nonlinear interactions is by far the most expensive step in model integration both in terms
of computing time and resource allocation. Consequently, several approximations have been
developed and practically used such as Discrete Interaction Approximation (DIA) [5]. The DIA
is computationally fast but it also has many known deﬁciencies [2]. Most importantly, DIA and
its extensions introduces many empirical parameters which require ﬁne tuning of the models.
Eﬀorts have been directed towards the development of practical nonlinear interaction algorithms that would replace approximations such as DIA. New approaches should be able to
provide more accurate nonlinear interactions without signiﬁcantly increasing the computational
costs of operational models. Although computing capabilities have also increased over the last
decades making more expensive parameterizations economically feasible, currently only two
approaches seem to be practically feasible and namely, the Multiple or Extended DIA (MDIA
or EDIA) including the Generalized Multiple DIA (GMD) [16] and Multiple DIA based on the
exact SRIAM method [8], and Neural Network Interaction Approximation (NNIA) [16].
We focus our attention on the last group of developments and propose a fast and accurate
NN that is capable of emulating exact nonlinear interactions in an accurate yet timely fashion.
The aim was to study the viability of a neural network approach based on direct mapping in
an operational setting.

2

Nonlinear interactions

We shall brieﬂy introduce the background theory, speciﬁcally the so called Hasselmann eq. that
is the basic model for statistical description of surface gravity waves. The approach used here
has been discussed in detail elsewhere and we only recall the main relations required for the
discussion that follows. Although the framework describing nonlinear four-wave interactions [4]
was initially derived for evolution of weakly nonlinear free waves with no wind input and no
dissipation, it was further generalized to the case of wind waves and later became a core element
of 2G and 3G spectral forecasting models of wind driven seas. The extended Hasselmann eq.
also referred to as the kinetic equation for weakly nonlinear water waves can be written as
∂Nk
+ ∇k ωk ∇r Nk = Sin [Nk ] + Snl [Nk ] + Sdiss [Nk ]
∂t

(1)

with N = N (k, θ, x, t). The intrinsic frequency ω satisﬁes linear dispersion relation (LDR)
for gravity waves. Nk is the wave action spectral density that can be expressed in terms of
F (k) = ωN (k), the spectral density of wave variance. The interactions are conventionally
expressed in terms of the rate of change of the action spectrum N (k) as
∂N1
=
∂t

G × [N3 N4 (N1 + N2 ) − N1 N2 (N3 + N4 )] × δ(k) × δ(ω) × dk2 dk3 dk4

(2)

where Ni = N (ki ) is the action density at wavenumber ki and G is a coupling coeﬃcient given
in [24]. The δ-functions ensure that contributions to the integral only occur for quadruplets
satisfying the resonance conditions. Nonlinear interactions describe the conservative resonant
exchange of action, energy and momentum between four spectral components (quadruplet)
1157

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

which satisfy the resonance conditions [4]. Eq. (2) represents a 6D Boltzmann integral. Resonance conditions reduces this to a 3D integral. Even in this form, the solution of the integral
requires several orders of magnitude more computational eﬀort than all other elements of a
wave model combined. This implies that a 3G model based on Eq. (2) are several orders of
magnitude more expensive to run than 1G or 2G models. 3G models solve Eq. (1) explicitly
without assuming a form for the evolving spectrum. The prognostic variable is either the frequency spectrum F (ω, θ) as in WAM model [22] or wavenumber spectrum F (k, θ) as in WW3
model [17]. The wavenumber spectrum in WW3 model is chosen due to its invariance characteristics with respect to physics of wave growth and decay for variable water depths. WW3
model solves the linear balance equation for the spectral wave action density N in terms of
wavenumber k and wave direction θ, as a slowly varying function of space x and time t. Thus,
the wave transport equation is written either as Eq. (1) or as ∂F /∂t + ∇(cg F ) = Stot with
F = F (ω, θ, x, t); the 2nd term represents the advection of wave energy at group velocity cg .
The total source term Stot that contributes to wind-wave evolution is based at least on three
physical processes. These are atmospheric input Sin , wave dissipation Sds , and NI, and are
written as Stot = Sin + Sds + Snl . Although it is generally accepted that for deep water Stot
is based on three processes, in more general cases, additional processes are added or individual
terms are further subdivided [9, 17].

3

Neural Networks

We use a multi-layered ANN also known as multi-layer perceptron to directly map wave spectra
F (ω, θ) into corresponding exact nonlinear interactions spectra Snl (ω, θ). Generally, neural
networks are non-linear statistical data modeling tools used to model complex relationships
between inputs and outputs or to ﬁnd patterns in data. Neural networks became attractive to
a broad community of professionals working in various ﬁelds of geosciences such as geophysical
modelling, satellite remote sensing, oceanography, meteorology etc. A rich body of literature
exists on this topic and a variety of applications have been developed in diﬀerent weather and
climate related areas [11].
In the context of wave modeling, Krasnopolsky et al. [10], Tolman et al. [19, 16] and Wahle
et al. [21] investigated the use of artiﬁcial neural networks as an alternative to the complex
Boltzmann integral calculations such as EXACT-NL [5] and WRT methods [20]. Generally,
the neural network conﬁguration and the choice of the training data are the main factors
that are crucial in the successful implementation of a NNIA. In Krasnopolsky et al. (2002)
[10], which was the ﬁrst approach of its kind, the spectra and the corresponding nonlinear
interaction spectra are assumed to be separable functions of frequency and direction which
are approximated by expansion series. The neural network is then used to map the two sets
of expansion coeﬃcients. Tolman et al. [19] replaced this assumption by a 2D Empirical
Orthogonal Function (EOF) expansion that is limited to single-peaked spectra. Wahle et al.
[21] studied the feasibility of an alternative approach based on direct mapping that is capable
of emulating multi-peaked spectra. Although our study is a continuation of work presented
by Wahle et al. [21], the main eﬀorts were directed towards a tool that is capable of being
implemented in an operational setting.
Tolman (2011) [18], concluded that a successful NNIA needs to incorporate at least the following elements: (1) a neural network approach to estimate the interactions from the spectrum,
(2) an explicit estimate of the neural network error [for example by estimating the spectrum
from the source term with an inverse neural network, (3) a fall-back interaction approximation
to be used when the error estimate indicates that the neural network is insuﬃciently accurate
1158

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

and (4) an explicit way to deal with build-up of noise in spectral scales that are not resolved
by the neural network.
The ﬁrst step in validating the practical use of the direct mapping approach in an operational
setting is to implement the FeedForward-BackPropagation (FFBP) neural network program [14]
the feasibility of which has been previously discussed by Wahle et al. [21]. Such an attempt
was made during this study and the obtained results will be discussed further below. Wahle
et al. concluded that direct mapping approach can give very accurate emulations of nonlinear
interactions provided multi-modal spectra are well represented in the training datasets. We have
limited our study to an idealized test case and were able to reproduce high quality emulations.
Nevertheless, the speed of emulations was the critical factor that led us to abandon the code
for real cases. The FFBP NN program is written in C and therefore was coupled with the
WW3 through an interface. This interface essentially replaces the NI model integration by
I/O operations from/to the external neural network program and hence signiﬁcantly aﬀects the
overall computing time.
In order to integrate a neural network into an operation model such as WW3 (written in
Fortran 95) which is capable of addressing the four requirements highlighted by Tolman (2011)
[18], it is necessary to either develop both the new source term and the neural netsork training
code fully in Fortran or to develop the training code in a language of choice but to make the
trained network available as a Fortran code. It is the later strategy that we decided to pursue.
Our network was based on an open source solution written for Python [25]. The core functions
are implemented in Fortran 77 which are wrapped with Python f2py functionality. This method
outstands in performance pure python training packages and is competitive with languages such
as C or Fortran. In addition, the inbuilt multiprocessing capabilities make the network ideal for
large scale problems. Moreover, a trained network can be directly exported to Fortran sources,
compiled and called from within WW3. This excludes the necessity of writing the new source
function. Additional unique features such as network connectivities without cycles, various
optimization schemes (including standard back-propagation with momentum, rprop, conjugate
gradient, bfgs, tnc, genetic algorithm based optimization etc.), access to exact partial derivatives
of network outputs vs. its inputs or automatic normalization can be exploited. The network
has, however, only feed-forward architecture. The input units have identity activation function,
all other units have sigmoid activation function. Data are automatically normalized, both input
and output, with a linear mapping to the range (0.15 - 0.85) so that each variable was given
equal initial importance independent of its scale. Each input and output is treated separately
(i.e. linear map is unique for each input and output). There were no direct connections between
the input and output layers; all nodes of the hidden layer were connected to all nodes of the
input layer, and all nodes of the output layer were connected to all nodes of the hidden layer.
The weights of the network connections are initially randomized and then optimized/trained
by applying a number of learning steps of a truncated Newton algorithm [12] as implemented
in SciPy [13].
The training of neural networks can be a very intensive and time consuming process and
therefore one needs to determine the optimal conﬁguration of the neural network from the start.
First of all, it is important to determine the minimum number of variables needed to represent
the spectra (input layer) and the corresponding nonlinear interaction spectra (output layer).
Commonly, for this purpose, an auto-associative neural network, which maps the spectra onto
itself while compressing them in between, usually reduced via a linear mapping, is constructed.
The diﬀerence between the original and the reproduced spectrum gives a measure of the quality
of the reduced representation. The results of the neural network conﬁguration analysis and the
details of the choice of the optimal conﬁguration will be given and discussed in the next section.
1159

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

4

Results and Discussion

To prove the viability of the neural network approach in an operational setting such as WW3
we conducted a series of preliminary simulations using a readily available FFBP neural network
program [21] previously used in the context of wave modelling (n.b. not in an operation model).
The ﬁrst academic test is an idealized duration-limited simulation of the wave evolution for a
single point in the inﬁnite ocean and under homogeneous wind-forcing with a constant speed
and direction commencing from calm conditions. Two subtests were conducted, namely 90° and
180° turning winds. The second scenario covers a realistic case and namely a hindcast for Lake
Michigan using a new neural network In addition, in the second case, a comparison of integral
metrics for two US National Data Buoy Center (NDBC) buoys is conducted.
Wind-wave evolution for the 1st test scenario was investigated by four means of nonlinear
interaction: (a) with DIA parameterisation, (b) with WRT exact computations, (c) with neural
network emulations that have been trained with wave and DIA spectra (d) with neural network
emulations that have been trained with wave and WRT spectra. Since the DIA method is
much faster than WRT method, case (c) was used mainly for testing purposes and therefore
the results for case (c) are not included in this paper. The duration of this test was limited to
6 hours of simulations with a global time stepping of 30 seconds (15 seconds for source term
integration).
In the FFBP program, a multi-layered ANN with back-propagation is used. It consists of
one input layer, three hidden layers and one output layer. The wave spectrum is interpreted as
a 600-dimensional vector, and so the neural network has 600 neurons in the input and output
layer. Each of the trained neural network had three hidden layers with 80 neurons in the ﬁrst
and third hidden layer, and with 39 neurons in the middle bottleneck layer as an optimum
conﬁguration suggested by Wahle et al. [21].
Several examples of neural network emulations for the ﬁrst idealized test case with FFBP
neural network program and WW3 are given in Figure 1. Figure 1 displays the total energy
(spectral density) at three diﬀerent time moments for homogeneous wind-forcing with a constant
wind speed U10 = 12m/s and a 180° turning wind after four hours of hindcast. In the left panel
of Figure 1, the nonlinear interactions have been calculated via WRT method. In the middle
panel of Figure 1 the nonlinear interactions have been calculated via NNIA (n.b. WRT method
used for training) and in the right panel the DIA method has been used in hindcast. Each panel
(from top to bottom) shows the growth curves at three diﬀerent moments in time i.e. after 1,
4 and 6 hours, respectively. It can be seen from these ﬁgures that the growth curves of total
wave energy obtained via NNIA method are reproduced well in this idealized academic test and
so are the integral wave properties (i.e. wave hight, total energy and peak frequency). Despite
a slight diﬀerence in the directional wave spectra obtained via NNIA and WRT methods, the
directionally integrated spectral densities for both methods are almost identical and so is the
wave hight (0.84m) at 1968-06-06 04:00:00. DIA performs reasonably well but overestimates
the wave hight (1.0m). As multi-peak spectra start developing due to turning winds the neural
network clearly outperforms the DIA in terms of wave hight [0.96m (NNIA) vs 1.19m (DIA);
the target (WRT) being 0.93m).
The outstanding performance of the neural network is mainly due to the fact that all the
wave spectra and their corresponding nonlinear interaction have been considered in the training
process which means that the network is well trained. As the number of spectra in the training
dataset decreases from its maximum value, a bias in the total energy starts to appear (ﬁgures
are not shown here). Also, the noise in the directional distribution of total energy and nonlinear
interaction source term ampliﬁes with lowering the training dataset as well as with decreasing
1160

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

Figure 1: Samples of neural network emulations for an idealized test case with FFBP NN
program [[21]] and WAVEWATCH III. Left panel: NI via WRT method. Middle panel: NI via
NNIA method (WRT trained). Right panel: NI via DIA method. Each panel shows (from top
to bottom) the growth curves (directional and directionally integrated) of total spectral density.
The insets show the simulations details and integral parameters.

1161

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
3

2

10

3

10

10

50_50_50
60_40_60
100_50_100

2

10

50_50_50
60_40_60
100_50_100

50_50_50
60_40_60
100_50_100
2

1

10

1

10

10

0

time,h

rrs

−1

10

e

e

min

10

0

10

1

10

−2

10

0

10
−3

−1

10

10

−4

10

−1

10
−2

10
2

2

10

3

10

10

50_50_50
60_40_60
100_50_100

50_50_50
60_40_60
100_50_100

1

1

2

0

10

−1

10

time,h

rrs

10

e

e

min

10

0

10

0

10

−2

10

−2

10

10

2

3

2

10

10

10

50_50_50
60_40_60
100_50_100

50_50_50
60_40_60
100_50_100

1

2

10

0

10

−1

10

time,h

errs

min

50_50_50
60_40_60
100_50_100

1

10

e

1

10

−1

10

0

10

−1

10

10

−2

10

50_50_50
60_40_60
100_50_100

1

10

0

10

−2

0

10

1

10

2

3

10

10

iterations

4

10

5

10

10

0

10

1

10

2

3

10

10

iterations

4

10

5

10

0

10

1

10

2

3

10

10

4

10

5

10

iterations

Figure 2: Training error and time as function of the number of learning steps for diﬀerent neural
network conﬁgurations. Training based on 83 (upper row), 783 (middle row) and 1783 (lower
row) spectra, respectively.

the network size which suggests that noise accumulation can have a signiﬁcant negative impact
when the network is poorly trained. Although the results presented in Figure 1 prove that
neural network based on the FFBP program is successful in directly mapping the wave spectra
in an operational setting, the increase in computing time (NNIA being over 100 times slower
compared to DIA) excludes this implementation from any further investigations.
To address the fundamental requirement (i.e. the speed-up factor) that NNIA was potentially useful in operational models, we have considered a new neural network described in
Section 3. Such a neural network should be able to reproduce exact nonlinear interactions
for computational costs comparable to those of DIA. The following section demonstrates the
potential of such a NNIA. It is important to mention that the new neural network was tested
both in the idealized test conditions as well as in a realistic case. We limit our further results
and discussion to the realistic test case.
The Lake Michigan test case is a hindcast in realistic sea at two NDBC buoys located in
the southern and northern center of the lake, respectively, Figure 3. NDBC buoy 45002 45.344°N 86.411°W (45°20’40” N 86°24’41” W) and NDBC buoy 45007 - 42.674°N 87.026°W
(42°40’25” N 87°1’34” W). The duration of the hindcast covered a period of 75 days, from 1
September to 14 November 2002, with a time stepping of 7.5 minutes (15 seconds for source term
1162

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

integration). Spectral properties are set to 31 frequencies log-scaled between f = 0.07...1.04Hz
and 36 directions. In order to train the neural network with exact nonlinear interactions, a
subset of spectra have been chosen to externally calculate nonlinear interactions with the WRT
code.
A major issue in using neural networks is the selection
of network architecture and appropriate input data patterns that are likely to inﬂuence the desired output. We,
therefore, considered a more detailed analysis of the neural
network selection strategy and in particular training error
calculation. This permits a judicious selection of an optimal conﬁguration to ensure outcomes within reasonable
error limits without creating very large and time consuming training processes. Three-layered feed-forward backpropagation networks were developed with an optimization
method based on truncated Newton Conjugate Gradient algorithm. In order to have more control over the training the
speciﬁed condition is the number of iterations rather than
the desired error.
Figure 3: Lake Michigan - NDBC
To explore the quality of the supervised training we debuoy 45002 and 45007.
ﬁne two errors. Firstly, we deﬁne the relative-root-square
error as:
errs =

ω

[Starget (ω, θ) − Soutput (ω, θ)]2 ΔωΔθ
θ
ω

[Starget (ω, θ)]2 ΔωΔθ

,

(3)

θ

where Starget (ω, θ) is the spectrum of nonlinear interactions calculated via WRT method.
Soutput (ω, θ) is the spectrum of nonlinear interactions mapped by the neural network. In addition, we deﬁne a training error as:
⏐i
⏐
emin = min[f (xnk )]⏐ ,
(4)
1

where min[. . . ] is the solution [local minimum of f (xnk )] of large-scale Newton-type minimization via the Lanczos method. This method is very useful when the number of
variables xnk is very large [12]. The function minimized during training is a sum of
squared errors of each output for each training pattern which can be written as f (xnk ) =
1
2
n
k [Soutput (n, k) − Starget (n, k)] , where n is the number of patterns and k is the numn
ber of input/output/target points in each pattern (or the dimension of input/output/target
vectors). i is the number of iterations (also called maximum number of functions). Since the
number of patterns varies in our simulations but the dimension of the input/output vectors is
kept constant, the training error is intentionally multiplied by the input/output dimension k
so that the error reﬂects the global error of the entire patterns and not of each separate vector
element. A percentage deviation measure of the neural network is given by = 100%e˙ min /k.
We deﬁne the neural network conﬁguration by Ni Nm No where Ni , Nm and No is the number of neurons in the input, middle (or bottleneck) and output layer, respectively. An example
of network performance with diﬀerent number of training iterations for network conﬁguration
60 40 60 is shown in Fig.4. The results suggest that the artiﬁcial neural network is eﬀective in
reproducing nonlinear interactions provided the number of iterations is at least 104 . Examples
of the performance of the neural network in terms of errors with diﬀerent number of iterations
1163

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

Table 1: Training cases for Lake Michigan hindcast.
Training
case

Nr. of
spectra

NN conﬁguration

Nr. of training
iterations

Error
emin

A
B

1783
14264

60 40 60
60 40 60

104
104

0.21
0.15

Training
time
15hours
11days

and for diﬀerent network conﬁgurations are shown in Fig.2. Upper row depicts emin , errs and
total learning time function of number of learning steps (or iterations) and training sets.
It can be seen from Figure 2 that, at the beginning of the training, the outcome of the
network will diﬀer largely from the desired output. The training starts with a global training
error of almost 100% for n = 83 (or
0.1% per output element). The error is network
conﬁguration dependent and emin can get as low as 0.01% for the most complex neural networks
providing the highest number of learning steps is used. As the number of patterns in the training
dataset increases the training errors seem to saturate with the number of iterations and for the
network 100 50 100 the saturation value of the global error sits around 10% (
10−3 %). errs ,
on the other hand, can even increase with the number of iterations. One explanation for this
eﬀect is that the spectra of nonlinear interactions have both positive and negative values and
consequently the absolute diﬀerence in Eq. (3) can result in zero errors when in fact the output
and target are very diﬀerent. errs should be used with a lot of care and be considered as
indicative only.
Some of the testing results for Lake Michigan are shown in Figures 5 - 8. The results were
studied by comparing the time history of network hindcasts with actual observations and exact
computations, by means of times series analysis and scatter statistics (scatter points, Pearson
correlation coeﬃcient, root-mean- square error, bias, and scatter index). The network conﬁguration, number of iterations, as well as the minimum global error achieved within the speciﬁed
number of iterations and training runtime are given in Table 1. Case A has approximately
4% of the total number of spectra trained while Case B has 8 times that number. Note that
WW3 uses dynamic time stepping and therefore these ﬁgures are estimative. We assume a 2.5
minutes static time step for source term integration.
Figures 5 and 6 show the time history
of Hs values for the entire hindcast interTable 2: Relative runtimes of the wave model val at NDBC buoy 45002 NDBC buoy 45007,
with various nonlinear interaction source terms. respectively. Note that directional data is
only available over the duration of the simuWRT
DIA
NN
lation for the latter station. The correspond(a) Academic Test
120
1
0.7
ing scatted diagrams are given in Figure 8.
1702
1
1.2
(b) Lake Michigan 1
It may be noted that the rising and falling
1 Case B of Table 1
2 Estimated from a 5 days hindcast
tendencies of observed wave heights are fairly
picked up in the neural network output. At
a ﬁrst glance, the observations and WRT predictions seem to be fairly close to each other for
buoy 45002 and to a lesser extent for buoy 45007. The NNIA seem to perform less favorable for
both stations. However, the trend for buoy 45002 is clearly positive as the number of spectra
considered in the training increases, from Case A to Case B which indicates that the size of the
training datasets does play an important role. This is further conﬁrmed by the corresponding
high value of correlation coeﬃcient which is ρ = 0.963 for NDBC buoy 45002 and ρ = 0.959 for
NDBC buoy 45007.
In the above computational region, two output points have been chosen for a closer visualization of the wave spectra and corresponding nonlinear interaction spectra and namely: point
1164

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
TARGET

TARGET

−4

−4

x 10
1

1.5

x 10

nonlinear transfer rate [m2]

direction

1

0

0.5

0

−0.5

−1

10000 steps

−1
−4

x 10
1

1.5

−4

10000 steps

−4

1000 steps

x 10

direction

2

nonlinear transfer rate [m ]

1

0

0.5

0

−0.5

−1
1000 steps

−1
−4

x 10
1

1.5

x 10

direction

2

nonlinear transfer rate [m ]

1

0

0.5

0

−0.5

−1

−1

100 steps

100 steps

−4

−4

x 10
1

1.5

x 10

0

nonlinear transfer rate [m2]

direction

1

0.5

0

−0.5

frequency

−1

−1
0

0.2

0.4

0.6
frequency [Hz]

0.8

1

1.2

Figure 4: Emulation performance function of number of training steps for network conﬁguration
60 40 60. The top row shows the target nonlinear interaction spectra. The left panel displays
the 2D spectra and the right panel displays the directionally integrated spectra, respectively.

1 at time 2002-11-14 06:00:00), point 2 at time 2002-10-02 03:00:00. The wave spectra and
the nonlinear interaction spectra for WRT versus NNIA methods are given in Figure 7. It is
seen that for low discrepancies in wave hight, Figure 7 (upper row), the nonlinear interaction
spectrum predicted by neural network is in fair agreement with exact nonlinear interaction
spectrum calculated via WRT method whereas at points where the discrepancy in wave hight
is high, Figure 7 (lower row), the nonlinear interaction predicted by neural network is several
orders of magnitude diﬀerent compared to the exact nonlinear interaction. This apparent inability of neural network to correctly map the wave spectra into nonlinear interaction spectra
comes from the cumulative errors either due to missing spectra (note that only approximately
one third of the total number of spectra was used) or spectra that were not included in the
representative training set which can lead to wave spectra that are orders of magnitude higher
(for this particular point) which in turn are mapped into nonlinear interaction spectra that are
orders of magnitude higher. Providing the wave spectra do not variate signiﬁcantly between
two consecutive integration points and/or the neural network was trained for a reach set of
1165

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
LM 2002−09−01 00:00:00 to 2002−11−14 06:00:00

LM 2002−09−01 00:00:00 to 2002−11−14 06:00:00

5

5
WRT
NDBC 45002

4.5
4

4

3.5

3.5
3

Hs, m

Hs, m

3
2.5

2.5

2

2

1.5

1.5

1

1

0.5

0.5

0

0

5

5
NNIA
NDBC 45002

4.5

NNIA
NDBC 45002

4.5

4

4

3.5

3.5
3

Hs, m

3

Hs, m

WRT
NDBC 45002

4.5

2.5

2.5

2

2

1.5

1.5

1

1

0.5

0.5

0

0

5

5
NDBC 45002 − NNIA

NDBC 45002 − NNIA

4

4

3

3

2

2
1

Δ Hs, m

Δ Hs, m

1
0

0

−1

−1

−2

−2

−3

−3

−4

−4

−5

−5

5

5
WRT − NNIA

WRT − NNIA

4

4

3

3

2

2
1

Δ Hs, m

Δ Hs, m

1
0

0

−1

−1

−2

−2

−3

−3

−4
−5
0

−4

200

400

600

800

1000

time

1200

1400

1600

1800

−5
0

200

400

600

800

1000

1200

1400

1600

1800

time

Figure 5: Veriﬁcation of NNIA at NDBC buoy 45002 in terms of time series of signiﬁcant
wave hight (from top): WRT (continuos line) vs. observations (dotted line), NNIA (continuos
line) vs. observations (dotted line), signiﬁcant wave hight diﬀerence for NNIA vs. WRT and
signiﬁcant wave hight diﬀerence for NNIA vs. observations.

spectra, the NNIA is capable of mapping the wave spectra fairly well.
In terms of wave period the NNIA shows an improvement of correlation coeﬃcient for both
stations. The wave periods (e.g. mean wave period T0,1 , T0,2 , and T−1,0 depend on the spectral
moment following the form: Tij ∝ mi /mj , where for n = i, j, mn is the nth -order-moment of the
spectrum deﬁned as mn = ω n F (ω)dω [6]. For instance, the correlation coeﬃcient increases
from ρ = 0.630 to ρ = 0.877 for NDBC buoy 45002 and a similar increase from ρ = 0.571 to
ρ = 0.855 for NDBC buoy 45007 (Figure 8). The increase in accuracy is further reﬂected in
the true peak period, T0,2 , T−1,0 and mean wave direction. In terms of mean wave direction,
the NNIA shows a minor increase of the correlation coeﬃcient from ρ = 0.021 to ρ = 0.121 for
NDBC buoy 45002 and a more signiﬁcant increase from ρ = 0.218 to ρ = 0.591 for NDBC buoy
45007 (Figure 8).
Finally, an advantage of neural network parameterization over other implementations is its
computational eﬃciency. It can be very time consuming to train a neural network, and to ﬁnd
an appropriate net conﬁguration, but its usage is fast. A runtime comparison is given in Table
2. Neural network gives a speedup factor of roughly 200 compared to WRT. In the case of Lake
Michigan hindcast, neural network was slightly slower compared to DIA but otherwise faster
in all the academic test cases.
1166

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
LM 2002−09−01 00:00:00 to 2002−11−14 06:00:00

LM 2002−09−01 00:00:00 to 2002−11−14 06:00:00

3.5

3.5
WRT
NDBC 45007

WRT
NDBC 45007

3

3

2.5

2.5

2

Hs, m

Hs, m

2

1.5

1.5

1

1

0.5

0.5

0

0

3.5

3.5
NNIA
NDBC 45007

NNIA
NDBC 45007

3

3

2.5

2.5

2

Hs, m

Hs, m

2

1.5

1.5

1

1

0.5

0.5

0

0

NDBC 45007 − NNIA
3

2

2

1

1

Δ Hs, m

Δ Hs, m

NDBC 45007 − NNIA
3

0

0

−1

−1

−2

−2

−3

−3

WRT − NNIA
3

2

2

1

1

Δ Hs, m

Δ Hs, m

WRT − NNIA
3

0

0

−1

−1

−2

−2

−3

−3

0

200

400

600

800

1000

1200

1400

1600

1800

0

200

400

600

time

800

1000

1200

1400

1600

1800

time

Figure 6: Veriﬁcation of NNIA at NDBC buoy 45007 in terms of time series of signiﬁcant
wave hight (from top): WRT (continuos line) vs. observations (dotted line), NNIA (continuos
line) vs. observations (dotted line), signiﬁcant wave hight diﬀerence for NNIA vs. WRT and
signiﬁcant wave hight diﬀerence for NNIA vs. observations.
WRT :: Date: 2002−11−14 06:00:00
2.5

NNIA :: 2002−11−14 06:00:00

−4

x 10

E

−4

x 10

E
1.5

2

1

1

0

1.5

0
1

−4

Snl

x 10

−1

1

0.5

0

0
1

−4

Snl

x 10
1
0

0

0.5

nonlinear transfer rate

1

spectral energy density

2
0.5

nonlinear transfer rate

spectral energy density

2

−1

−1

−2

−2

−2

−3

0
0

0.2

0.4

0.6

0.8

1

0
0

1.2

WRT :: Date: 2002−10−02 03:00:00

0.2

0.4

0.6

0.8

1

1.2

NNIA :: 2002−10−02 03:00:00

−6

x 10

E

E
0.4

0.2

6
0.3

−7

x 10
5

0

2

2

5

0

0
Snl
5

−5

nonlinear transfer rate

0

spectral energy density

0

nonlinear transfer rate

spectral energy density

0.1

Snl

4

0.5

0.2

0

−0.5

−5
−5

−10
−15

0
0

0.2

0.4

0.6

0.8

1

1.2

0
0

0.2

0.4

0.6

0.8

1

1.2

Figure 7: Wave spectra and nonlinear interactions calculated via WRT and NNIA methods for
lowest (upper row) and highest (lower row) discrepancies in wave hight (Case A). The insets
depict the directional spectral energy density and corresponding directional NI transfer rate.

1167

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
NDBC buoy 45002, Case A

NDBC buoy 45002, Case B

NDBC buoy 45007, Case A

NDBC buoy 45007, Case B

Figure 8: Scatter density comparison between the NNIA (WRT-trained) and buoy data. Legends indicate scatter statistics: number of scatter points (n), Pearson correlation coeﬃcient (ρ),
root-mean-square error ( ), bias (b), and scatter index (SI). Positive biases indicate underestimation of parameters by wave model and negative biases indicate overestimation, respectively.

5

Summary and future work

This work builds on the foundations of very few Neural Network Interaction Approximation
studies and proposes a practical implementation of a neural network approach for direct mapping of wave spectra into exact nonlinear interactions. Although it is perhaps stating the
obvious, the neural network conﬁguration does have a major inﬂuence on the speed and quality
of emulations. The FFBP validation test proves the viability of the direct mapping approach
in an operational model in terms of quality. The time required by NNIA is, however, several
times higher than DIA method. NNIA is only a few times faster than WRT exact method.
Consequently, this approach its not yet seen economical and must be reengineered in order to
become fully operational.
The second validation test that deals with the new neural network program proves the
viability of the direct mapping both in terms of speed and quality. The neural network is
able to emulate the WRT exact calculations for single- and multi-modal wave spectra with a
much higher accuracy then DIA. The new neural network is capable of reproducing nonlinear
1168

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu

interactions provided a suﬃcient number of spectra are trained. Results show good agreement
by means of growth curves and integral parameters.
Although the quality of the emulation is controlled by the neural network architecture and
the size of the training datasets, it does not fully support an internal quality control mechanism.
Such a mechanism should allow the model to revert to the underlying algorithm if the NNIA
is found to be inaccurate. The results can be further improved by the introduction of a cut-oﬀ
frequency to match the frequency range used by NDBC buoys. In WW3, point and ﬁeld output
is calculated over the full range of frequencies deﬁned in the spectrum. This could eliminate
the bias introduced by shorter waves. Also, it is important to note that the neural network
program allows for parallel training on multiprocessor architectures and signiﬁcant speed gains
can be obtained on large-scale supercomputers.
The training of neural network has been done for limited data in the fall period for the
Lake Michigan test case. However, seasonal variation in the wind system can be signiﬁcant
and training of another neural network for other seasons will be required. A further natural
step would be to train and test the neural network for a global grid. Due to the fact that the
training process can be an extremely time consuming task on its own, the number of spectra for
a global grid is signiﬁcantly limited. For this purpose a sub-selection of representative training
subsets can be performed by a cluster algorithm [21] and a low resolution (e.g. 3°) global grid
can be tested in the ﬁrst instance [7]. It is important that the Garden Sprinkler eﬀect (caused
by insuﬃcient model resolution) is checked in this case. Moreover, as operational models move
towards higher frequency and directional resolutions (e.g. from 25 to 50 frequency points and
from 24 to 36 direction points) and since neural network is grid dependent, it is important to
study the impact of grid and resolution eﬀects on NNIA in more detail.
Finally, Neural Network Interaction Approximation can be implemented in conjunction
with other improved nonlinear interaction approximations in particular with GMD [16]. In this
case, the relevance of NNIA needs to be rigorously re-evaluated with respect to the particular
approximation.

6

Acknowledgements

The author would like to thank Gerbrant Van Vledder for providing the WRT code, Stefan
Zieger for providing the new Sin and Sds and Dmitry Chalikov for his comments and suggestions.

References
[1] F. Ardhuin, T. H. C. Herbers, and W. C. OReilly. A hybrid eulerian-lagrangian model for spectral
wave evolution with application to bottom friction on the continental shelf. J. Phys. Oceanogr.,
31(6):1498–1516, 2001.
[2] M. Benoit. Implementation and test of improved methods for evaluation of nonlinear quadruplet
interactions in a third generation wave model. In Proc. 30th Int. Conf. on Coastal Eng., pages
526–538, San Diego (California, USA), 2006.
[3] M. Benoit, F. Marcos, and F. Becq-Girard. Development of a third generation shallow-water wave
model with unstructured spatial meshing. In Billy L. (Ed.) Edge, editor, Proc. of the 25th Int.
Conf. on Coastal Eng., 1996, volume 1, pages 465–478, 1997.
[4] K. Hasselmann. On the nonlinear energy transfer in gravity-wave spectrum. 1. general theory. J.
Fluid. Mech., 12:481–500, 1962.
[5] K. Hasselmann and S. Hasselmann. The wave model exact-nl. In The SWAMP Group (Eds.).
Ocean Wave Modelling, page 256pp. Plenum Press, New York and London, 1985.

1169

Integration of artiﬁcial neural networks into operational ocean wave prediction models R.M. Puscasu
[6] L. H. Holthuijsen. Waves in Oceanic and Coastal Waters. Cambridge University Press, Cambridge,
2007.
[7] Peter A. E. M. Janssen and Pedro Viterbo. Ocean waves and the atmospheric climate. Journal
of Climate, 9:1269–1287, 1996.
[8] L. Komatsu and A. Masuda. A new scheme of nonlinear energy transfer among wind waves: Riam
method. algorithm and performance. J. Phys. Oceanogr., 52:509537, 1996.
[9] G. J. Komen, L. Cavaleri, M. Donelan, K. Hasselmann, S. Hasselmann, and P. A. E. M. Janssen.
Dynamics and Modelling of Ocean Waves. Cambridge University Press, Cambridge, 1994.
[10] V. M. Krasnopolsky, D. V. Chalikov, and H. L. Tolman. A neural network technique to improve
computational eﬃciency of numerical oceanic models. Ocean Mod., 4:363–383, 2002.
[11] V. M. Krasnopolsky and M. S. Fox-Rabinovitz. Complex hybrid models combining deterministic
and machine learning components for numerical climate modeling and weather prediction. Neural
Networks, 19:122–134, 2005.
[12] S. Nash. Newton-type min. via the lanczos method. SIAM J.Numer.Anal., 21(4):770–788, 1984.
[13] P. Peterson. F2py: a tool for connecting fortran and python programs. Int. J. Comput. Mater.
Sci. Surf. Eng., 4(4):296–305, 2009.
[14] H. Schiller. Feedforward-backpropagation neural net program ﬀbp1.0. Technical Report 37, GKSS,
2000.
[15] SWAN. SWAN Scientiﬁc and technical documentation. Delft University of Technology, 2009.
[16] H. L. Tolman. Practical nonlinear interaction algorithms. In 11th Inter. workshop and wave
hindcast. and forecast. and coastal hazards symp. Tech. Rep. 52, WMO/TD-N0. 1533, 2009.
[17] H. L. Tolman. User manual and system documentation of WAVEWATCH III version 3.14. TEch.
Note 276. NOAA/NWS/NCEP/MMAB, Camp Springs, MD, 2009.
[18] H. L. Tolman. A conservative nonlinear ﬁlter for the high-frequency range of wind wave spectra.
Ocean Modelling, 39:291–300, 2011.
[19] H. L. Tolman, V. M. Krasnopolsky, and D. V. Chalikov. Neural network approximations for
nonlinear interactions in wind wave spectra: direct mapping for wind sea in deep water. Ocean
Mod., 8:253–278, 2005.
[20] G. P. Van Vledder. The wrt method for the computation of non-linear four-wave interactions in
discrete spectral wave models. Coastal Eng., 53:223–242, 2006.
[21] K. Wahle, H. G¨
unther, and H. Schiller. Neural network parameterisation of the mapping of wave
spectra onto nonlinear four-wave interactions. Ocean Mod., 30:48–55, 2009.
[22] WAMDIG. The wam model - a third generation ocean wave prediction model,. J. Phys. Oceanogr.,
18:1775–1810, 1988.
[23] Wavewatch III® . Third generation wave model. http://polar.ncep.noaa.gov/waves/wavewatch/.
[24] D. J. Webb. Non-linear transfers between sea waves. Deep Sea Res., 25:279–298, 1978.
[25] M. Wojciechowski. Feed-forward neural network for python. Technical report, Technical University
of Lodz, Department of Civil Engineering, Architecture and Environmental Engineering, 2011.

1170

