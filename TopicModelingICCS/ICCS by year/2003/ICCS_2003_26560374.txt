The GHS Attack Revisited
Florian Hess
Computer Science Department,
Woodland Road, University of Bristol, BS8 1UB, UK
florian@cs.bris.ac.uk

Abstract. We generalize the Weil descent construction of the GHS attack to arbitrary Artin-Schreier extensions. We give a formula for the
characteristic polynomial of Frobenius of the obtained curves and prove
that the large cyclic factor of the input elliptic curve is not contained in
the kernel of the composition of the conorm and norm maps. As an application we almost square the number of elliptic curves which succumb
to the basic GHS attack, thereby weakening curves over F2155 further.
We also discuss other possible extensions or variations of the GHS attack
and conclude that they are not likely to yield further improvements.

1

Introduction

The Weil descent technique, proposed by Frey [7], provides a way of mapping
the discrete logarithm problem on an elliptic curve (ECDLP) over a large ﬁnite
ﬁeld Fqn to a discrete logarithm problem on a higher dimensional abelian variety
deﬁned over the small ﬁnite ﬁeld Fq . One can then study possible further constructions of such abelian varieties and the hardness of the discrete logarithm
problem thereon.
This was subsequently done by Galbraith and Smart [11] and Gaudry, Hess
and Smart [12], in even characteristic (i.e. for q a power of 2). The construction of [12] yields a very eﬃcient algorithm to reduce the ECDLP to the discrete logarithm in the divisor class group of a hyperelliptic curve over Fq . Since
subexponential algorithms exist for the discrete logarithm problem in high genus
hyperelliptic curves, this gives a possible method of attack against the ECDLP.
We refer to the method of [12] as the GHS attack.
Menezes and Qu [20] analyzed the GHS attack in some detail and demonstrated that it did not apply to the case when q = 2 and n is prime. Since this is
the common case in real world applications, the work of Menezes and Qu means
that the GHS attack does not apply to most deployed systems. However, there
are a few deployed elliptic curve systems which use the ﬁelds F2155 and F2185 [16].
Hence there is considerable interest as to whether the GHS attack makes all
curves over these ﬁelds vulnerable. In [22] Smart examined the GHS attack for
elliptic curves with respect to the ﬁeld extension F2155 /F231 and concluded that
such a technique was unlikely to work for any curve deﬁned over F2155 .
Jacobson, Menezes and Stein [17] also examined the ﬁeld F2155 , this time
using the GHS attack down to the subﬁeld F25 . They concluded that such a
E. Biham (Ed.): EUROCRYPT 2003, LNCS 2656, pp. 374–387, 2003.
c International Association for Cryptologic Research 2003

The GHS Attack Revisited

375

strategy could be used in practice to attack around 233 isomorphism classes
of elliptic curves deﬁned over F2155 . Since there are about 2156 isomorphism
classes of elliptic curves deﬁned over F2155 , the probability that the GHS attack
is applicable to a randomly chosen one is negligible. A further very detailed
analysis for many other ﬁelds was carried out by Maurer, Menezes and Teske [18].
They identiﬁed all extension ﬁelds F2n , where 160 ≤ n ≤ 600, for which there
should exist a cryptographically interesting elliptic curve over F2n such that the
GHS attack is more eﬃcient for that curve than for any other cryptographically
interesting elliptic curve over F2n . Ciet, Quisquater and Sica [5] discussed the
security of ﬁelds of the form F22d where d is a Sophie-Germain prime.
Galbraith, Hess and Smart [10] extended the GHS attack to isogeny classes of
elliptic curves. The idea is to check whether a given elliptic curve is isogenous to
an elliptic curve for which the basic GHS attack is eﬀective. Then one computes
the isogeny and reduces the ECDLP to that curve. This greatly increased the
number of elliptic curves which succumb to the GHS attack.
The GHS attack has also been generalized to hyperelliptic curves, in even
characteristic by Galbraith [9] and odd characteristic by Diem [6].
In this paper we extend the GHS attack for elliptic curves in characteristic
two even further, almost squaring the number of curves for which the basic
GHS attack of [12] was previously applicable. In order to do so we generalize
the construction of [12] and [9] to arbitrary Artin-Schreier extensions, and this
enables us to utilize diﬀerent Artin-Schreier equations than have been previously
considered. These new results are then combined with the technique of [10].
For example, for the ﬁeld extension F2155 /F25 , among the 2156 isomorphism
classes of curves there are around 2104 which are vulnerable to attack under the
extended method of [10]. Using the new construction we obtain that around 2123
additional isomorphism classes should now be attackable.
On the other hand it should be noted that the curves produced by our generalized construction, although they have the same genera as in [12], are no
longer hyperelliptic. As a consequence solving the discrete logarithm problem in
the divisor class group of these curves is much more complicated and in general
slower by a factor polynomial in the genus. The precise eﬃciency and practical
implications have yet to be determined.
In the paper we further give a formula for the characteristic polynomial of
Frobenius of the constructed curves and discuss conditions under which the discrete logarithm problem is preserved when mapped to the corresponding divisor
class group by the conorm-norm homomorphism. In even characteristic special
versions of these results have been presented in [13], and similar statements for
the conorm-norm homomorphism have been independently obtained by Diem [6].
We additionally discuss a number of other possible variations of the construction, and conclude that they are not likely to yield any further improvements.
We also address the algorithmic issues of computing the ﬁnal curves and solving
the discrete logarithm on them.
The results of this paper show that curves deﬁned over ﬁelds of composite
extension degree over F2 , especially 155, may be more susceptible to Weil descent

376

F. Hess

attacks than suggested by previous methods. Our techniques do however not
pose a threat for prime extension degrees in small characteristic or prime ﬁelds
in large characteristic.
The remainder of the paper is organized as follows. In section 2 we describe
the technique of Weil descent using Artin-Schreier extensions. In section 3 we
specialize to elliptic curves and even characteristic, and generalize the construction of [12]. In section 4 we combine these results with the method of [10] thereby
obtaining our new construction. In section 5 we investigate various possibly more
eﬀective extensions and variations, and in section 6 we address algorithmic issues
of computing the ﬁnal curves and solving the discrete logarithm problem. Due
to lack of space some proofs had to be omitted but will appear in the full version
of the paper.

2

Weil Descent with Artin-Schreier Extensions

In this section we brieﬂy describe Artin-Schreier extensions, deﬁned below, and
explain how the discrete logarithm in the divisor class group of an Artin-Schreier
curve of small genus over a large ﬁnite ﬁeld can be related to an equivalent
discrete logarithm problem in the divisor class group of a curve of larger genus
but deﬁned over a smaller ﬁnite ﬁeld.
Let p be a prime, q = pr , k = Fq and K = Fqn . We abbreviate F = K(x) and
let f ∈ F be a rational function. A simple Artin-Schreier extension, denoted by
Ef , is given by adjoining to F a root of the polynomial y p −y−f ∈ F [y]. Examples
of such extensions are the function ﬁelds of elliptic curves in characteristic two
and three.
The Artin-Schreier operator is denoted by ℘(y) = y p − y. We then also write
F (℘−1 (f )) for Ef and ℘(F ) = { f p − f | f ∈ F }. More generally we will use
the following construction and theorem which is a special version of [21, p. 279,
Theorem 3.3]:
Theorem 1 Let F¯ be a ﬁxed separable closure of F . For every additive subgroup
∆ ≤ F with ℘(F ) ⊆ ∆ ⊆ F there is a ﬁeld C = F ℘−1 (∆) with F ⊆ C ⊆ F¯
obtained by adjoining all roots of all polynomials y p − y − d for d ∈ ∆ in F¯ to F .
Given this, the map
∆ → C = F ℘−1 (∆)
deﬁnes a 1-1 correspondence between such additive subgroups ∆ and abelian extensions C/F in F¯ of exponent p.
We intend to apply this construction only for very special ∆ which we introduce in a moment. By a Frobenius automorphism with respect to K/k of a
function ﬁeld over K we mean an automorphism of order n = [K : k] of that
function ﬁeld which extends the Frobenius automorphism of K/k. Raising the
coeﬃcients of a rational function in F = K(x) to the q-th power yields for example a Frobenius automorphism of F with respect to K/k, which we denote
by σ.

The GHS Attack Revisited

377

n−1

For f ∈ F we deﬁne ∆f := { dp − d + i=0 λi σ i (f ) | d ∈ F and λi ∈ Fp }.
m
Also, let mf = i=0 λi ti with λm = 1 be the unique polynomial of smallest
m
degree in Fp [t] such that i=0 λi σ i (f ) = dp − d for some d ∈ F .
In the following we consider the ﬁeld C = F ℘−1 (∆f ) which exists by
Theorem 1. One can show that it has degree pdeg(mf ) over F .
Given Ef and K/k, the basic idea of Weil descent with Artin-Schreier extensions is to derive certain conditions under which C admits a Frobenius automorphism with respect to K/k extending σ. One then forms the ﬁxed ﬁeld C0 of
that automorphism, which is the function ﬁeld of a curve deﬁned over k and has
the same genus as C. The discrete logarithm problem is mapped from Cl0 (Ef )
to Cl0 (C0 ), the divisor class groups of degree zero divisors of Ef and C0 , using
the composition of the conorm map ConC/Ef and the norm map NC/C0 . There
are thus three main questions:
1. Under which conditions does σ extend to a Frobenius automorphism of C
with respect to K/k?
2. What is the genus of C?
3. Is the discrete logarithm problem preserved under the conorm-norm map?
In the full version of the paper we answer these questions for general ArtinSchreier extensions in every characteristic. For the sake of simplicity and since
it is the most interesting case we restrict to elliptic curves in characteristic two
in this paper. We only note the following theorem, where gC and gEf denote the
genus of C and Ef respectively.
Theorem 2 Assume deg(mf ) ≥ 2, ∆f ∩ K ⊆ ℘(F ) and that F ℘−1 (f, σ(f ))
has genus greater than 1. The genus of C then satisﬁes
gEf pdeg(mf )−2 + 1 ≤ gC ≤ gEf · n (pdeg(mf ) − 1)/(p − 1).
The cofactor n in the upper bound can be dropped if f has σ-invariant poles.
The theorem means that any attack using an Artin-Schreier construction fails
if deg(mf ) is too large since the genus of C is exponential in deg(mf ). A lower
bound for deg(mf ) is given by the smallest degree of a non-linear factor in Fp [t]
of the polynomial tn − 1 ∈ Fp [t]. For prime values of n this is usually too big. We
remark that the conditions of the theorem are not restrictive in our situation.
If one of them is not satisﬁed the discrete logarithm problem would in practice
not be preserved when mapped to C0 .

3

Generalizing the Basic GHS Attack

The Artin-Schreier construction of [12] applies to the case where Ef is the function ﬁeld of an elliptic curve and F is the rational function ﬁeld, over a ﬁnite
ﬁeld of characteristic two. We now describe a generalization of this construction,
along the lines of the previous section.

378

F. Hess

Let p = 2 and f = γ/x + α + βx for γ, α, β ∈ K with γβ = 0. We deﬁne ∆f
and C as in section 2. Also, we deﬁne the polynomials mγ and mβ for γ and β
as mf for f in section 2. Then
mf =

if α = d2 + d for some d ∈ K,
lcm(mγ , mβ )
lcm(mγ , mβ , t + 1) otherwise.

(3)

We remark that α = d2 + d for some d ∈ K is equivalent to TrK/F2 (α) = 0.
The following two theorems answer the ﬁrst two questions stated above.
Theorem 4 The Frobenius automorphism σ of F with respect to K/k extends
to a Frobenius automorphism of C with respect to K/k if and only if at least one
of the conditions TrK/F2 (α) = 0, TrK/k (γ) = 0 or TrK/k (β) = 0 holds.
If at least one of the conditions of the Theorem is satisﬁed, then C/F is
necessarily regular (that is, K is algebraically closed in C).
Theorem 5 If C/F is regular then the genus of C = F (℘−1 (∆)) is given by
gC = 2deg(mf ) − 2deg(mf )−deg(mγ ) − 2deg(mf )−deg(mβ ) + 1.
Before we proceed to answer the third question stated above we pause to
explain how the results of [12], except for the hyperellipticity, can be recovered
from these two theorems. In [12] the special case γ = 1 is considered where
C/F is necessarily regular. Let m = deg(mf ). For the existence of the Frobenius
automorphism with respect to K/k we note that TrK/k (γ) ≡ n mod 2 holds and
that TrK/k (β) = 0 is equivalent to (t + 1)u | mβ where u = 2v2 (n) . This shows
that the condition (2) in Lemma 6 of [18] is necessary and suﬃcient and that
condition (†) of [12] is suﬃcient for the existence of the Frobenius automorphism.
For the genus of C we obtain 2m−1 − 2m−deg(mβ ) + 1. Depending on whether
(t + 1) | mβ or not this gives m − deg(mβ ) = 0 or m − deg(mβ ) = 1 and hence a
genus of 2m−1 or 2m−1 − 1, as in [12]. In addition we now obtain the following
more precise statement.
Corollary 6 Let γ ∈ k. The genus of C is 2m−1 −1 if and only if TrK/Fqu (β) = 0
where u = 2v2 (n) .
We continue the discussion and address the above third question. We assume
that the conditions of Theorem 4 are fulﬁlled so that σ extends to a Frobenius
automorphism of C with respect to K/k, again denoted by σ. For h ∈ ∆f with
h = c/x + a + bx deﬁne s(h) = min{ s ≥ 1 | σ s (c) = c and σ s (b) = b }. Then σ s(h)
is the smallest power of σ which yields an automorphism of Eh . This means that
Eh is the constant ﬁeld extension of an elliptic curve deﬁned over Fqs(h) . For
˜ = c/x + TrK/F
(a) + bx ∈
example, if n/s(h) is odd then Eh = Eh˜ where h
q s(h)
s(h)
˜
Fqs(h) (x). Let us denote by Eh the ﬁxed ﬁeld of σ
in Eh .

The GHS Attack Revisited

379

Theorem 7 For the homomorphism φh : Cl0 (Eh ) → Cl0 (C0 ) given by NC/C0 ◦
ConC/Eh we have under the conditions of Theorem 4 that
−1
0 ˜
deg(mf )−1
]).
N−1
˜ (0) ⊆ ker(φh ) ⊆ NE /E
˜ (Cl (Eh )[2
E /E
h

h

h

h

We are of course mainly interested in the case h = f . The theorem means
in words, that if Eh is not deﬁned by a subﬁeld curve, that is s(h) = n, then
the kernel of the conorm-norm homomorphism contains only elements of order
dividing 2deg(mf )−1 . Since the discrete logarithm problem on Ef lives in a cyclic
group of large prime order it is preserved under the conorm-norm homomorphism. On the other hand, if Ef is deﬁned by a subﬁeld curve, then the kernel
of the conorm-norm homomorphism does contain the large prime factor and the
discrete logarithm problem is not preserved. Note that by applying a suitable
change of variables x → λx the method can be made to work for subﬁeld curves
nevertheless.
Interestingly, C0 is in a sense universal in that it preserves discrete logarithms
in large prime subgroups for all Eh and h ∈ ∆f with s(h) = n. We also remark
that if the conditions of Theorem 4 are not fulﬁlled, then σ may still be extended
to C but not as a Frobenius automorphism with respect to K/k. Theorem 7
˜h necessarily a rational function ﬁeld, so that
remains true for this case with E
the discrete logarithm problem is not preserved (see the full version of the paper).
We ﬁnish the general discussion with a formula for the characteristic polynomial of Frobenius of C0 over k. Let S be a set of elements h = c/x + a + bx
in ∆f such that h1 = σ i (h2 ) for all h1 , h2 ∈ S, h1 = h2 and 0 ≤ i ≤ n − 1,
and such that for every h1 ∈ ∆f there exists an h2 ∈ S and 0 ≤ i ≤ n − 1 with
h1 = σ i (h2 ). Let us write χE˜h (t) and χC0 (t) for the characteristic polynomials
˜h and C0 (note the diﬀerent constant ﬁelds).
of Frobenius of E
Theorem 8 Under the conditions of Theorem 4 we have that
χE˜h (ts(h) ).

χC0 (t) =
h∈S

4

Applications

A representative for each isomorphism class of ordinary elliptic curves deﬁned
over K with p = 2 is given by Y 2 + XY = X 3 + αX 2 + β with β ∈ K and
α ∈ {0, ω} where ω ∈ F2u for u = 2v2 (nr) is a ﬁxed element with TrF2u /F2 (ω) = 1.
The associated Artin-Schreier equation is y 2 + y = 1/x + α + β 1/2 x, obtained by
the transformation Y = y/x+β 1/2 , X = 1/x and multiplication by x2 . The same
normalization of α is also possible for the more general Artin-Schreier equations
y 2 + y = γ/x + α + βx of section 3.
It was the equation y 2 + y = 1/x + α + β 1/2 x which has been used in [12]
to perform the Weil descent. However, since (ax + b)/(cx + d) for a, b, c, d ∈ K
with ad − bc = 0 is also a generator of F we could also make a substitution

380

F. Hess

x → (ax + b)/(cx + d) and apply the results of the previous sections to f =
(cx + d)/(ax + b) + α + β 1/2 (ax + b)/(cx + d). Since we aim at getting as small
values of m = deg(mf ) as possible, because of Theorem 2, we require that f
has σ-invariant poles. But this implies b = λa and d = µc for λ, µ ∈ k. Hence
(ax + b)/(cx + d) = (a/c)(x + λ)/(x + µ). As (x + λ)/(x + µ) is σ-invariant we can
substitute x for this. Writing γ = a/c we obtain f = 1/(γx) + α + β 1/2 γx and
this is precisely of the form considered in section 3. A similar reasoning holds if
a = 0 or c = 0.
The question now is whether for β ∈ K there is a γ ∈ K such that the
polynomial lcm(m1/γ , mβ 1/2 γ ) has small degree in comparison with n. If we ﬁnd
such a γ we can apply the results of section 3 and reduce the discrete logarithm
problem on E to that in the divisor class group of a higher genus curve deﬁned
over k. The only algorithm known so far to ﬁnd such a γ is by computing all γ
such that m1/γ has small degree and then individually checking whether mβ 1/2 γ
also has small degree.
On the other hand we can choose γ1 , γ2 ∈ K such that lcm(mγ1 , mγ2 ) has
small degree in comparison with n and deﬁne β = γ2 /γ1 . Heuristically we expect
that the map (γ1 , γ2 ) → γ2 /γ1 is almost injective for the γ1 , γ2 under consideration, and this is also conﬁrmed by examples. It follows that we almost square
the number of elliptic curves which can be attacked by the basic GHS attack.
We now want to combine our results with the results of [10]. Assume for
simplicity that r, n are odd and n is prime so that α ∈ F2 according to the
above. Over F2 we have the factorization into irreducible polynomials tn + 1 =
(t + 1)h1 · · · hs and deg(hi ) = d such that n = sd + 1. In this situation the ﬁrst
non-trivial m satisﬁes d ≤ m ≤ d + 1, yielding mf = hi or mf = (t + 1)hi by
equation (3). Due to our generalization we do not necessarily have m = d + 1
as in [10,12], and in fact we are now concentrating on m = d. The number of
elliptic curves deﬁned by an Artin-Schreier equation as in section 3 with α ∈ F2
and d ≤ m ≤ d + 1 is approximately equal to 2sq 2d+2 whereas the number of
elliptic curves among these with m = d (implies α = 0) is approximately equal
to sq 2d . As in [10] we expect nr but no more of these to lie in the same isogeny
class.
If m = d we have mf = mγ = mβ , (t + 1) mγ mβ and α = 0. It follows
that TrK/k (γ) = TrK/k (β) = 0 and by Theorem 4 the Weil descent technique
does work because TrK/F2 (α) = 0 and γ, β are not in a subﬁeld of K since n is
prime. The resulting genus then satisﬁes gC = 2d − 1 by Theorem 5. Note that
in [10,12] it is always the case that m = d + 1 but deg(mγ ) = 1, so that the
genus is of similar size, namely 2d − 1 or 2d . Back to the case m = d we observe
that if α = 0 then the group order of the elliptic curve is congruent to 0 modulo
4 and if α = 1 then it is congruent to 2 modulo 4 (see [2, p. 38]). This means
that curves with α = 0 represent half of about all 2q n/2 isogeny classes. Taking
this into account we obtain from [10] that a proportion of min{1, sq 2d /(q n/2 nr)}
of all elliptic curves over K with α = 0 leads to curves of genus 2d − 1 deﬁned
over k with equivalent discrete logarithm problem. Given a random elliptic curve
with α = 0 we can ﬁnd the associated elliptic curve, from which such a curve of

The GHS Attack Revisited

381

genus 2d − 1 can be computed, in running time N + O(q n/4+ε ) and probability
min{1, N/q n/2 }, where N ≤ sq 2d /(nr).
The case n = 31 and r = 5 is particularly interesting since there is an IPsec
curve [16] with α = 0 deﬁned over F2155 . This case has d = 5, s = 6 and thus
yields genus 31 which are feasible parameters according to [17]. The heuristic
probability that a random elliptic curve gives rise to a curve of genus 31 is
approximately 2−52 with the method in [10], whereas now we obtain
sq 2d /(q n/2 nr) ≈ 2−32 .
The only algorithm known so far to ﬁnd the elliptic curves from which the
corresponding higher genus curve are computed requires the order of sq 2d /(nr) ≈
245 many operations in F2155 (q n/4 ≈ 238 here). This is not so eﬃcient, but still
much faster than the Pollard methods on the original curves. One can however
additionally argue that the security of elliptic curves over F2155 does now at least
partially depend on the diﬃculty of the problem of ﬁnding such higher genus
curves, and this problem has not been studied in detail yet.

5

Further Variations and Observations

It is of interest whether there are further variations or extensions of the GHS attack which would lead to smaller genera. In this section we investigate a number
of such variations.
5.1

Subﬁelds and Automorphisms

A possibility of improving the construction in section 2 and section 3 would be
to consider subﬁelds L of C0 and use φf,L = NC0 /L ◦ φf with φf from Theorem 7
to map the discrete logarithm problem from Cl0 (Ef ) to Cl0 (L). If the kernel of
φf,L is small enough this would lead to a very substantial improvement, because
the genus of subﬁelds is usually much smaller.
To approach this question we ﬁrst consider intermediate ﬁelds of the extension C0 /F0 . But in this case the kernel of φf,L would contain the large prime
factor, as shown in the full version of the paper, hence φf,L and intermediate
ﬁelds of C0 /F0 are not of any use.
We could still search for other subﬁelds L of C0 which do not contain F0
and yield a small kernel of φf,L . One way of obtaining such subﬁelds could
be via the ﬁxed ﬁelds of automorphism groups of C containing the Frobenius
automorphism. Indeed, if we had automorphisms ρ ∈ Aut(F/K) with ρ(∆f ) ⊆
∆f it should be possible to extend ρ to C in a similar way as it was done
with σ, under not too restrictive conditions. However, we have not found such
automorphisms for non-subﬁeld curves. This does not rule out the existence of
useful subﬁelds L but it appears unlikely that such subﬁelds exist except maybe
in very rare cases.

382

F. Hess

Although automorphisms of C0 /F0 may not be useful to ﬁnd suitable subﬁelds L as indicated above, they could be of use to speed up the discrete logarithm computation in C0 . We are given 2deg(mf ) automorphisms in G(C/F ). As
shown in the full version of the paper, no automorphism in G(C/F ) restricts to
an automorphism of C0 , except when C0 is hyperelliptic, in which case we only
obtain the hyperelliptic involution. It is still possible that C0 has automorphisms,
but again we expect this to happen only in very rare cases.
5.2

Iterative Descent

Assume n = n1 n2 . Instead of performing one descent from K to k we could
consider descending ﬁrst to Fqn1 and then to k. The problem here is that C0 is
in general not an Artin-Schreier extension of degree 2 anymore so our techniques
would not apply immediately. If we however start with an elliptic curve as in
section 4 and consider an associated Artin-Schreier equation with γ ∈ Fqn1 we
do have that C0 is hyperelliptic, or in other words that it is an Artin-Schreier
extension of degree 2. This way we get the following interesting result.
Assuming the generic cases a descent from K to k leads to a hyperelliptic
curve of genus of about 2n−1 whereas a descent from K to Fqn1 gives a genus
of about 2n1 −1 . Using Theorem 2 the descent from Fqn1 to k ﬁnally results in
n1 +n2 −1
. Thus if n1 ≈ n2 this ﬁnal
a curve of genus about (2n2 − 1)2n1 −1
√ ≤ 2
2 n
curve has subexponential genus ≈ 2
instead of exponential genus ≈ 2n .
Let us look at the non generic cases for n = 155, n1 = 5, n2 = 31. The
smallest non-trivial descent from F2155 to F2 leads to a genus of about 220 . On
the other hand there are descents from F2155 to F25 which result in genus 25 − 1.
Assuming the generic case m = 5 for the descent from F25 to F2 then gives a
genus less than or equal to (25 − 1)2 .
While theoretically interesting it does not appear that these results have any
practical implications.
5.3

Descent from Extensions

If the descent from Fqn to Fq does not yield a small enough genus one could
apply a change of variable to obtain a deﬁning equation of Ef deﬁned over an
extension ﬁeld Fq˜n˜ and descend to Fq˜, thereby possibly yielding a smaller genus
over another small base ﬁeld for some suitable q˜ and n
˜.
At least for prime n this approach will however not give an improvement.
To see this we note that for any n the degrees of the irreducible factors in Fp [t]
of tn − 1 corresponding to primitive nth-roots of unity equal the multiplicative
order m of p modulo n. This m is the smallest value of deg(mf ) which can
occur for an elliptic curve over Fqn which is not already deﬁned over a subﬁeld.
For prime n this m is usually very big. Let m
˜ be the multiplicative order of p
˜
modulo n
˜ . The genus for a descent by n
˜ is then approximately at least pm
. Thus,
if n | n
˜ then m
˜ ≥ m and the genus can only be bigger than before. If otherwise
n n
˜ then n | [Fq˜ : Fp ] because n is prime and thus Fq˜ is too big.

The GHS Attack Revisited

383

For composite n there may be improvements possible. Again, there are descents from F2155 to F2 which yield genus approximately 220 , whereas the corresponding descents from F2155 to F25 yield genus about 25 while F25 is still fairly
small.
5.4

Other Composita

The ﬁeld composita in section 2 and section 3 depend on the choice of the
base ﬁeld F = K(x) within the function ﬁeld Ef . We want to investigate what
happens if other or no subﬁelds are used, in the case of elliptic function ﬁelds
Ef in characteristic two.
If K(x1 ) and K(x2 ) are any two rational subﬁelds of index 2 of the elliptic
function ﬁeld Ef then there is an automorphism τQ ∈ Aut(Ef /K) induced by a
point translation map P → P + Q such that τQ (K(x1 )) = K(x2 ). Namely, we
may assume that x1 and x2 are x-coordinates of Weierstrass models. Then Q is
the point where x2 has its pole. We conclude that Ef /K(x1 ) and Ef /K(x2 ) are
isomorphic and hence it does not matter which rational subﬁeld of index two is
taken in section 2 and section 3.
The methods of section 2 and section 3 do not apply readily to other subﬁelds
of Ef . We make a few comments on what can be expected in terms of arbitrary
ﬁeld composita.
Elliptic subﬁelds as common base ﬁelds F are not of any use. The extensions
Ef /F are abelian and unramiﬁed so any compositum C will be unramiﬁed over
F as well. This however means that C has genus 1 and is again an elliptic
function ﬁeld. The corresponding elliptic curves are all isogenous. Should there
be a Frobenius automorphism on C then this would mean that the elliptic curve
corresponding to Ef is isogenous to an elliptic curve deﬁned over the small ﬁnite
ﬁeld k. Other aspects of isogenous elliptic curves have been exploited in [10].
All other subﬁelds F must be rational of index ≥ 3, and such ﬁelds will
indeed lead to alternative constructions. In order to estimate the resulting genus
we remark that essentially the lower bound in Theorem 2 remains valid in more
general situations: Similar to section 2 assume we are given C with a Frobenius
automorphism σ with respect to K/k and an elliptic function ﬁeld E with E ⊆ C
such that C = E(σE) · · · (σ m−1 E) for m ≤ n minimal. If E(σE) does not have
genus ≥ 2 then it has genus 1 and E(σE)/E as well as E(σE)/σE are unramiﬁed.
This yields an unramiﬁed pyramid of ﬁelds. It follows that C is unramiﬁed over
E and is hence elliptic, which reduces us to the uninteresting case discussed
above. So assume that E(σE) has genus ≥ 2. Using the Riemann-Hurwitz genus
formula we obtain that the genus of C is then bounded by gC ≥ [C : E(σE)] + 1
and [C : E(σE)] ≥ 2m−2 . If the ﬁelds σ i E are linearly disjoint over a common
base ﬁeld F with σF ⊆ F we even have [C : E(σE)] ≥ [E : F ]m−2 . The genus is
thus exponential in m.
The main objective is hence again to minimize m in comparison with n. A
possible generalization of the Artin-Schreier construction could be to use additive
polynomials over a common rational base ﬁeld F . This would lead to values of
m similar as in section 3 but could apply in more or additional cases. However,

384

F. Hess

as F would have index 2s in E for s ≥ 2 the genus bound would rather be
gC ≥ 2s(m−2) + 1, much larger than the construction of section 3.
Theoretically there could also be completely diﬀerent constructions of C given
E and its conjugated ﬁelds. To be eﬀective they would need to achieve a good
“compression” rate, i.e. small value of m, because of the above lower bound for
the genus. We do not know whether such constructions exist.
5.5

The GHS Attack in Characteristic Three

Weil descent with Artin-Schreier extensions can also be carried out for elliptic
curves in characteristic three. Here Artin-Schreier equations which deﬁne elliptic
curves have to be of the form y 3 − y = ax2 + b with a, b ∈ K. We thus expect
to map the discrete logarithm problem to curves of genus Θ(3deg(mf ) ) with f =
ay 2 + b. We remark that if a = 1 we would again obtain an Artin-Schreier
extension of degree 3.
Elliptic curves deﬁned in this way are always supersingular and admit subexponential attacks via the MOV and FR reductions anyway [8,19] (with subexponential parameter 1/3 instead of 1/2). We would expect these attacks to be
more eﬃcient than the GHS attack. Of course, analogous remarks hold for elliptic
curves in even characteristic.
We remark that the main use of elliptic curves in characteristic three appears to be in identity based cryptography [3]. For eﬃciency reasons one usually
considers supersingular curves. An alternative Weil descent construction for ordinary elliptic curves in characteristic three is described in [1].

6

Algorithmic Issues

So far our main objective was to investigate whether there exist curves of suﬃciently small genus to whose divisor class group the discrete logarithm problem
could be faithfully transferred. In this section we brieﬂy discuss how to obtain
explicit models for the resulting curves of section 2 and section 3 and how to
perform an index calculus method for solving the discrete logarithm problem.
Note that the curves we are considering are no longer necessarily hyperelliptic.
Also, the most expensive step will be the solving the discrete logarithm and not
the computation of the ﬁnal curve and mapping the discrete logarithm.
6.1

Explicit Models and Mapping the Discrete Logarithm

We ﬁrst exhibit an explicit model for C. Let m = deg(mf ). Note that the classes
of σ i (f ) for 0 ≤ i ≤ m − 1 form an Fp -basis of ∆f /℘(F ). From Theorem 1 it
follows that C is obtained by adjoining one root of every y p − y − σ i (f ) to F . In
other words, C = F [y0 , . . . , ym−1 ]/I where I is the ideal of the polynomial ring
F [y0 , . . . , ym−1 ] generated by the polynomials yip − yi − σ i (f ) for 0 ≤ i ≤ m − 1.
We write y¯i for the images of the yi in C and abbreviate y¯ = y¯0 .

The GHS Attack Revisited

385

Assume that σ extends to a Frobenius automorphism of C with respect to
K/k, again denoted by σ. After possibly replacing yi by yi + µi for some µi ∈ Fp
m−1
we have that σ(¯
yi ) = y¯i+1 for 0 ≤ i < m−1 and σ(¯
ym−1 ) = v − i=0 λi y¯i holds,
m
i
where the λi ∈ Fp are the coeﬃcients of mf = i=0 λi t and v ∈ F satisﬁes
m
v p − v = i=0 λi σ i (f ). Such v will be determined up to addition of an element
in Fp , and usually only one of the p choices of v will be the correct choice so
that σ has order n on C. We obtain an explicit representation of the operation
of σ on C.
The ﬁeld C0 is the ﬁxed ﬁeld of σ in C. Let F0 = k(x) be the ﬁxed ﬁeld of
n−1
y ), where µ is a normal basis element
σ in F = K(x). Deﬁne y˜ = i=0 σ i (µ¯
y ), because y˜ ∈ C0 and C = F (˜
y ), which in
of K over Fp . Then C0 = F0 (˜
turn holds because y˜ has [C : F ] diﬀerent conjugates under G(C/F ). To see
the last statement let τ ∈ G(C/F ) and observe that στ σ −1 ∈ G(C/F ). Deﬁne
λ(τ ) = τ (¯
y ) − y¯ ∈ Fp . The map τ → ( λ(σ −i τ σ i ) )0≤i≤n−1 is injective because
y ). Then a short
the right hand side values determine τ on all conjugates σ i (¯
n−1
calculation shows τ (˜
y ) = y˜ + i=0 σ i (µ)λ(σ −i τ σ i ). Since µ is a normal basis
element we can conclude that y˜ has indeed [C : F ] diﬀerent conjugates. By
computing the characteristic polynomial of y˜ over F in C we thus obtain a
deﬁning polynomial for C0 in F0 [t].
The discrete logarithm can be mapped from Ef to C0 using the conorm map
ConC/Ef followed by the norm map NC/C0 . We give a very rough description of
how this can be accomplished. It is best to work with suitable subrings (Dedekind
domains) REf , RC and RC0 and ideals in these rings such that the ideal class
groups are similar enough to the divisor class groups (preserving the large prime
factor for example). The conorm of a given ideal in REf then becomes the ideal
generated in RC by the given ideal included in RC . Using general techniques we
can compute a representation y¯ = h(˜
y ) with h ∈ F [t]. For the norm ideal we
then form the product of the conjugated ideals in RC using σ. Substituting h(˜
y)
for y¯ and some further steps yield generators of the norm ideal in RC0 .
6.2

Index Calculus

Index calculus methods are employed for solving the discrete logarithm in the
multiplicative group of ﬁnite ﬁelds or the divisor class group of hyperelliptic
curves. They also apply to the divisor class group of general curves. We outline
some of the main issues in our situation.
The basic observation is that every divisor class of C0 of degree gC0 can be
represented by an eﬀective divisor of the same degree. Such a divisor decomposes
uniquely into a sum of places of certain degrees and multiplicities just like the
case of rational integers and prime factorizations, and smoothness probabilities
hold. Computing these divisor class representatives can be done by reduction
techniques as described in [14], and this leads also to a way of computing in the
divisor class group of C0 which generalizes the Cantor method for hyperelliptic
2
) operations
curves. We remark that for hyperelliptic curves addition takes O(gC
0
4
in k whereas for a general C0 addition takes O(gC0 ) operations in k, and is hence
considerably slower.

386

F. Hess

The number of eﬀective divisors of degree less than or equal to gC0 containing
places of degree less than or equal to d can usually be expressed as some explicit
proportion of q gC0 . For example, for gC0 → ∞ and q ﬁxed we have that this number of smooth divisors is approximately at least q gC0 exp(−(gC0 /d) log(gC0 /d))
c1
c2
for gC
≤ d ≤ gC
and 0 < c1 < c2 < 1 ﬁxed. From our formula for
0
0
the characteristic polynomial of Frobenius of C0 in Theorem 8 we see that
gC0 = h∈S s(h) by taking degrees, and then for the cardinality of the divisor
class group #Cl0 (C0 ) = q gC0 h∈S (1+O(q −s(h)/2 )) by evaluating at 1. For every
h ∈ S we have that s(h) | n, and the number of h ∈ S with s(h) | s for given s | n is
less than or equal to ps . If the number of divisors of n is O(log(gC0 )) and q ≥ p2
c
it follows that #Cl0 (C0 ) = q gC0 s|n s(h)=s (1 + O(p−s(h) )) = O(q gC0 gC
) for
0
some constant c > 1, and we expect this to be essentially true for q = p because of possible alternating signs of the trace terms. Dividing the number of
smooth divisors by the class number it is hence reasonable to expect that a proportion of exp(−(1 + o(1))(gC0 /d) log(gC0 /d)) of all divisor classes of degree gC0
will be representable by a smooth divisor, thus leading to the usual smoothness
probability. This would allow for an in gC0 subexponential running time with
parameter 1/2 for solving the discrete logarithm. Fore more details on computing
discrete logarithms for general curves see [15].
Acknowledgements. The author would like to thank N. P. Smart and S. Galbraith for helpful comments, and for the support by an EPSRC grant.

References
1. S. Arita. Weil descent of elliptic curves over ﬁnite ﬁelds of characteristic three.
In T. Okamoto, editor, Advances in Cryptology – ASIACRYPT 2000, LNCS 1976,
pages 248–258, Kyoto, 2000. Springer-Verlag, Berlin-Heidelberg-New York.
2. I. Blake, G. Seroussi, and N. Smart. Elliptic Curves in Cryptography. LMS Lecture
Notes Series 265. Cambridge University Press, Cambridge, 1999.
3. D. Boneh and M. Franklin. Identity-based encryption from the Weil pairing. In
J. Kilian, editor, Advances in Cryptology – CRYPTO 2001, LNCS 2139, pages
213–229. Springer-Verlag, Berlin-Heidelberg-New York, 2001.
4. C. Pandu Rangan and C. Ding, editors. Progress in Cryptology – INDOCRYPT
2001, LNCS 2247, Chennai, India, 2001. Springer-Verlag, Berlin-Heidelberg-New
York.
5. M. Ciet, J.-J. Quisquater, and F. Sica. A secure family of composite ﬁnite ﬁelds
suitable for fast implementation of elliptic curve cryptography. In C. Pandu Rangan
and C. Ding [4], pages 108–116.
6. C. Diem. The GHS-attack in odd characteristic. submitted, 2002.
7. G. Frey. How to disguise an elliptic curve. Talk at ECC’ 98, Waterloo, 1998.
8. G. Frey and H.-G. R¨
uck. A remark concerning m-divisibility and the discrete
logarithm in the divisor class group of curves. Math. Comp., 62:865–874, 1994.
9. S. Galbraith. Weil descent of Jacobians. In D. Augot and C. Carlet, editors,
WCC2001 International workshop on coding and cryptography, Electron. Notes
Discrete Math. 6, Paris, 2001. Elsevier, Amsterdam.

The GHS Attack Revisited

387

10. S. Galbraith, F. Hess, and N. P. Smart. Extending the GHS Weil descent attack. In
L. R. Knudsen, editor, Advances in Cryptology – EUROCRYPT 2002, LNCS 2332,
pages 29–44, Amsterdam, 2002. Springer-Verlag, Berlin-Heidelberg-New York.
11. S. Galbraith and N. P. Smart. A cryptographic application of Weil descent. In
M. Walker, editor, Cryptography and Coding, LNCS 1746, pages 191–200, Cirencester, 1999. Springer-Verlag, Berlin-Heidelberg-New York.
12. P. Gaudry, F. Hess, and N. P. Smart. Constructive and destructive facets of Weil
descent on elliptic curves. J. Cryptology, 15(1):19–46, 2002.
13. F. Hess. Extending the GHS Weil descent attack. Talk at ECC’ 01, Waterloo,
2001.
14. F. Hess. Computing Riemann-Roch spaces in algebraic function ﬁelds and related
topics. J. Symbolic Comp., 33(4):425–445, 2002.
15. F. Hess. Computing relations in divisor class groups of algebraic curves over ﬁnite
ﬁelds. Preprint, 2003.
16. IETF. The Oakley key determination protocol. IETF RFC 2412, 1998.
17. M. Jacobson, A. Menezes, and A. Stein. Solving elliptic curve discrete logarithm
problems using Weil descent. J. Ramanujan Math. Soc., 16(3):231–260, 2001.
18. M. Maurer, A. Menezes, and E. Teske. Analysis of the GHS Weil descent attack on
the ECDLP over characteristic two ﬁnite ﬁelds of composite degree. In C. Pandu
Rangan and C. Ding [4], pages 195–213.
19. A. Menezes, T. Okamoto, and S. Vanstone. Reducing elliptic curve logarithms to
logarithms in a ﬁnite ﬁeld. IEEE Trans. Info. Th., 39:1639–1646, 1993.
20. A. Menezes and M. Qu. Analysis of the Weil descent attack of Gaudry, Hess and
Smart. In D. Naccache, editor, Progress in Cryptology – CT-RSA 2001, LNCS
2020, pages 308–318, San Francisco, 2001. Springer-Verlag, Berlin-Heidelberg-New
York.
21. J. Neukirch. Algebraic Number Theory. Springer-Verlag, Berlin-Heidelberg-New
York, 1999.
22. N. P. Smart. How secure are elliptic curves over composite extension ﬁelds? In
B. Pﬁtzmann, editor, Advances in Cryptology – EUROCRYPT 2001, LNCS 2045,
pages 30–39, Innsbruck, 2001. Springer-Verlag, Berlin-Heidelberg-New York.

