Development of the Normal Spline Method for
Linear Integro-Diﬀerential Equations
Vladimir K. Gorbunov, Vyacheslav V. Petrischev, and Vyacheslav Y. Sviridov
Ulyanovsk State University, L.Tolstoy street 42,
432970 Ulyanovsk, Russia,
gvk@vens.ru, Vyacheslav.Petrischev@transas.com, meria@mv.ru

Abstract. The normal spline method is developed for the initial and
boundary-value problems for linear integro-diﬀerential equations, probably being unresolved with respect to the derivatives, in Sobolev spaces of
the arbitrary smoothness. It allows to solve a high-order systems without
the reduction to ﬁrst-order ones. The solving system can be arbitrary degenerate (with high diﬀerentiation index or irreducible to normal form).
The method of nonuniform collocation grid creation for stiﬀ problems is
oﬀered. Results of numerical solution to test problems are demonstrated.

1

Introduction

The problem under consideration is the system of integro-diﬀerential equations
1

A(t)x(t)
˙ + B(t)x(t) −

K(t, s)x(s)ds = f (t),

0 ≤ t ≤ 1,

(1)

0

with conditions

Cx(0) + Dx(1) = g.

(2)

n

Here x, f, g ∈ R , A(t), B(t), K(t, s), C, D are square n-order matrices. The function f (t) and the coeﬃcients of matrices are continuous and have so many derivatives as it needs to guarantee appropriate smoothness of the solution x(t) that
l
exists on assumption and belongs to the Hilbert-Sobolev space W2,n
with norm
x

l,n

=





n
i=1




l−1
r=0

(r)

xi (0)

2

1
(l)

xi (s)

+
0

(r)

2

1/2

ds
.

(1)

(3)

Here and later xi (t) are derivatives of the order r ≥ 0, also x˙ i = xi .
The matrices of the system (1) may be arbitrary degenerate. It covers the
problem of solving in universal form to diﬀerential-algebraic equations (DAEs)
with any diﬀerentiation index [1] and singular systems having not the ﬁnite index
(irreducible to normal Cauchy form) [2].
Supported by Russian Foundation for Basic Research, project N o 01-01-00731
P.M.A. Sloot et al. (Eds.): ICCS 2003, LNCS 2658, pp. 492–499, 2003.
c Springer-Verlag Berlin Heidelberg 2003

Development of the Normal Spline Method

493

There exist special methods [1], [3] for solving to degenerate ordinary diﬀerential equations (ODEs) working in the case when the matrix rank of the main
part of the solving system is constant.
In [4], [5] there was developed a variational normal spline (NS) method for
the problem (1),(2). The cases of inﬁnite intervals [0, ∞) and (−∞, ∞) were also
covered. This method is based on the transfer to the ﬁnite collocation system of
the equalities (1) and the ﬁnding an element of the minimal norm. In singular
case the problem (1), (2) may have a set of solutions (aﬃne) and the NS method
provides then an approximation of the normal solution denoting by x0 [5].
The theoretical basis of the NS method is the classic functional analysis
results: the theorem of embedding of Sobolev spaces in the Chebyshev one [6]
and Riesz theorem [7] of canonical representation of linear continuous functional
in Hilbert spaces as inner product. Here the coordinate system is not a priori
l
given and is generated by the equation coeﬃcients and the space W2,n
topology.
This representation is based on using some reproducing kernel [8] deﬁned by the
norm (3).
One can ﬁnd the results of the realization of the NS method for ODEs under
l ∈ {1, 2} in [4], [5]. The method was realized for arbitrary integer l in [9] where
general view of reproducing kernels were created. It allows to solve a high-order
systems without their reduction to the ﬁrst-order ones [10] and to solve problems
with a high diﬀerentiation index. The NS method also was developed for twodimensional problems of the computational tomography [11].
The main purpose of this work is to produce a computational scheme of the
l
NS method for the systems of integro-diﬀerential equations (1) in W2,n
with
l ≥ 2. Also the NS method is developed for stiﬀ problems. The using of nonuniform adaptive grids is appropriate in these problems. The diﬀerent strategies
of the collocation grids improvement are based on the theoretical estimates of
the NS method precision. The improvement consists in a serial grid modiﬁcation
(addition and/or moving) with the goal to minimize the norm of the current system discrepancy. We present also results of the numerical solving to degenerate
and stiﬀ problems.

2

The Normal Spline Method

The NS method is a collocation type one. Introduce some grid
0 ≤ t1 < t2 < ... < tm ≤ 1

(4)

and consider the collocation system
1

A(tk )x(t
˙ k ) + B(tk )x(tk ) −

K(tk , s)x(s)ds = f (tk ),

k = 1, . . . , m.

(5)

0

For this system we pose a problem of a normal (in norm (3)) solution. In the
case of the compatible system (1), (2) the solution exists and is uniquely deﬁned.

494

V.K. Gorbunov, V.V. Petrischev, and V.Y. Sviridov

This fact is the consequence of the theorem [6] about the embedding of Sobolev
l
space W2,n
[0, 1] to the Chebyshev one Cnl−1 [0, 1].
Denote the left parts of the system (5), (2) as

lik (x) =

 n



cij xj (0) + dij xj (1),


 j=1







k = 0;
1

n

aij (tk )x˙j (tk ) + bij (tk )xj (tk ) −
j=1

kij (tk , s)x(s)ds, 1 ≤ k ≤ m,
0

where 1 ≤ i ≤ n. Respectively, the system (5), (2) takes the form
li0 (x) = gi ,

lik (x) = fi (tk ),

1 ≤ i ≤ n,

1 ≤ k ≤ m.

(6)
(7)

The functions (6) may be considered as linear continuous functionals in the
l
vector-functions space W2,n
[0, 1]. Respectively, each equation of the system (7)
deﬁnes a hyperplane and the system solution set (an intersection of the hyperplanes) will be nonempty, convex and closed. The minimal norm element of this
intersection is named the normal spline xm . It is known [4], the sequence of the
normal splines xm converges to a normal solution x0 in the norm (3) when the
maximum step of the grid (4) tends to zero.
According to the Riesz theorem [7] a linear continuous functional may be
represented as a inner product corresponding to the norm (3), i.e.
lik (x) = hµ(i,k) , x

n
(n)

=
j=1

µ(i,k)

hj

, xj

(1)

.

(8)

Here µ(i, k) = nk + i, 1 ≤ i ≤ n, 0 ≤ k ≤ m.
Elements hm
j of the representation (8) may be found with the help of the
l
reproducing kernel G(s, t) of the scalar function space W2,1
[0, 1]. Remind [8],
the reproducing kernel is a such function G(s, t) that
l
1. G(·, t) ∈ W2,1
[0, 1] for any t ∈ [0, 1],
l
[0, 1] and any t ∈ [0, 1].
2. xi (t) = G(·, t), xi for any xi (·) ∈ W2,1

Correspondingly,

µ(i,k)

hj

(s) =


cij G(s, 0) + dij G(s, 1), k = 0;




 aij (tk )Gs (s, tk ) + bij (tk )G(s, tk )−



−



1

kij (tk , τ )G(s, τ )dτ ,

1 ≤ k ≤ m.

(9)

0

By virtue of (6) and (8) the system (7) is represented as
hµ , x

(n)

= f¯µ ,

f¯µ =

gi , k = 0;
fi (tk ), 1 ≤ k ≤ m.

(10)

Development of the Normal Spline Method

495

According to the generalized Lagrange method the normal solution of the
linear equations system (10) can be written in the form
(m+1)n
m

uµ hµ (s).

x (s) =

(11)

µ=1

Coeﬃcients uµ are deﬁned by the system
(m+1)n

gµν uν = f¯µ ,

1 ≤ µ ≤ (m + 1)n,

(12)

ν=1

where gµν are the coeﬃcients of the Gram matrix of the system {hµ }, i.e.
gµν = hµ , hν

n
(n)

=
i=1

hµi , hνi

(1) .

(13)

Thus the realization of the NS method with given decomposition of an interval is reduced to the forming of the Gram matrix coeﬃcients according to (13),
the solving to the system of linear equation (12) with symmetric, positive deﬁned (as a rule) matrix {gµν } and the creation of the solution xm (s) at arbitrary
point s ∈ [0, 1] with respect to (9), (11).
In [9] it was shown that the kernel G(s,t) for the norm (3) is a Green function
of some boundary-value problem and is given by the formula

l−1 i

t si
s2l−i−1

− (−1)l+i
,
G(s, t) =
i! i!
(2l − i − 1)!
i=0


G(t, s), 0 ≤ t < s ≤ 1.

3

0 ≤ s ≤ t ≤ 1;

(14)

The Adaptive Grid Construction

Deﬁne the discrepancy of the equation (1) on the function xm :
1
m

m

K(t, s)xm (s)ds − f (t).

ϕ(t) = A(t)x˙ (t) + B(t)x (t) −

(15)

0

In [5] the evaluation

xm − x0

l,n

≤ cˆ ϕ

(l−1),n

(16)

was obtained. The cˆ is constant that is depended only on the system (1), (2)
coeﬃcients.
The evaluation (16) opens the way to creation of optimal nonuniform grids
under given number of nodes m, that is very important for the stiﬀ problem
solving. The convergence in norm implies a uniform convergence, therefore in

496

V.K. Gorbunov, V.V. Petrischev, and V.Y. Sviridov

the process of the method realization we should proceed to new grids decreasing
the value ϕ (l−1),n .
There are equalities ϕ(tk ) = 0 in the collocation nodes hold hence the minimization of the discrepancy norm may be achieved using a simple and reliable
heuristic method: to add nodes into subintervals with the greatest intermediate
(between nodes) values of ϕ(t). The detailed algorithm of the step-by-step concentration of the grids was oﬀered in [5]. This adaptive grid is named an adding
grid with two parameters: the number of start nodes and the number of added
nodes on each step.
Another strategy of creation of the adaptive grid with ﬁxed nodes number
is based on minimization of the value ϕ (l−1),n as a function of nodes with the
constrains (4). Denote
ψl−1 (t1 , . . . , tm ) = ϕ(s, t1 , . . . , tm )

2
(l−1),n .

(17)

l
[0, 1]. The grid
Here the index l − 1 corresponds to the normal spline xm ∈ W2,n
(4) providing the minimum of function ψl−1 (t1 , . . . , tm ) is named optimal.
In case, when the system (1),(2) is regular (matrix A(t) is non-degenerate),
the smoothness of function ψl−1 is deﬁned by the index of derivative l and the
reproducing kernel G(s, t) characteristics. The last has continuous derivatives
with order up to 2l − 2. As it is shown in [12] it provides the diﬀerentiability
of the function ψl−1 with respect to tk for l ≥ 3. In this case the appropriate
analytic formulas for partial derivatives were obtained. We omit them because of
their complexity. In general case one may use some direct method (e.g. HookeJeeves [13]) to minimize the function ψl−1 .
We turn our attention to the solving of an initial problem for the diﬀerential
equation (1) (K ≡ 0), i.e. the condition (2) has the form x(0) = g. In this case
the most eﬀective NS method realization scheme is the sequential normal spline
creation on partial adjoining subintervals with a small number of nodes (up to
two). The eﬀectiveness is achieved as a result of reducing of the Gram matrix
dimension since the calculation of its elements and solving the linear equation
system are the most time-consuming part of the algorithm.
If partial interval is suﬃciently small we can use the grid with two nodes
and create the spline on two nodes {tk−1 , tk } on each step. The initial values on
second and following subintervals are deﬁned as ﬁnal values of the created spline
on the previous subinterval.
Deﬁne some admissible level ε of local measure of error evaluation
k
(tk−1 , tk ) deﬁned similar to (17). This value should be estimated by using
ψl−1
some quadrature formula.
The simple variant of the algorithm is the next.

1.
2.
3.
4.
5.

k := 1, t0 := 0.
tk := 1.
To construct the NS for the Cauchy problem (1) on (tk−1 , tk ).
k
< ε then go to 6.
If ψl−1
tk := (tk + tk−1 )/2, go to 3.

Development of the Normal Spline Method

497

6. If tk = 1, then end else tk−1 := tk .
7. k := k + 1, go to 2.
As a result we obtain the grid that provides the given level of the local
discrepancy norm value.
The similar sequential algorithm can be applied for solution of integrodiﬀerential equations of Volterra type. In this case it is necessary to make the
next modiﬁcation of algorithm: on step 3 we construct the normal spline for the
equation
tk−1

t

tk−1

4

K(t, s)xm (s)ds,

K(t, s)x(s)ds = f (t) +

A(t)x(t)
˙ + B(t)x(t) −

0

tk−1 ≤ t ≤ tk .

(18)

Numerical Implementation

Example 1. The initial problem from [3] for ODE (1) where K ≡ 0 and
A(t) =

t1
00

,

B(t) =

γ −δ
t 1

.

The system (1) with condition γ + δt = 1 has the diﬀerentiation index 2 and
the unique solution with any right part f ∈ C22 [0, 1]. Besides, it was shown [3]
that classical diﬀerence Euler, Runge-Kutta and multistep methods diverge or
are not applied for γ, δ such that |γ + δt| < 1. The NS method gives approximate
solution in any compatible case.
Table 1 presents results of the initial problem solving for exact desired function
et sin(t)
x(t) =
cos(t)
on interval t ∈ [0, 1] with uniform grid of 51 points. Values of the obtained normal
splines deviations from exact solution on doubled grid are shown. The cases of
mentioned above condition violation is marked by asterix (*). In these cases the
non-uniqueness of the solution is possible. The normal spline approximate the
normal solution.
One can see that increasing of the spline smoothness leads to the increasing
of the approximation accuracy.
Example 2. Consider the second-order initial problem
p(t)¨
x(t) + q(t)x(t)
˙ + r(t)x(t) = f (t),
x(0) = g1 ,

0 ≤ t ≤ 1,

x(0)
˙
= g2

where p(t) = sin(10t), q(t) = 10cos(10t), r(s) = −1. The function f (t) corresponds to the solution x(t) = te−t + e−kt , k > 1.

498

V.K. Gorbunov, V.V. Petrischev, and V.Y. Sviridov
Table 1.
γ\δ
2
0
-1
-2

l=2
1.36e-1 *
1.09e-2
7.79e-3
5.58e-3

-1

l=3
4.66e-04*
2.74e-05
1.97e-05
1.58e-05

0

l=2
1.83e-2
2.09e-2
1.08e-2
7.31e-3

l=3
3.43e-05
4.72e-05
2.73e-05
1.97e-05

l=2
6.02e-3
2.06e-2 *
9.19e-2 *
1.95e-2

2

l=3
1.34e-05
3.50e-05 *
3.45e-04 *
4.59e-05

The coeﬃcients p(t), q(t) have zero values on the interval [0, 1] and the solution is stiﬀ under large k. The variable degeneracy of the coeﬃcients makes
diﬃculties for using known diﬀerence methods for stiﬀ and ADEs [1].
We use the transfer to integro-diﬀerential equation
t

(q(s)
˙ − p¨(s) − r(s)) x(s)ds =

p(t)x(t)
˙ + (q(t) − p(t))
˙
x(t) −
0
t

=

f (s)ds + q(0)x(0) + p(0)x(0)
˙
− p(0)x(0).
˙
0

The eﬀectiveness of this way in stiﬀ cases was shown in [5].
Table 2 presents some results for two variants of the NS method: two-nodes
sequential scheme and uniform grid one. The problem was solved in the space
W22 . Note, that value ε is used in the sequential scheme and it deﬁnes the obtained number of nodes.
Table 2.
k
100
-//1000

5

ε
1.00e-3
1.00e-5
1.00e-5

m
24
103
85

sequential
5.64e-02
7.69e-03
1.61e-02

uniform
1.07e+00
2.14e-01
9.30e-01

Conclusion

Presented above numerical results also as results of [4], [5], [9], [10], [12] demonstrate the ability of the NS method to obtain appropriate approximation of
solutions to arbitrary degenerate problems of linear diﬀerential and integrodiﬀerential equations. Particularly for equations that can’t be reduced to the
normal Cauchy form, i.e. equations not having of a diﬀerentiation ﬁnite index.
We know only theoretical works devoted to such kind of ODEs problems [2]. We
are inclined to explain the success of the NS method by using in its base of the
Sobolev spaces theory that is outstanding achievement of functional analysis.

Development of the Normal Spline Method

499

References
1. Hairer, E., Wanner, G.: Solving Ordinary Diﬀerential equations II. Stiﬀ and
Diﬀerential-algebraic Problems. Springer-Verlag, Berlin (1996)
2. M¨
arz, R., Weinm¨
uller, E.B.: Solvability of boundary value problems for systems
of singular diﬀerential-algebraic equations. SIAM J. Math. Anal. Vol. 24. 1 (1993)
200–215
3. Bulatov, M.V., Chistyakov, V.F.: About the numerical method of diﬀerantialalgebraic equations solving. Comput. Math. Math. Phys. Vol. 42. 4 (2002) 459–470
4. Gorbunov, V.K.: The method of normal spline-collocation. Comput. Math. Math.
Phys. Vol. 29. 2 (1989) 212–224
5. Gorbunov, V.K.: Ekstremalnie zadachi obrabotki rezul’tatov izmerenei. Ilim,
Frunze (1990)
6. Sobolev, S.L.: Applications of functional analysis to mathematical physics. Amer.
Math. Soc. Providence RI (1963)
7. Balakrishnan, A.: Applied Functional Analysis. Springer-Verlag, New York (1976)
8. Aronszajn, N.: Theory of reproducing kernels. Tranzactions of the AMS 68 (1950)
337–404
9. Gorbunov, V.K., Petrischev, V.V.: Developing of the normal spline-collocation
method for linear diﬀerential equations. Comput. Math. Math. Phys. (2003) (to
appear)
10. Gorobetz, A.S.: Metod normal’nih splainov dlya system ODU vtorogo poryadka
i zadach matematicheskoi phiziki. Diﬀerencial’nie uravneniya i ih prilogeniya:
Sbornik trudov mejdunarodnoy konferencii. Samara (2002) 99–104
11. Kohanovsky, I.I.: Normalnije splaini v vichislitel’noi tomograﬁi. Autometria 2
(1995) 84–89
12. Sviridov, V. Yu.: Optimizaciya setok metoda normal’nih splainov dlya integrodiﬀerencial’nih uravnenei. Trudi Srednevolgskogo matematicheskogo obschestva.
SVMO, Saransk 3-4 (2002) 236–245
13. Himmelblau, D.M.: Applied nonlinear programming. McGraw-Hill Book Company,
Texas (1972)

