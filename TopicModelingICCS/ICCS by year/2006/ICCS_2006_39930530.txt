Development of a Computational Paradigm for
Laser Treatment of Cancer
J.T. Oden1 , K.R. Diller2 , C. Bajaj3 , J.C. Browne3 , J. Hazle4 , I. Babuˇska1,
J. Bass1 , L. Demkowicz1 , Y. Feng1 , D. Fuentes1 , S. Prudhomme1 ,
M.N. Rylander2 , R.J. Staﬀord4 , and Y. Zhang1
1

Institute for Computational Engineering and Sciences
2
Department of Biomedical Engineering
3
Department of Computer Science,
The University of Texas at Austin, Austin TX 78712, USA
{oden, babuska, bass, leszek, feng, fuentes, serge,
jessica}@ices.utexas.edu,
{kdiller, n.forney}@mail.utexas.edu,
{bajaj, browne}@cs.utexas.edu
4
University of Texas M.D. Anderson Cancer Center,
Department of Diagnostic Radiology, Houston TX 77030, USA
{jhazle, jstafford}@mdanderson.org
http://www.ices.utexas.edu/∼feng/dddas

Abstract. The goal of this project is to develop a dynamic data-driven
planning and control system for laser treatment of cancer. The research
includes (1) development of a general mathematical framework and a
family of mathematical and computational models of bio-heat transfer,
tissue damage, and tumor viability, (2) dynamic calibration, veriﬁcation and validation processes based on laboratory and clinical data and
simulated response, and (3) design of eﬀective thermo-therapeutic protocols using model predictions. At the core of the proposed systems is
the adaptive-feedback control of mathematical and computational models based on a posteriori estimates of errors in key quantities of interest,
and modern Magnetic Resonance Temperature Imaging (MRTI), and
diode laser devices to monitor treatment of tumors in laboratory animals.
This approach enables an automated systematic model selection process
based on acceptance criteria determined a priori. The methodologies to
be implemented involve uncertainty quantiﬁcation methods designed to
provide an innovative, data-driven, patient-speciﬁc approach to eﬀective
cancer treatment.

1

Introduction

Today, cancer is among the leading causes of death in the United States representing 41% of the death rate in 2004 with 1.37 million new cases reported last
year. According to the American Cancer Society [1], prostate cancer is responsible for 33% of the cancer deaths of male patients, and breast cancer for 32%
of the cancer deaths of female patients in the United States.
V.N. Alexandrov et al. (Eds.): ICCS 2006, Part III, LNCS 3993, pp. 530–537, 2006.
c Springer-Verlag Berlin Heidelberg 2006

Development of a Computational Paradigm

531

Eﬀective cancer treatment requires complete destruction of cancerous cells
while maintaining functionality of infected organs. When cancerous tumors occur in well-deﬁned and non-vital regions, conventional surgical procedures for
removal of aﬀected tissue is the customary medical treatment; but, traditionally,
little can be done when tumors are small and spread over the region. In contrast,
laser surgery is minimally invasive and simple to perform, potentially decreasing
complications and minimizing hospitalization. Laser therapies provide a lethal
dose of heat to the desired site while minimizing damage to surrounding tissue. In
particular, laser-induced hyperthermia therapies promise eﬀective treatment of
small, poorly-deﬁned metastases or other tumors embedded within vital regions.
The success of laser treatments would be highly increased with the ability
to provide a reliable prediction of treatment outcome at the time of treatment
delivery using high ﬁdelity computer predictions. Knowledge of temperature history versus time during treatment has been used to predict thermal necrosis in
regions where damage is severe, but in regions where temperatures are insuﬃcient to coagulate proteins, the results and subsequent eﬀects have been diﬃcult
to predict. This is due, in part, to the expression of heat shock protein (HSP) in
the regions of thermal stress, which provide enhanced viability of tumor tissue
resulting in the recurrence of cancer. Consequently, knowledge of the thermal
dose necessary to activate or de-activate HSP expression as a function of temperature and time in the aﬀected tissue [5, 4] can be critical in planning and
implementing an eﬀective thermal treatment by laser surgery.
Grid-computing-enabled dynamic data-driven planning and control systems
can provide a unique opportunity for conformal delivery of heat generated by
diode or other types of lasers to the target. Image guided thermal ablation therapy surgery or as a complementary therapy for cancer management. In addition,
image guidance has the potential to provide real-time treatment monitoring by
providing temperature and thermal dose feedback during treatment delivery [7].
By including Magnetic Resonance Temperature Imaging (MRTI), the thermal
dose delivered to surrounding normal tissue during therapy can be limited and
a more conformal treatment achieved.

2

Description of Laser Treatment Arena

The primary objective of this paper is to describe an approach for guiding laser
therapy of cancer, particularly prostate cancer, by accurate control and monitoring of the treatment process through computer simulation. This will be made
possible through the development of dynamic data-driven, high-ﬁdelity computer
simulation models correlated with in vivo spatiotemporal temperature information generated during hyperthermia, and cellular and in vivo HSP expression
and damage data collected to adaptively control thermo-therapy of cancerous
tumors. The speciﬁc aims supporting this objective are:
1. To develop an adaptive control system that operates over a computational
grid connecting a Treatment/Measurement Arena (TMA) in Houston at

532

J.T. Oden et al.

the UT’s M.D. Anderson Cancer Center (MDACC) and a Computational/
Simulation Arena (CSA) in Austin at The University of Texas at Austin
(UT Austin).
2. To develop new algorithms, laboratory and modeling protocols to enable
the development of the control systems, including adaptive modeling and
meshing procedures, calibration procedures, veriﬁcation and validation procedures, inverse modeling and sensitivity analysis algorithms, and laboratory
procedures for measuring tissue damage and HSP expressions to characterize
the kinetic relationship in terms of temperature and time.
3. To demonstrate the eﬀectiveness of the entire process by applying it to the
treatment of actual prostate tumors in canines, using modern MRTI-guided
laser surgery, distributed visualization and imaging techniques, and data
storage and processing devices.
This paper will focus on the mathematical characterization of HSP expression,
mesh generation, and development of the computational infrastructure. Development of the control system to operate over a computational grid will be discussed
in future work.

3

HSP Characterization and Damage Model

Heat Shock Proteins are a family of gene products expressed in higher concentrations in the presence of environmental stresses. The name vastly understates the HSP family’s astounding versatility. These proteins have been
identiﬁed as critical components of cell survival under adverse environmental
conditions. Various levels of HSP species indicate the health or likelihood of cell proliferation or drug resistance.
Also, measures of cell
damage as a function of
temperature and time
for a speciﬁc patient is a
critical indication of the
eﬀectiveness of thermotherapies. Knowledge of
the temperatures necessary to elicit interaction
in tumor resistance and
cell damage is essential
to eﬀectively produce a
desired tissue response
Fig. 1. HSP Expression Model
and surgical outcome.

Development of a Computational Paradigm

533

The work of Rylander [4] developed a model for HSP expression and cell
damage based on an Arrhenius model for a mouse. Figure 1 shows the comparison
of the experimentally determined HSP expression with the predicted values of
(1). According to Rylander [4], HSP expression H(T, t) can be predicted by:
γ

H(T, t) = H0 eαt−βt

(1)

where α, β, and γ are time independent parameters that may depend on temperature, with γ > 1.
Cellular damage is measured in terms of the damage fraction FD predicted
by means of an Arrhenius integral formulation [5].
t

FD (t) = 1 − e−Ω(t)

Ω(t) = ln(C0 /Ct ) = A

eEa /RT (τ ) dτ

0

where C0 is the initial concentration of healthy cells, Ct the concentration of
healthy cells after heating at time t, A the pre-exponential scaling factor, Ea the
activation energy of the injury process, R the universal gas constant, and T the
absolute temperature.

4

The Bioheat Transfer Model

Driving the prediction of the HSP and cellular damage is the temperature ﬁeld
produced by the library of bioheat models. The work of Liu [2] has shown Pennes
model [3] to give good results for prediction of temperature ﬁeld in the prostate.
As a result only Pennes model will be discussed. Determination of other feasible
vasculature and/or continuum bioheat transfer models is in progress.
A space-time variational construction of Pennes equation is used for developing the optimal control framework and in the computational implementation.
Following the standard procedure and assuming Cauchy boundary conditions,
the variational form of Pennes model is:
Find T (x, t) ∈ L2 [0, τ ], H 1 (Ω) with T (x, t) ∈ L2 [0, τ ], L2 (Ω) :
∀v ∈ L2 [0, τ ], H 1 (Ω)

B(T ; v) =F (v)

(2)

where
τ

B(T ; v) =

ρcp
0

Ω

hT v dAdt +
0

0

∂Ω

Ω

T (x, 0) v(x, 0) dx
Ω

τ

Qlaser (x)v dxdt −

F (v) =

dxdt

τ

−
τ

∂T
v + k∇T · ∇v − ωcblood (Ta − T ) v
∂t

T 0 v(x, 0) dx

hT∞ v dAdt +
0

∂Ω

Ω

Here k and ω are bounded functions of T, linear in the temperature regimes of
interest, cp and cblood are the speciﬁc heats, Ta the arterial temperature, and h
is the coeﬃcient of cooling. The laser source term Qlaser is a linear function of
laser power and exhibits exponential decay with distance from the source. See
[5] for additional details.

534

5

J.T. Oden et al.

Mesh Generation

The ﬁrst step in simulation is to construct
a ﬁnite element mesh used for the governing
equations within the library of bioheat transfer models. The mesh generation involves two
parts: (1) construction, from MRI data, of a
ﬁnite element mesh to represent the geometry (2) overlaying the MRTI temperature
ﬁeld onto the ﬁnite element mesh.
Prostate tumor cells were inoculated in
the hind legs of a mouse and grown to a tumor burden of less than 1.0 cc, Figure 2. A
sample of the MRI data used to construct
a mesh of the mouse and tumor is shown
in Figure 3. The hexahedral mesh of the
tumor (blue) and tissue (yellow), shown in
Figure 2, was created by a semi-automatic
segmentation method adapted to ﬁnd the interface boundaries of tumor and tissue. Cubic spline and lofting methods are applied
to obtain smooth boundaries from the segmented MRI data [5, 8].
Spatio-temporal temperature distribution
is measured during the laser treatment with Fig. 2. Mouse and Mesh (from [5])
update times less than 5 seconds per image
and thickness between planes of 2.0 mm. The temperature ﬁeld, measured in a
canine prostate, is accurately overlaid onto the geometry data and nodal temperature values are assigned to the mesh by taking the interpolant of the MRTI
temperature data.

Fig. 3. MRI Data of Mouse

6

Control System

The dynamic ﬂow of every problem posed within the laser treatment control
system may be cast under the following mathematical framework.

Development of a Computational Paradigm

535

Find ξ ∈ W : Q(ξ) = inf Q(η)
η∈M

M = {η ∈ W : B(η; v) = F (v)

v ∈ V}

(3)

where Q : W → R is a functional characterizing a particular quantity of interest
and a saddle point, (ξ, p) ∈ W × V of the Lagrangian
L(ξ; p) = Q(ξ) + F (p) − B(ξ; p)
solves the optimal control problem. Thus the problems of calibration, optimization, and computing local computing local error estimates dynamically for each
model within the library of bioheat transfer models are to solve:
Find (ξ, p) ∈ W × V :
B(ξ; v) = F (v)
B (ξ; η, p) = Q (ξ, η)

∀v ∈ V

(4)

∀η ∈ W

Algorithms for discretizing and solving the dynamic calibration and optimization problems and dynamically computing local error estimates may be studied
through a single example; we consider here the calibration problem. The problem
of model calibration is to ﬁnd the set of model parameters that minimize the L2
norm of the diﬀerence between the predicted temperature ﬁeld and the experimentally determined temperature ﬁeld at each time instance of the experimental
data. The calibration problem may be stated as follows:
Given experimentally determined temperature ﬁelds at times t1 , t2 , ..., tn
t1
t2
tn
Texp
(x), Texp
(x), ....., Texp
(x)

Find the temperature ﬁeld, T ∗ , and best combination of model coeﬃcients,
β ∗ = (k0∗ , k1∗ , ω0∗ , ω1∗ ), that minimizes
Q(T, β) =
k

Ω

tk
(T (x, tk ) − Texp
(x))2 dx

i.e. (T ∗ , β ∗ ) satisﬁes
Q(T ∗ , β ∗ ) =

inf

(T,β)∈M

Q(T, β)

M = {(T, β) ∈ W : B(T, β; v) = F (v)

∀v ∈ V}

The semilinear and linear forms are deﬁned from (2) with k = k(T, k0 , k1 ) and
ω = ω(T, ω0 , ω1 ).

536

J.T. Oden et al.

For appropriately chosen test functions, a solution (T, β, p) to the calibration
problem satisﬁes the forward in time state equation with initial conditions,
ρcp
Ω

∂T
v + k(T, k0 , k1 )∇T · ∇v − ω(T, ω0 , ω1 )cblood (Ta − T ) v
∂t

−

Qlaser (x)v dxdt −

hT v dAdt =
∂Ω

Ω

hT∞ v dAdt

dxdt
∀v

∂Ω

+ initial conditions
a backward in time adjoint/dual equation with terminal conditions ,
∂p ˆ
∂k
T + k(T, k0 , k1 )∇Tˆ · ∇p + Tˆ
∇T · ∇p dxdt
∂t
∂T
Ω
∂ω
+
(Ta − T )p dxdt
ω(T, ω0 , ω1 )Tˆp + Tˆ
∂T
Ω
−ρcp

=2
k

Ω

tk
Tˆ(x, tk ) dx
T (x, tk ) − Texp

∀Tˆ

+ terminal conditions
and a control equation, which may be shown to be the gradient of the quantity
of interest/objective function.
⎡
⎤
τ
∂k
∇T · ∇p dxdt
⎢
⎥
0
Ω ∂k0
⎢
⎥
τ
⎢
⎥
∂k
⎢
⎥
∇T
·
∇p
dxdt
⎢
⎥
⎢
⎥
0
Ω ∂k1
∇β Q = ⎢ τ
⎥=0
⎢
⎥
∂ω
⎢
⎥
(T
−
T
)p
dxdt
⎢ 0 Ω ∂ω0 a
⎥
⎢
⎥
τ
⎣
⎦
∂ω
(Ta − T )p dxdt
0
Ω ∂ω1
For bioheat models involving larger parameter sets (> 100), a Newton method
is used which requires the computation of the Hessian of the objective function.
An additional beneﬁt of computing the Hessian is that the Hessian may be used
to obtain a stochastic set of model coeﬃcients in which a standard deviation
of the computed model coeﬃcients may be obtained. Details of computational
algorithms and challenges are to be discussed in a forthcoming paper.

7

Concluding Remarks

This is a truly interdisciplinary project designed to resolve several very challenging research issues. Successful execution of this research requires collaboration
and coordination across applied mathematics, computational science, physics,
and biomedical engineering. Current progress is showing the mesh generation
techniques and computational implementation of Pennes model to give good
agreement with experimental MRTI data, Figure 4.

Development of a Computational Paradigm

537

The ability to combine Pennes model with a temperature dependent HSP expression model to be used as a predictive tool [6] for the optimal laser parameters
for the laser treatment of cancer is also
coming to realization.
Successful completion of this research
will provide a powerful methodology for
and insight into planning and optimizing
the delivery of thermotherapy for cancer
treatments. This study
will also enable a
Fig. 4. Model Validation [5]
better understanding
of HSP kinetics and
damage proﬁles at the cellular and tissue levels in prostate cancer issued from
metered thermal stress. The enormous breadth of discipline and the richness of
the collaboration required in this eﬀort will set a precedent.
Acknowledgments. The support of this project by the National Science Foundation under grant CNS-0540033 is gratefully acknowledged.

References
1. PROACT, Prostate Action Incorporated. http://www.prostateaction.org/statistics.
http://www.cancer.org/docroot/STT/stt 0.asp.
2. J. Liu, L. Zhu, and L. Xu. Studies on the three-dimensional temperature transients
in the canine prostate during transurethral microwave thermal therapy. J. Biomech.
Engr, 122:372–378, 2000.
3. H. H. Pennes. Analysis of tissue and arterial blood temperatures in the resting
forearm. J. Appl. Physiol., 1:93–122, 1948.
4. M. N. Rylander, Y. Feng, and K. R. Diller. Thermally induced HSP 27, 60, and 70
expression kinetics and cell viability in normal and cancerous prostate cells. Cell
Stress Chaperones, In review, 2006.
5. M. N. Rylander, Y. Feng, J. Zhang, J. Bass, Staﬀord R. J., J. Hazle, and K. Diller.
Optimizing hsp expression in prostate cancer laser therapy through predictive computational models. J. Biomed Optics, In press, 2006.
6. M.N. Rylander. Design of Hyperthermia Protocols for Inducing Cardiac Protection
and Tumor Destruction by Controlling Heat Shock Protein Expression. PhD thesis,
The University of Texas at Austin, 2005.
7. R. Salomir et al. Hyperthermia by MR-guided focused ultrasound: accurate temperature control based on fast MRI and a physical model of local energy deposition
and heat conduction. Magn. Reson. Med., 43(3):342–347, 2000.
8. Y. Zhang and C. Bajaj. Adaptive and quality quadrilateral/hexahedral meshing
from volumetric data. Computer Methods in Applied Mechanics and Engineering,
195:942–960, 2006.

