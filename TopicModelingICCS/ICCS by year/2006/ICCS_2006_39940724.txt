State Dependent Symplecticity of Symmetric
Methods
Felice Iavernaro and Brigida Pace
Dipartimento di Matematica, Universit`
a di Bari, Italy
felix@dm.uniba.it, pace@dm.uniba.it

Abstract. Despite symmetric one-step methods applied to Hamiltonian
dynamical systems fail in general to be symplectic, we show that symmetry implies, however, a relation which is close to symplecticity and that
we called state dependent symplecticity. We introduce such deﬁnition for
general maps and analyze it from an analytical viewpoint in one simpler case. Some numerical tests are instead reported as a support of this
feature in relation with the good long time behaviour of the solutions
generated by symmetric methods.
Keywords: Hamiltonian and Poisson systems, symplecticity, symmetric methods.
Subject Classiﬁcation: 65P10, 65L05, 37M15.

1

Introduction

In this paper we link the property of symmetry of a one step numerical integrator
applied to the Hamiltonian system
y˙ = J∇H(y),

J=

0 −I
I 0

,

y = (p, q)T ,

H(p, q) : Rm × Rm −→ R, (1)

with I the identity matrix, to a relation (satisﬁed by the map representing the
method itself) called state dependent symplecticity (sd-symplecticity) which is
close to the standard symplecticity property of symplectic integrators (we refer
to [5] for the general theory on Hamiltonian problems). Although we do not
report exhaustive theoretical results, we give some insights on how such feature
in turn relies on the good stability properties shared by symmetric methods when
applied to particular but important Hamiltonian systems in a neighborhood of
an equilibrium point. In the following we assume that
y1 = φh (y0 )

(2)

is a one-step method of order p applied to the problem (1) with stepsize h (we
assume regularity of the transformation φh ).
This work was supported by COFIN-PRIN 2004 (project “Metodi numerici e software matematico per le applicazioni”).
V.N. Alexandrov et al. (Eds.): ICCS 2006, Part IV, LNCS 3994, pp. 724–731, 2006.
c Springer-Verlag Berlin Heidelberg 2006

State Dependent Symplecticity of Symmetric Methods

725

Deﬁnition 1. The one-step method (2) is called sd-symplectic if, when applied
to the problem (1), its Jacobian matrix satisﬁes
∂y1
∂y0

T

J(y1 , −h)

∂y1
∂y0

= J(y0 , h),

(3)

where J is a skew-symmetric nonsingular matrix for all h ≤ h0 .
Although for our purposes we have attached property (3) to a numerical method,
we may extend its applicability to any parametric transformation in the form
(2), where h stands for the parameter. Furthermore, one easily realizes that
the matrix J(y, h) approximates J up to the order of the method: J(y, h) =
J + O(hp ).
The dependence of relation (3) on the stepsize h is both implicit (since y1
depends on h) and explicit. In the particular cases where the explicit dependence
is missing or where J(·, γ) is an even function of γ, we may recast (3) as
∂y1
∂y0

T

J(y1 )

∂y1
∂y0

= J(y0 ),

(4)

where J(y) = J(y, ±h), and we are led back to the deﬁnition of a Poisson map
with respect to the bracket
{F, G} = ∇F (y)T J(y) ∇G(y),

with F, G : R2m → R.

Poisson systems generalize Hamiltonian systems in that they are deﬁned by
substituting to the matrix J in (1) any skew-symmetric matrix J(y) satisfying
the Jacobi identity {F, G}, H + {G, H}, F + {H, F }, G = 0. The ﬂow of
a Poisson system
z˙ = J(z)∇H(z)
(5)
is a Poisson map, and this justiﬁes the study of Poisson integrators, that is
numerical methods satisfying (4) when applied to (5).
Thus Deﬁnition 1 weakens the properties of a Poisson map. In general, neither
the matrix J(y, h) satisﬁes the Jacobi identity nor can it be stated that a sdsymplectic method is a Poisson integrator for a given set of almost Poisson
problems. On the other hand, from a geometric viewpoint it seems like that
property (3) may still imply, under suitable assumptions on the structure of
the Hamiltonian and on the dynamics of the solution, an almost preservation
of volumes of any bounded regions in the phase space, under the iterations of
the method. This circumstance has already been detected and analysed in the
simpler case of problems with one degree of freedom [4], where Deﬁnition 1
∂y1
1 T
simpliﬁes as μ(y1 , −h)( ∂y
∂y0 ) J( ∂y0 ) = μ(y0 , h)J with μ a scalar function. In this
paper we consider the case of higher dimensional problems. For the special case
of the trapezoidal method the computation simpliﬁes remarkably and therefore
we will use such simpler method to retrieve some theoretical results, while we
will provide numerical evidence that other symmetric methods do exhibit similar
behaviours.

726

2

F. Iavernaro and B. Pace

Sd-Symplecticity of Symmetric Runge-Kutta Methods

To see that any symmetric consistent RK method is sd-symplectic, we start
the computation by considering the trapezoidal formula, which is the simplest
symmetric non symplectic one step method. The application of the trapezoidal
method to the Hamiltonian problem (1) deﬁnes the mapping
y1 = y0 +

h
J(∇H(y0 ) + ∇H(y1 )).
2

By diﬀerentiating y1 with respect to y0 , we get the variational equation
I−

h
J ∇2 H(y1 )
2

∂y1
=
∂y0

I+

h
J ∇2 H(y0 ) ,
2

h
where ∇2 H(y) is the Hessian matrix of H(y). Setting A± (y) = I ± J ∇2 H(y)
2
yields
(

∂y1 T
) A− (y1 )
∂y0

T

J A− (y1 )

∂y1
= A+ (y0 )
∂y0

T

J A+ (y0 ) .

A direct computation shows that (A− (y))T J A− (y) and (A+ (y))T J A+ (y) deﬁne the same skew-symmetric matrix
J(y, h) = J +

h2 2
∇ H(y) J ∇2 H(y).
4

(6)

For s-stage symmetric RK methods, we follow a similar approach (see [4] for
further details). In this case the mapping (2) reads
y1 = y0 + hJ(bT ⊗ I)∇H(K),

(7)

where K = [K1T , . . . , KsT ]T is the block vector of the internal stages
K = e ⊗ y0 + h(A ⊗ J)∇H(K),
and ∇H(K) ≡ [∇T H(K1 ), . . . , ∇T H(Ks )]T . Due to symmetry, we can split the
term (bT ⊗ I)∇H(K) of (7) in two (symmetric) terms depending uniquely on y0
and y1 respectively:
y1 = y0 +
where

h
J(bT ⊗ I) ∇H(K + (y0 )) + ∇H(K − (y1 )) ,
2

K ± (y) = e ⊗ y ± h(A ⊗ J)∇H(K ± (y)).

(8)

(9)

Diﬀerentiation of (8) with respect to y0 yields a variational equation that looks
similar to the one obtained for the trapezoidal method:
I−

h
J F−h (y1 )
2

∂y1
=
∂y0

I+

h
J Fh (y0 ) ,
2

(10)

State Dependent Symplecticity of Symmetric Methods

with
F±h (y) ≡ (bT ⊗ I)∇2 H(K ± (y))

727

∂K ± (y)
.
∂y

By deﬁning

γ
γ
Fγ (y))T J (I + Fγ (y)),
2
2
and exploiting symmetry, we ﬁnally arrive at (3).

(11)

J(y, γ) = (I +

2.1

The Trapezoidal Method as a Simple Example

The presence of the internal stages in a RK-method is responsible of the loss of
symmetry of the matrix J(y, γ) with respect to the second argument γ; in fact, in
general, Fγ (y) = F−γ (y). Looking at (6) one realizes that for the trapezoidal method sd-simplecticity reduces to the standard preservation of a Poisson bracket
structure (hereafter, to simplify the notation, we set again J(y) ≡ J(y, ±h)).
This comes not as a surprise since the trapezoidal method is conjugate to the
midpoint implicit method which is symplectic [3]. Therefore the simpler condition (6) is well understood in terms of measure preserving properties1 . In the
phase space R2m consider a 2-dimensional sub-manifold M obtained as the image of a compact set K ⊂ R2 through a continuously diﬀerentiable function
ψ : (s, t) ∈ K → (p, q) ∈ M, that is ψ(K) = M. The scalar quantity
Ω(M) =
K

∂ψ
(s, t)
∂s

T

J(ψ(s, t))

∂ψ
(s, t) ds dt.
∂t

(12)

is the sum of the scaled oriented areas of the projections of M onto the orthogonal planes (pi , qi ), i = 1, . . . , m. The term “scaled areas” means that J acts as
a weight function. Therefore it turns out that the trapezoidal method preserves
the quantity Ω(M), i.e.,
Ω(φh (M)) = Ω(M),
(13)
with J(·) = J (·, ±h) deﬁned in (6). For h → 0 we get J → J and (13) reduces
to the classical geometrical interpretation of symplecticity.
From (3), for the trapezoidal method we get
∂yn
∂y0

T

J(yn )

∂yn
∂y0

=

∂yn ∂yn−1
∂yn−1 ∂y0

=

∂yn−1
∂y0

T

J(yn )

T

J(yn−1 )

∂yn ∂yn−1
∂yn−1 ∂y0

∂yn−1
∂y0

,

and an induction process allows us to link the generic state vector yn to the
initial one:
T
∂yn
∂yn
J(yn )
(14)
= J(y0 ).
∂y0
∂y0
1

As guide lines for the following description, we adopt the same argument and notations exploited in [3] to describe the geometric interpretation of symplecticity.

728

F. Iavernaro and B. Pace

A symplectic transformation is volume preserving. Analogously a Poisson transformation preserves a non-Euclidean measure (scaled volume). To ﬁnd out the
expression of the scaled volume preserved by the trapezoidal method, we consider
the determinants of both sides of (14)
⎛
det

∂yn
∂y0

=⎝

det J(y0 )

⎞ 12
⎠ ,

(15)

det J(yn )

from which we obtain the following scaled volume conservation property:
scaled-Vol(Sn ) = scaled-Vol(S0 ),

(16)

where the scaled volume of a 2d-dimensional region S ⊂ Ω deﬁned by the trapezoidal method is
1

scaled-Vol(S) ≡

(det(J(y)) 2 dy =
S

det(J +
S

h2 2
∇ H(y)J∇2 H(y))dy. (17)
4

In particular, for separable Hamiltonian systems H(p, q) = T (p) + U (q), (17)
reduces to
scaled-Vol(S) =

det I +
S

h2
U (q)T (p) dp dq.
4

The Taylor expansion of (15) yields
det

∂yn
∂y0

= 1 + O(h2 ),

where the O(h2 ) term may be assumed independent of n if the Hessian matrix
∇2 H(yn ) remains bounded. This is true for systems (like the nonlinear pendulum) where the entries of the Hessian matrix are bounded functions or, more
importantly, when the solution yn itself lies in a compact set of the phase space2 .
In such a case we obtain
dy0 + O(h2 ),

dyn =
Sn

(18)

S0

where the O(h2 ) term is independent of the integration time, which states a
nearby-preservation property of the volumes.
Due to the appearance of the internal stages, it is not possible to retrieve a
relation so easy as (14) for higher order RK methods. Consequently, the remainder in the analogue expression of (18) for a symmetric RK method, is expected
2

This is a standard assumption when investigating the long time behaviour of the
solutions of Hamiltonian systems (see for example [3], Theorem 8.1, page 312).

State Dependent Symplecticity of Symmetric Methods

729

to depend on the time tn , but this is not always true. From (10) we obtain the
analogue of (15) for symmetric RK methods:
det

∂yn
∂y0

=

n−1
i=0 det
n−1
i=0 det

I + h2 JFh (yi )
I − h2 JF−h (yi )

.

(19)

It turns out that the left hand side remains indeed bounded for the dynamics of
many interesting Hamiltonian system. Such circumstance has been analysed for
two-dimensional problems in [4], and is related to a global (rather than local)
character of the solution. In the next section we report a few examples to give
numerical evidence that the same may occur in higher dimensional systems.

3

Numerical Results

Hereafter we list four problems used for our tests together with a brief description (for further details see Chap. I of [3] and reference therein). All of them have
separable Hamiltonian function in the form H(p, q) = 1/2pT p − U (q) (they come
indeed from the application of Newton’s second law), with the potential U satisfying the symmetry relation U (−q) = U (q). These conditions seem to be right
ingredients that makes the determinants in (19) O(hp )-bounded, independently
of the time tn .3
- TEST 1: Two-body Problem. The dynamics of two bodies attracted by their
gravitational forces lies in a plane and it is identiﬁed by the (normalized)
Hamiltonian function
1
1
H(p1 , p2 , q1 , q2 ) = (p21 + p22 ) − 2
1 ,
2
(q1 + q22 ) 2
where p = (p1 , p2 )T and q = (q1 , q2 )T are the velocity and position vectors
of one body in a coordinate system centred at the second body.
- TEST 2: Perturbed two-body Problem. The same as the two body-problem
with the addition of a perturbation term that accounts for non-Newtonian
interactions:
1
1
μ
H(p1 , p2 , q1 , q2 ) = (p21 + p22 ) − 2
1 −
3 ,
2
(q1 + q22 ) 2
(q12 + q22 ) 2
where |μ| is a small real number (here set equal to 10−2 ).
- TEST 3: Fermi-Pasta-Ulam Problem. In the presented form, this problem
describes the interaction of 2m mass points linked with alternating soft nonlinear and stiﬀ linear springs, in a one-dimensional lattice with ﬁxed end
points (q0 = q2m+1 = 0). The Hamiltonian function is
H(p, q) =

1
2

m

(p22i−1 + p22i ) +
i=1

ω2
4

m

m

(q2i + q2i−1 )2 +
i=1

(q2i+1 + q2i )4 .
i=0

We chose m = 3 (6 degrees of freedom) and ω = 50.
3

Some counterexamples of reversible Hamiltonian systems with U (−q) = U (q) for
which symmetric non symplectic RK-methods are not appropriate can be found in [1].

730

F. Iavernaro and B. Pace

1.05

1.002

1

1.001

1

0.95

1

0.999

0.9
0

500

1000

1500

2000

0.999
0

1.001

500

1000

1500

2000

0.998
0

1.05

1.002

1.001

1

1.001

1

1

0.999

0.95
0.9
0

500

1000

1500

2000

1.1

0.999
0

500

1000

1500

2000

1.004

1

0.998
0

500

1000

1500

2000

500

1000

1500

2000

500

1000

1500

2000

500

1000

1500

2000

50

100

150

200

50

100

150

200

1.002
1

1.002

0.9

0.998
1

0.8
0

500

1000

1500

2000

1.1

0

500

1000

1500

2000

1.004

1

0.996
0
1.002
1

1.002

0.9

0.998
1

0.8
0

500

1000

1500

2000

0

500

1000

1500

2000

0.996
0

1.5

1.05

1.05

1

1

1

0.5
0

50

100

150

200

0.95
0

50

100

150

200

0.95
0

1.5

1.05

1.05

1

1

1

0.5
0

50

100

150

200

0.95
0

50

100

150

200

0.95
0

1.005

1.01

1

1

1.005

0.8

0.995

1.2

1

0.6
0

0.1

0.2

0.3

0.4

0.5

0.99
0

0.1

0.2

0.3

0.4

0.5

0.995
0

1.005

1.01

1

1

1.005

0.8

0.995

0.1

0.2

0.3

0.4

0.5

0.1

0.2

0.3

0.4

0.5

1.2

1

0.6
0

0.1

0.2

0.3

0.4

0.5

0.99
0

0.1

0.2

0.3

0.4

0.5

0.995
0

Fig. 1. Nearby volume preservation of the trapezoidal method (ﬁrst column), Lobatto
IIIA of order 4 (second column) and Lobatto IIIB of order 4 (right column). The i-th
row displays the results for TEST i, for i = 1, . . . 4. Each ﬁgure consists of two pictures
reporting the quantity deﬁned in (19) of the methods applied with a given stepsize h
¯ = 2h (lower plot). The list of the stepsizes h is: TEST 1-2: h = 0.1;
(upper plot) and h
TEST 3: h = 0.25; TEST 4: h = 5 · 10−5 .

State Dependent Symplecticity of Symmetric Methods

731

- TEST 4: Molecular dynamics. Neutral atoms and molecules are subject to
two distinct forces, one attracting and the other repelling, in the limit of large
distance and short distance. This may be accounted for by considering pairpotentials like the Lennard-Jones potential (also known as the 6-12 potential)
which, for the atoms i and j at a distance r, reads
Vij (r) = 4εij

σij
r

12

−

σij
r

6

.

The resulting system, simulating the dynamics of a network of N particles,
has Hamiltonian
H(p, q) =

1
2

N

i=1

1 T
p pi +
mi i

N

N

Vij (||qi − qj ||).
i=1 j=i+1

In our experiment we have considered N = 7 argon atoms (mi = m =
66.34 · 10−27 Kg) lying on a plane, with six equilibrium points located at the
vertices of a regular hexagon and the remaining one at its centre, and
εij = ε

1.6540 · 10−21 J,

σij = σ = 0.341 · 10−9 m

As initial conditions, we chose null velocities and positions slightly far away
from the equilibria.
As numerical integrators we have used the LobattoIIIA and LobattoIIIB methods of order 4 and, for comparison purposes, the trapezoidal method. The
related results have been displayed in the central, right and left columns of Figure 1 respectively. They report the quantity det(∂yn /∂y0 ) deﬁned in (19) in
correspondence of two diﬀerent stepsizes in order to better infer its independence of the time integration interval. We have avoided to plot the residual
||(∂yn /∂y0 )T J(∂yn /∂y0 ) − J|| since in general it fails to remain bounded even
for the trapezoidal method and therefore it does not make sense.

References
1. E. Faou, E. Hairer and T.-L. Pham, Energy conservation with non-symplectic methods: examples and counter-examples, BIT Numerical Mathematics, 44 (2004), 699–
709.
2. E. Hairer and C. Lubich, Symmetric multistep methods over long times, Numer.
Math., 97 (2004), 699-723.
3. E. Hairer, C. Lubich, and G. Wanner, Geometric numerical integration. Structurepreserving algorithms for ordinary diﬀerential equations., Springer Series in Computational Mathematics, 31, Springer-Verlag, Berlin, 2002.
4. F. Iavernaro and D. Trigiante, State dependent symplecticity and area preserving
numerical methods, (submitted).
5. K. R. Meyer, G. R. Hall, Introduction to Hamiltonian dynamical systems and the
N -body problem, Applied Mathematical Sciences 90, Springer-Verlag, New York,
1992.

