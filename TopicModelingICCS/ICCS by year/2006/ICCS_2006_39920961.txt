A Low Complexity and Robust Frequency Oﬀset
Estimation Algorithm for OFDM-Based WLAN
Systems
Sanghun Kim1 , Seokho Yoon1 , Hyoung-Kee Choi1 , and Sun Yong Kim2
1

School of Information and Communication Engineering, Sungkyunkwan University,
300 Chunchun-dong, Jangan-gu, Suwon, Kyunggi-do, 440-746, Korea
{ksh7150, syoon, hkchoi}@ece.skku.ac.kr
2
Department of Electronics Engineering, Konkuk University,
1 Hwayang-dong, Gwangjin-gu, Seoul 143-701, Korea
kimsy@konkuk.ac.kr

Abstract. This paper addresses the frequency oﬀset estimation problem in the presence of the timing error for OFDM-based WLAN systems.
When the timing error exists, the correlation value used for the frequency
oﬀset estimation could be reduced signiﬁcantly due to the timing error,
resulting in considerable degradation in estimation performance. In this
paper, using the coherence phase bandwidth (CPB) and a threshold, a
novel frequency oﬀset estimation algorithm is proposed and based on
which, an eﬃcient timing error estimation algorithm is also proposed for
the re-estimation of the frequency oﬀset.

1

Introduction

Due to its high spectral eﬃciency and immunity to multipath fading and impulsive noise, orthogonal frequency division multiplexing (OFDM) technology
has been widely adopted as a modulation scheme in wireless local area network (WLAN) standards, such as institute of electrical and electronics engineers
(IEEE) 802.11a, high performance local area network type 2 (HiperLAN/2), and
mobile multimedia access communication (MMAC), [1]. The OFDM technology,
however, is very sensitive to frequency oﬀset caused by Doppler eﬀect and the
mismatch of the oscillators in the transmitter and receiver [2]. Therefore, exact
estimation of the frequency oﬀset is one of the important technical issues in
OFDM-based systems including WLAN [3].
Although a number of frequency oﬀset estimation algorithms have been proposed [4]-[7], most of the investigations have been discussed under the assumption of no timing error. Practically, it is very diﬃcult to determine the OFDM
symbol arrival time at the receiver prior to the frequency oﬀset estimation, because the signal-to-noise ratio (SNR) before the frequency oﬀset estimation is
This research was supported by grant No. R01-2004-000-10690-0 from the Basic
Research Program of the Korea Science & Engineering Foundation. Dr. Yoon is the
corresponding author.
V.N. Alexandrov et al. (Eds.): ICCS 2006, Part II, LNCS 3992, pp. 961–968, 2006.
c Springer-Verlag Berlin Heidelberg 2006

962

S. Kim et al.

very low. Therefore, it is not reasonable to assume that the timing error does not
exist during the frequency oﬀset estimation process. An eﬃcient frequency oﬀset
estimation algorithm that is robust to the timing error was presented by Bang
[8]. Bang’s algorithm has good performance even though a timing error exists;
however, the complexity in implementation rapidly increases as the frequency
oﬀset range increases.
In this paper, we propose a novel frequency oﬀset estimation algorithm using
the coherence phase bandwidth (CPB) and a threshold. The proposed algorithm
has similar performance to that of Bang’ algorithm in the presence of the timing
error, yet has even lower computational complexity when compared with Bang’s
algorithm. We also address the problem of estimating the timing error, using
the OFDM symbol compensated by the proposed frequency oﬀset estimation
algorithm.

2

The Eﬀect of Symbol Timing Error on Frequency
Oﬀset Estimation

An OFDM symbol is generated by the inverse fast Fourier transform (IFFT)
and expressed as, for n = 0, 1, 2, · · · , N − 1,
1
sn = √
N

N −1

Sl ej2πnl/N ,

(1)

l=0

where Sl is a phase shift keying (PSK) or quadrature amplitude modulation
(QAM) data symbol transmitted through the lth subcarrier and N is the size
of the IFFT. In the presence of the timing error, the received signal rn can be
expressed as
(2)
rn = sn−δ ej2π (n−δ)/N + wn ,
where and δ represent the frequency oﬀset and the timing error, which are
normalized to the subcarrier spacing 1/N , respectively and wn is the zero-mean
complex additive white Gaussian noise (AWGN).
To recover the data symbol, the received signal is ﬁrst demodulated using the
fast Fourier transform (FFT) operation. The kth FFT output Rk is then given
by, for k = 0, 1, 2, · · · , N − 1,
Rk = Sk− e−j2πδ(k−

)/N

+ Wk ,

(3)

where Wk is the FFT output of wn . We consider the frequency oﬀset estimation
using the preamble, as in [4]-[8]. Thus, an estimate ˆ of the frequency oﬀset
can be obtained as
N −1

ˆ = arg max
d

Zk∗ R(k+d)N

.

(4)

k=0

where Zk is the known preamble, ∗ is the complex conjugate operator, d is the
amount of cyclic shift, and (·)N is the modulo-N operator.

963

2

Correlation value (normalized to N Z k )

A Low Complexity and Robust Frequency Oﬀset Estimation Algorithm

1
0.8
0.6
0.4
0.2
0
-5

-4

-3

-2

-1

0

1

2

3

4

5

Timing error (G )

Fig. 1. The correlation value plotted as a function of timing error δ when d =
N = 1024.

When d =

(i.e., when

and

is correctly estimated), the correlation value (nor−jπδ(N −1)

2

sin(πδ)
N
malized to N |Zk | ) in (4) becomes e
sin(πδ/N ) and is plotted as a
function of the timing error δ, as shown in Fig. 1. From Fig. 1, we can clearly
observe that the correlation value used in the frequency oﬀset estimation is very
sensitive to the variation of the timing error, which implies that the correlation
value could be reduced signiﬁcantly due to the timing error even if the frequency
oﬀset is correctly estimated, resulting in considerable degradation in estimation
performance (note that a large correlation value when d = , is essential for the
detection of the correct frequency oﬀset estimate). This is the very eﬀect of the
timing error on the frequency oﬀset estimation.

3

Proposed Algorithm

In Bang’s algorithm, the correlation is performed in parallel for all possible values of d. As the spacing between the consecutive values of d becomes smaller,
therefore, the performance becomes more robust to the timing error variation;
however, the computational complexity increases rapidly. In this paper, we propose an eﬃcient algorithm that has similar performance, but less complexity for
a given value of d, when compared with Bang’s algorithm.
3.1

Frequency Oﬀset Estimation

To alleviate the eﬀect of the timing error on the frequency oﬀset estimation, we
consider the CPB within which the correlation value increases monotonically.
The CPB can be expressed as [8]
CPB =

N
,
2δ t

(5)

where δ t is a maximum tolerated value of the timing error δ. Using (4) and (5),
we can calculate the correlation value C for the frequency oﬀset estimation as

964

S. Kim et al.
K−1 CPB−1
∗
Zk+mCPB
R(k+mCPB+d)N ,

C=
m=0

(6)

k=0

where K = N/CPB.

Fig. 2. The correlation value plotted as a function of the timing error δ when d = ,
δ t = 5, and N = 1024.

Fig. 2 shows the correlation value plotted as a function of the timing error δ
when d = , δ t = 5, and N = 1024. It can be observed that the correlation value
is relatively constant under the timing error variation. In [8], the correlation value
C is calculated in parallel for all possible values of d and ˆ is chosen as the d
corresponding to the maximum correlation value. In the proposed algorithm, on
the other hand, the correlation value C is ﬁrst calculated for an initial d and then
compared with a given threshold. If the correlation value exceeds the threshold,
the d is decided to be the correct estimate of . Otherwise, the FFT output is
cyclically shifted by d and the above procedure is repeated. The operation of the
proposed algorithm is described in Fig. 3. The threshold η is obtained as follows.
From (6), correlation value α over one CPB block is
CPB−1

Zk∗ R(k+d)N .

α=

(7)

k=0

If we assume d =

and ignore AWGN,
CPB−1

α = |Zk |

e−j2πδk/N .

2

(8)

k=0

It is easy to see that α has its minimum value αmin when δ = δ t . Thus,
2

αmin = |Zk | 1 − j cot

πδ t
N

and the minimum value Cmin of C can be obtained as

(9)

A Low Complexity and Robust Frequency Oﬀset Estimation Algorithm

965

Fig. 3. Block diagram of the proposed frequency oﬀset estimation algorithm

2

Cmin = 2δ t |Zk | 1 − j cot

πδ t
N

.

(10)

Finally, the threshold η is chosen such that
2

η = Cmin /2 = δ t |Zk | 1 − j cot

πδ t
N

.

(11)

As a threshold becomes smaller, the detection probability for the correct estimate
of and the false alarm probability increase, and vice versa. Thus, the threshold
chosen as one half of Cmin is one of the reasonable choices in view of the detection
and false alarm probabilities, which decide the overall system performance.
3.2

Timing Error Estimation

The frequency oﬀset is often time varying and, thus, the re-estimation for the
frequency oﬀset is required. In that case, it would be very useful if an estimate
of the timing error is available, although the proposed algorithm is robust to the
timing error. So, we address the problem of estimating the timing error, using
the FFT output (i.e., OFDM symbol in the frequency domain) compensated by
the proposed frequency oﬀset estimation algorithm.
Assuming the frequency oﬀset is perfectly estimated, we have the kth FFT
output Rk such that
(12)
Rk = Hk Zk ej2πδk/N .
where Hk represents the frequency response of the channel. The argument Φk of
Zk∗ Rk is then given by
k
+ (Hk ) ,
(13)
N
where denotes the argument operator of a complex number. As a result, if the
channel does not change signiﬁcantly during one OFDM symbol duration, the
timing error can be estimated as follows.
Φk =

(Zk∗ Rk ) = 2πδ

N
E {Δk } ,
δˆ =
2π

for k = 1, 2, · · · , N − 1,

(14)

966

S. Kim et al.

where |Δk | = |Φk − Φk−1 | ≤ 2πδ t /N and E {·} denotes the expectation and is
taken to reduce the variance of the estimator.

4

Performance Comparison Results

In this section, the proposed frequency oﬀset estimation algorithm is compared
with Bang’s algorithm in terms of estimation accuracy and complexity in implementation. Also, the performance of the proposed timing error estimation
algorithm is presented. We consider the following parameters: N = 1024 and
2048, ∈ [0, 500], and δ t = 16. Two channel models are used: AWGN and multipath channels, the parameters of which are shown in Table 1. The time delays
and amplitude attenuations of the second, third, and fourth paths are relative to
those of the ﬁrst path. For reference, the conventional frequency oﬀset algorithm
proposed by Nogami [4], which uses the assumption of no timing error, is also
included in the comparison results.
Table 1. The channel models
Path
Time delay (sample)
Amplitude attenuation (dB)
Phase
AWGN

First
Second
Third
Fourth
0
5
10
15
0
4
8
12
Distributed uniformly over [0, 2π)
10 dB

Table 2 shows the complexity of Nogami’s, Bang’s, and the proposed algorithms. We can see from Table 2, for L
1, where L denotes the frequency
oﬀset range, the proposed algorithm has about a half computational complexity
when compared with Nogami’s and Bang’s algorithms. Another important result is that the proposed algorithm does not require any memory for correlation
value, unlike Nogami’s and Bang’s algorithms.
Table 2. Complexity comparison for Nogami’s, Bang’s, and the proposed algorithms

Algorithm

Number of
complex
multiplication

Number of
comparison
operation

Nogami’s Algorithm

LN

L−1

Size of memory
for correlation
value
L

Bang’s Algorithm

LN

L−1

L

Proposed Algorithm

L+1
N
2

L+1
2

-

Tables 3 and 4 show the frequency oﬀset estimation accuracy of Nogami’s,
Bang’s, and the proposed algorithms in AWGN and multipath channels, respectively. From the tables, it is seen that Bang’s and the proposed algorithms are quite
robust to the timing error and dramatically outperform Nogami’s algorithm.

A Low Complexity and Robust Frequency Oﬀset Estimation Algorithm

967

Table 3. Accuracy comparison of the frequency oﬀset estimation algorithms in AWGN
channel
Accuracy (%)
Timing
Number of subcarrier (N ): 1024
Number of subcarrier (N ): 2048
error
Nogami’s Bang’s Proposed Nogami’s Bang’s Proposed
(sample)
Algorithm Algorithm Algorithm Algorithm Algorithm Algorithm
0
100
100
100
100
100
100
1
0
100
100
0
100
100
2
0
100
100
0
100
100
5
0
100
100
0
100
100

Table 4. Accuracy comparison of the frequency oﬀset estimation algorithms in multipath channel
Accuracy (%)
Timing
Number of subcarrier (N ): 1024
Number of subcarrier (N ): 2048
error
Nogami’s Bang’s Proposed Nogami’s Bang’s Proposed
(sample)
Algorithm Algorithm Algorithm Algorithm Algorithm Algorithm
0
100
100
100
100
100
100
1
0
100
100
0
100
100
2
0
100
100
0
100
100
5
0
100
100
0
100
100

Fig. 4. Error variance of the proposed timing error estimation algorithm in AWGN
channel

Figs. 4 and 5 show the error variance of the proposed timing error estimation
algorithm as a function of SNR in AWGN and multipath channels, respectively.
From the ﬁgures, we can observe that the error variance decreases rapidly as the
SNR increases: speciﬁcally, the error variance becomes about 10−3 at SNR=10 dB,
which is acceptable in general wireless applications and, thus, the proposed estimator should be able to be employed for the re-estimation of the frequency oﬀset.

968

S. Kim et al.

Fig. 5. Error variance of the proposed timing error estimation algorithm in multipath
channel

5

Conclusion

We have ﬁrst investigated the eﬀect of the timing error on the frequency oﬀset
estimation in OFDM-based WLAN systems. Using the CPB and a threshold,
then, we have proposed a low complexity and robust frequency oﬀset estimation
algorithm in the presence of the timing error. Based on which, an eﬃcient timing
error estimation algorithm has also been proposed for the re-estimation of the
frequency oﬀset. The comparison results have shown that the proposed frequency
oﬀset estimation algorithm dramatically outperforms Nogami’s algorithm and
performs similarly to Bang’s algorithm in the presence of the timing error, with
about a half complexity. It has also been shown that the proposed timing error
estimator gives a reliable estimate of the timing error and, thus, should be useful
for the re-estimation of the frequency oﬀset.

References
1. N. Prasad and A. Prasad, WLAN Systems and Wireless IP for Next Generation
Communications. Boston, MA: Artech House, 2002.
2. T. Pollet and M. Peeters, ”Synchronization with DMT modulation,” IEEE Commun. Mag., vol. 37, pp. 80-86, Apr. 1999.
3. R. V. Nee and R. Prasad, OFDM for Wireless Multimedia Communications. London,
England: Artech House, 2000.
4. H. Nogami and T. Nagashima, ”A frequency and timing period acquisition technique
for OFDM systems,”in Proc.IEEE PIRMC, Toronto,Canada,pp.1010-1015,Sep.1995.
5. B. Y. Prasetyo, F. Said, and A. H. Aghvami, ”Fast burst synchronisation technique for
OFDM-WLAN systems,”IEE Proceedings: Commun.,vol.147, pp.292-298,Oct.2000.
6. J. Li, G. Liu, and G. B. Giannakis, ”Carrier frequency oﬀset estimation for OFDMbased WLANs,” IEEE Signal Process. Lett., vol. 8, pp. 80-82, Mar. 2001.
7. K. Fazel and S. Kaiser, Multi-Carrier and Spread Spectrum Systems. West Sussex,
England: John Wiley and Sons, 2003.
8. K. Bang, N. Cho, H. Jun, K. Kim, H. Park, and D. Hong, ”A coarse frequency
oﬀset estimation in an OFDM system using the concept of the coherence phase
bandwidth,” IEEE Trans. Commun., vol. 49, pp. 1320-1324, Aug. 2001.

