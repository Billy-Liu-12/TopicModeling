Computer Construction of Quasi Optimal
Portfolio for Stochastic Models with Jumps
of Financial Markets
Aleksander Janicki
Mathematical Institute, University of Wroclaw,
pl. Grunwaldzki 2–4, 50–384 Wroclaw, Poland
janicki@math.uni.wroc.pl

Abstract. In the paper we propose a purely computational new method
of construction of a quasi–optimal portfolio for stochastic models of a ﬁnancial market with jumps. Here we present the method in the framework
of a Black–Scholes–Merton model of an incomplete market (see, eg. [5],
[7]), considering a well known optimal investment and consumption problem with the HARA type optimization functional. Our method is based
on the idea to maximize this functional, taking into account only some
subsets of possible portfolio and consumption processes. We show how to
reduce the main problem to the construction of a portfolio maximizing a
deterministic function of a few real valued parameters but under purely
stochastic constraints. It is enough to solve several times an indicated
system of stochastic diﬀerential equations (SDEs) with properly chosen
parametrs. This is a generalization of an approach presented in [4] in
connection with a well known classical Black–Scholes model.
Results of computer experiments presented here were obtained with
the use of the SDE–Solver software package. This is our own professional
C++ application to Windows system, designed as a scientiﬁc computing
tool based on Monte Carlo simulations and serving for numerical and
statistical construction of solutions to a wide class of systems of SDEs,
including a broad class of diﬀusions with jumps driven by non-Gaussian
random measures (consult [1], [4], [6], [9]).
The approach to construction of approximate optimal portfolio presented here should be useful in a stock market analysis, eg. for evolution
based computer methods.

1

Optimal Investment and Consumption Problem for
Stochastic Models with Jumps of Financial Markets

Let us recall that the Black–Scholes–Merton model of a ﬁnancial market can be
understood as a spacial case of the following system of N + 1 SDEs
t

S0 (t) = S0 (0) +

r(s)S0 (s)ds,
0
N

t

Sn (t) = Sn (0) +

t

μn (s)Sn (s)ds +
0

σn,k (s)Sn (s)dBk (s)
k=1

0

V.N. Alexandrov et al. (Eds.): ICCS 2006, Part IV, LNCS 3994, pp. 301–307, 2006.
c Springer-Verlag Berlin Heidelberg 2006

302

A. Janicki
t

ρn (s)Sn (s)dN λ (s),

+
0

for n = 1, . . . , N and t ∈ (0, T ], and where we have the money market with a
price S0 (t) and N stocks with prices-per-share S1 (t), . . . , SN (t), for t ∈ [0, T ].
We assume that processes r = r(t), and μn = μn (t), for 1 ≤ n ≤ N , are L1 (Ω×
[0, T ])–integrable, and processes σn,k = σn,k (t) and ρn = ρn (t) are L2 (Ω×[0, T ])–
integrable on the probability space (Ω, F , {Ft }, P) with a ﬁltration {Ft }, which
is generated by N –dimensional Brownian motion process (B1 (t), . . . , BN (t)) and
a compensated Poisson process N λ (t).
Let the stochastic processes η0 = η0 (t) and ηn = ηn (t), for n = 1, 2, ..., N ,
denote the number of shares of a bond and stocks, respectively. So, the value of
the investor’s holdings at time t is represented by the wealth process, which can
be represented by
N
df

X(t) =

N

ηn (t)Sn (t) =
n=0

where

df

πn (t) = ηn (t)Sn (t),

πn (t),

(1)

n=0

n = 0, 1, . . . , N.

Let π(t) = (π1 (t), . . . , πN (t)). We say that the process
(π0 , π) = {(π0 (t), π(t)) : t ∈ [0, T ]}
is the portfolio process or simply portfolio of an investor.
We deﬁne the gains process {G(t) : t ∈ [0, T ]} as a process which satisﬁes the
following equation,
N

dG(t) =

N

ηn (t)dSn (t) +
n=0

Sn (t)δn (t)dt,

(2)

n=1

where δn = δn (t) is the so called divident rate payment process of the nth stock,
for all 0 < n ≤ N . By the consumption process we understand here any nonnegative, regular enough stochastic process c = {c(t) : t ∈ [0, T ]}. Let x > 0
denote the initial wealth (or endowment, i.e. an amount of money an ivestor
has to his disposal at time t = 0), what means that we have X(0) = x. Let
df
t
Γ (t) = x − 0 c(s)dt. We say that the portfolio (π0 , π) is Γ –ﬁnanced, when
N

πn (t) = Γ (t) + G(t),

(3)

n=0

with G(0) = 0, Γ (0) = x.
Applying the general semimartingale version of Itˆ
o formula one can check that
if conditions (2) and (3) are satisﬁed, then the wealth process
X ≡ X x,c,π = {X x,c,π (t) : t ∈ [0, T ]},
deﬁned by (1), can be obtained as a solution to the following SDE

Computer Construction of Quasi Optimal Portfolio

303

N

dX(t) = (rX(t) − c(t))dt +

(μn (t) + δn (t) − r)πn (t)dt +
n=1

N

N

+

σn,m (t)dBm (t) + ρn (t)dN λ (t) ,

πn (t)
n=1

(4)

m=1
N

with an initial condition of the form X(0) = x = n=0 ηn (0)Sn (0).
From (2) and (3), after application of the classical Itˆ
o formula, it follows that
the following – very important in our approach – equation must be satisﬁed
N

N

Sn (t)δn (t)dt − c(t)dt.

Sn (t)dηn (t) =
n=0

(5)

n=1

In optimization problems utility functions can be chosen in many diﬀerent
ways, however the typical choice for scientiﬁc investigations is the HARA model,
what means that we chose utility function given by
df

U (p) (x) = xp /p,

x > 0,

(6)

for p ∈ (−∞, 0) or p ∈ (0, 1).
The risk aversion coeﬃcient is then deﬁned by the formula
df

R = −x

d2 (p)
U (x)
dx2

d (p)
U (x) = 1 − p.
dx

(7)

Here we are interested in the following optimization problem.
For a given utility function U (p) = U (p) (c) and initial wealth x > 0, we look
for an optimal portfolio π(t) = {π1 (t), . . . , πN (t)} and an optimal consumption
process c = c(t), such that for the value function of the form
T

df

Vc,π (x) = E

U (p) (c(t))e−

t
0

β(s)ds

dt

(8)

0

the following condition is satisﬁed
Vcˆ,ˆπ (x) =

sup

Vc,π (x).

(9)

(c,π)∈A(x)

Here the condition (c, π) ∈ A(x) means, that the processes c = c(t) and π = π(t)
are subject to the stochastic constraints, what means that c = c(t) is positive
on [0, T ] and the corresponding wealth process satisﬁng SDE (4) is such that
X x,c,π (t) ≥ 0 a.s.

2

for t ∈ [0, T ].

(10)

An Example of a Quasi–optimal Portfolio

An attempt to answer the question how to apply computational methods to solve
directly and eﬀectively optimizations problem (9) through analytical methods,

304

A. Janicki

e.g. making use of the Malliavin calculus (see [3], [8]) or trying to get a hedging
strategy by constructing a relevant replicating portfolio (see eg. [5], etc.) is not
an obvious task in our framework (see eg. [7]).
So, our aim is to describe a method of computer construction of a quasi–
optimal portfolio solving approximate problem related to (9).
The method is based on the idea to maximize functional (8), taking into
account only some subsets of possible portfolio processes derived from equations
(4) and (5), and chosing the class of admissible positive consumption processes
arbitrally, in a convenient reasonable way.
We show how to reduce the main problem to the construction of a portfolio
maximizing a deterministic function of a few real valued parameters but under
purely stochastic constraints.
In order to make the further exposition easier, we restrict ourselves to the one
dimensional (N = 1) Black–Scholes–Merton model, which can be described in
the following form
t

S0 (t) = S0 (0) + r

S0 (s)ds

(11)

0
t

S1 (t) = S1 (0) + μ

t

S1 (s)ds + σ
0

t

Sn (s−)dN λ (s), (12)

S1 (s)dB(s) + ρ
0

0

for t ∈ [0, T ], and initial conditions such that S0 (0) > 0, S1 (0) > 0.
In the model (11)–(12) all paremeters, i.e. S0 (0), S1 (0), r, μ, σ, and ρ are
given positive real numbers. So, the processes S0 , S1 can be described in the
explicit closed form:
S0 (t) = S0 (0) ert ,
S1 (t) = S1 (0) e

(13)

{(μ−σ2 /2)t+σB(t)+log(1+ρ)N λ (t)}

.

(14)

Our quasi–optimal portfolio is now given by π = (π0 , π1 ), where
π0 (t) = η0 (t)S0 (t),

π1 (t) = η1 (t)S1 (t),

t ∈ [0, T ].

(15)

In the example we have chosen for computer experiments presented here we
reduced the class of admissible portolio process to those which are of the following
form
η1 (t) = p1 S1 (t), t ∈ [0, T ].
(16)
We also restric ourselves to the class of consumption processes deﬁned by
c(t) = c0 S0 (t) + c1 S1 (t),

t ∈ [0, T ],

(17)

In (16) and (17) parameters p1 , c0 , c1 are deterministic (real) variables, subject
to some stochastic constraints, and which should be determined in an optimal
way.
It is not diﬃcult to notice that in such circumstances the wealth process
X(t) = X c0 ,c1 ,p1 (t), deﬁned by (4), solves the following Itˆo SDE
dX(t) = rX(t) + (μ + δ − r)η(t)S1 (t) − c0 S0 (t) + c1 S1 (t)

dt

(18)

+ση1 (t)S1 (t)dB(t) + ρ ∗ η1 (t)S1 (t−)dN λ (t), t ∈ (0, T ], X(0) = x.

Computer Construction of Quasi Optimal Portfolio

305

Making use of the equation (5), it is also possible to check that the ﬁrst
component of the portfolio, i.e. the proces η0 = η0 (t) solves the following SDE
dη0 (t) = (−μ + δ)p1 S12 (t) − c0 S0 (t) + c1 S1 (t)

/S0 (t)dt −

−p1 σS12 (t)/S0 (t)dB(t) − p1 σS12 (t)/S0 (t)dN λ (t), t ∈ (0, T ], (19)
η(0) = (x − p1 S12 (0))/S0 (0).
In this way we arrive at the following problem.
For a given utility function U (p) = U (p) (c) and initial wealth x > 0, we look
for optimal values of parameters c0 , c1 , p1 , such that for the value function of
the form
T

df

Vc0 ,c1 ,p1 (x) = E

U (p) (c0 S0 (t) + c1 S1 (t))e−βt dt

(20)

0

the following condition is satisﬁed
Vc0 ,c1 p1 (x) =

sup

Vc0 ,c1 ,p1 (x).

(21)

(c0 ,c1 ,p1 )∈A(x)

Now the condition (c0 , c1 , p1 ) ∈ A(x) means, that the consumption and wealth
processes, deﬁned by (17) and (18), are such that we have
X c0 ,c1 ,p1 (t) ≥ 0 a.s.,

c0 S0 (t) + c1 S1 (t) ≥ 0 a.s. for t ∈ [0, T ].

(22)

We see that, having to our disposal stochastic processes solving SDEs (11),
(12), and (18), we are able to solve the problem (20)–(22). In order to get values
of the value function (20) using the SDE–Solver software it is enough to solve
the system of two equations
dY (t) = c0 rS0 (t) + c1 μS1 (t) dt + c1 σ1 S1 (t) dB(t),
dZ(t) = U

(p)

βt

(Y (t))e dt,

(23)
(24)

for t ∈ (0, T ], and with initial conditions Y (0) = c0 S0 (0) + c1 S1 (0), Y (0) = 0,
and ﬁnally to compute
(25)
Vc0 ,c1 ,p1 (x) = E Z(T ).
Then, making use of formulae (19), (16), (15), and (17), one can easily construct quasi optimal portfolio and quasi optimal consumption processes.

3

Results of Computer Experiments

We solved the optimization problem desribed by formulae (11)–(22), with the
following ﬁxed values of constant parameters: T = 1, r = 0.2, μ = 0.15,
δ = 0.05, σ = 0.35, ρ = 0.35, β = 0, and also with β ∈ {0, 0.1, 0.2, 0.4, 0.8},
x = 50, S00 = 50, S10 = 50.
The optimal solution for β = 0.0 is of the following form:
c0 = 1.0,

c1 = 0.00,

p1 = 0.0,

Vc0 ,c1 ,cp1 = 16.3.

306

A. Janicki

From a large amount of data obtained in our experiments we present here
only the optimal solution for β = 0.
In Table 1 below some values of function Vc0 ,c1 ,p1 are presented with corresponding values of parameters c0 , c1 , p1 .
Table 1. Values of Vc0 ,c1 ,p1 from (20)
Vc0 ,c1 ,p1 (x)

c0

c1

p1

β

16.3

1.00

0.00

0.00

0.00

12.6

0.30

0.00

0.00

13.8

0.80

0.30
−0.10

0.01

0.00

12.6

0.30

0.30

0.01

0.00

12.4

0.30

0.30

0.02

0.00

14.6

1.00

0.00

0.00

0.20

12.9

0.40

0.01

0.20

12.4

0.80

0.40
−0.10

0.01

0.20

11.3

0.30

0.30

0.02

0.20

13.3

1.00

0.40

0.80

0.00
−0.05

0.00

11.8

0.01

0.40

10.3

0.30

0.30

0.02

0.40

11.1

1.00

0.00

0.00

0.80

8.6

0.30

0.30

0.02

0.80

In all runs of the system of equations (11), (12), (18), (23), (24) leading to
computation of values of the expression in (25) with the SDE–Solver, we had
1000 trajectories of the solution, which were constructed on the grid given by
1000 subintervals of lenght 0.001 of the interval [0, 1]. Numerical and statistical
approximation methods involved are described in [1], [2], [4], [6].
Another example (simplier one, with value function depending only on two
parameters) of a quasi optimal portfolio and quasi optimal consumption processes that can be generalized in the same way as in our example presented
here is discussed in [1]. Instead of (16), (17), and (20), the following conditions
describe the optimization problem:
η0 (t) = p0 S0 (t),
T

df

Vc2 ,p0 (x) = E

c(t) = c2 X(t),

U (p) (c2 X(t))e−βt dt .

0

Graphical representations, visualizing trajectories and some statistical properties of quasi optimal processes η0 = η0 (t), η1 = η1 (t), X = X(t), and c = c(t),
are included there.

Computer Construction of Quasi Optimal Portfolio

4

307

Conclusions

We strongly insist that even such rough approximations of the optimal investment and consumption problem as presented here are of important practical
interest. One can get quite useful ideas about properties of stochastic processes
solving the problem, how they depend on parameters of the stochastic model of
ﬁnancial market, investor preferences, etc. Of course, much more work on improvement of suggested method of construction of quasi optimal portfolio has to
be done. It is also quite obvious that the method can be easily extended onto
much more soﬁsticated stochastic models of ﬁnancial market. There are various
questions of mathematical nature, that should be answered in the future, e.g.
on the correctness and convergence of the proposed approximate method, when
more and more parameters enlargig properly the sets of admissible portfolio and
consumption processes, are included.
Our computer experiments indicate to some extent the direction of further
development of computational methods and computer software useful in practical solution of such complicated problems as construction of optimal strategies
for investors, when stochastic model of the ﬁnancial market is investigated in
the framework of a system of SDEs of Itˆo or another, more general, type. For
example, our approach can be in a very simple and natural way implemented
for parallel computing systems.

References
1. Janicki, A., Izydorczyk, A.: Computer Methods in Stochastic Modeling (in Polish).
Wydawnictwa Naukowo-Techniczne, Warszawa, (2001)
2. Janicki, A., Izydorczyk, A., Gradalski, P.: Computer Simulation of Stochastic Models with SDE–Solver Software Package. in Computational Science – ICCS 2003,
Lecture Notes in Computer Science vol. 2657 (2003) 361–370
3. Janicki, A., Krajna, L.: Malliavin Calculus in Construction of Hedging Portfolios
for the Heston Model of a Financial Market. Demonstratio Mathematica XXXIV
(2001) 483–495
4. Janicki, A., Zwierz, K.: Construction of Quasi Optimal Portfolio for Stochastic Models of Financial Market, in Computational Science – ICCS 2004, Lecture Notes in
Computer Science vol. 3039 (2004) 811–818
5. Karatzas I., Shreve, S.E.: Methods of Mathematical Finance. Springer-Verlag,
Berlin, (1998)
6. Kloeden, P.E., Platen, E.: Numerical Solution of Stochastic Diﬀerential Equations,
3rd ed. Springer-Verlag, New York, (1998)
7. Le´
on, J.A., Sol´e, J.L., Utzet F., Vives J.: On L´evy processes, Malliavin calculus,
and market models with jumps. Finance and Stochastics 6 (2002), 197–225
8. Ocone, D.L., Karatzas, I.: A generalized Clark representation formula, with application to optimal portfolios. Stochastics and Stochastics Reports 34 (1991), 187–220
9. Protter, P.: Stochastic Integration and Diﬀerential Equations – A New Approach.
Springer-Verlag, New York, (2002)

