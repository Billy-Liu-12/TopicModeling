Procedia
Computer
Science 

Available online at www.sciencedirect.com


ProcediaComputerScience00(2009)000‚Äì000

Procedia Computer Science 1 (2012) 1311‚Äì1320

www.elsevier.com/locate/procedia

www.elsevier.com/locate/procedia

International Conference on Computational Science

Multi-Fidelity Design Optimization of Transonic Airfoils Using
Shape-Preserving Response Prediction
Leifur Leifssona*, Slawomir Koziela
a

Engineering Optimization & Modeling Center, School of Science and Engineering, Reykjavik University, Menntavegur 1, 101 Reykjavik, Iceland

Abstract
A computationally efficient methodology for transonic airfoil design optimization is presented. Our approach exploits a corrected
physics-based low-fidelity surrogate that replaces, in the optimization process, an accurate but computationally expensive highfidelity airfoil model. Correction of the low-fidelity model is achieved by aligning its corresponding airfoil surface pressure
distributions with that of the high-fidelity model using a shape-preserving response prediction technique. The presented method is
applied to airfoil lift maximization in two-dimensional inviscid transonic flow, subject to constraints on shock induced pressure drag
and airfoil cross-sectional area. More than a 90% reduction in high-fidelity function calls is achieved when compared to direct highfidelity model optimization.
c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
‚Éù
Keywords: Aerodynamics; airfoil shape optimization; surrogate models; design optimization.

1. Introduction
Aerodynamic and hydrodynamic design and optimization is of primary importance in several disciplines. In the
design of turbines, such as gas, steam, or wind turbines, the blades are designed to maximize energy output for a given
working fluid and operating conditions [1]. The shape of ship hull forms is optimized for minimum drag [2]. In aircraft
design, for both conventional transport aircraft and unmanned air vehicles, the aerodynamic wing shape is designed to
provide maximum efficiency under a variety of takeoff, cruise, maneuver, loiter, and landing conditions [3].
Constraints on aerodynamic noise are also becoming increasingly important [4]. The fundamental design problem,
common to all these disciplines, is to design a wing shape that provides the desired lift for given operating conditions,
while at the same time fulfilling the design constraints. However, design optimization normally requires a large number
of analyses of objectives and constraints [5]. Therefore, a careful selection of computational methods, both for the fluid
flow analysis and the optimization process, is essential for a fast and efficient design process.
Hicks et al. [6] began exploring the use of numerical optimization techniques for the design of aircraft
components in the mid 1970s. These early studies focused primarily on airfoil and wing design at both subsonic and
transonic conditions using low-fidelity flow analysis models and gradient-based optimization methods. Jameson [7]
introduced control theory to optimal aerodynamic design. This method uses continuous adjoint methods to derive
* Corresponding author. Tel.: +354-599-6379 ; fax: +354-599-6489; E-mail address: leifurth@ru.is

c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
1877-0509 ‚Éù
doi:10.1016/j.procs.2010.04.146

1312

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

the gradient of a cost function with respect to the shape, and then approach the optimum using a gradient-based
optimization method. Jameson and Reuther examined transonic airfoil design problems using both the full potential
equation [8] and the compressible Euler equations [9]. Later, Jameson et al. extended the method to incorporate
viscous effects using the Navier-Stokes equations, examining both two-dimensional high-lift airfoil design [10] and
three-dimensional wing design [11]. Normally there is some uncertainty of the exact operating conditions, such as
the Mach number and angle of attack, therefore, much research has been on optimizing aerodynamic shapes with
respect to several operating conditions [12].
The aforementioned methods directly employ the computational code in the optimization loop. In the past decade or
so, the drive had been towards including higher-fidelity analyses in the design process. As a result, design optimization,
which requires large numbers of model evaluations, becomes prohibitively expensive. Surrogate-based optimization
(SBO) methods use computationally cheap surrogate functions in lieu of the computationally more expensive highfidelity models [13]. The overall objective of using SBO methods is to reduce the number of evaluations of the highfidelity models, and thereby making the optimization process more efficient. The surrogates can be created by
approximating the high-fidelity model data using, e.g., polynomial regression or kriging [13]. Another way of
developing the surrogates is by using low-fidelity models, which are a less accurate but computationally cheap
representations of the high-fidelity models [14] (multi- or variable-fidelity design).
Robinson et al. [15] presented a provably convergent trust-region model-management (TRMM) methodology for
variable-parameterization design models. This is an SBO method which uses a lower-fidelity model as a surrogate
and the low-fidelity design space has a lower dimension than the high-fidelity design space. The mathematical
relationship between the design vectors is described by a mapping method, called space-mapping [16-19]. Since
space mapping does not provide provable convergence within a TRMM framework, but any surrogate that is firstorder accurate does, they correct the space-mapping to be at least first-order, called corrected space-mapping.
In summary, high-fidelity aerodynamic simulation is reliable but computationally far too expensive to be used in
a direct, simulation-based design optimization, especially when using traditional, gradient-based techniques. There
is a need to develop methodologies that would allow rapid design optimization with limited number of CPUintensive objective function evaluations. SBO techniques currently used in aerospace engineering are either
exploiting functional surrogate models (that require substantial computational effort to be set up), or adopt
approaches such as classical space mapping (which does not guarantee sufficient alignment between the low- and
high-fidelity models and requires enforced first-order consistency that required sensitivity data from the highfidelity model). In either case, overall computational cost of the optimization process is still high. Development of a
truly efficient SBO approach that would take full advantage of the low-fidelity model speed and high-fidelity model
accuracy is still an open problem.
Here, a computationally efficient design methodology is introduced that exploits surrogates constructed using
low-fidelity flow analysis models and shape-preserving response prediction technique [20]. We demonstrate that our
approach allows a rapid design improvement of airfoils at a very low computational cost corresponding to a few
evaluations of the high-fidelity model. Several examples of airfoil design at transonic flow conditions are provided.
2. Airfoil aerodynamics
A wing surface is defined by airfoil profiles located at several span stations, Figure 1(a). The airfoil profile is a
streamlined surface of chord length c, as shown in Figure 1(b). The airfoil has a thickness t, which is a function of k
(on the x-axis), and the ratio t/c refers to the maximum thickness of the airfoil divided by its chord. The curvature of
the airfoil is called camber, and the mean camberline is the curve equidistant from the upper and lower surfaces. A
few examples of airfoils parameterized according to so-called NACA convention [21] are shown in Figure 2.
Transonic flow is characterized by regions of locally subsonic (Mach < 0.8) and supersonic (Mach > 1.2) flow that
occurs over a body which is moving at Mach numbers near unity [22]. Assuming an inviscid, adiabatic flow with no body
forces, the Euler equations are the most accurate description of the fluid flow. The Euler equations are a set of coupled,
non-linear partial differential equations that represent the conservation of mass, momentum and energy, i.e.,
wU
 ¬í ¬ò UV  0 ,
wt

U

DV
Dt

¬íp ,

U

Dh0
Dt

wp
wt

(1)

1313

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

where U is density, V is velocity vector, p is pressure, and h0 is stagnation enthalpy. These equations hold, in the absence
of separation and other strong viscous effects, for any shape of the body, thick or thin, and at any angle of attack.
Shock waves appear in transonic flow where the flow goes from being supersonic to subsonic. Across the shock
there is almost a discontinuous increase in pressure, temperature, density, and entropy, but a decrease in Mach
number (from supersonic to subsonic). The shock is termed weak if the change in pressure is small, and strong if the
change in pressure is large. The entropy change is third order in terms of shock strength. If the shocks are weak, the
entropy change across shocks is small, and the flow can be assumed to be isentropic. This in turn allows for the
assumption of irrotational flow, i.e., ¬íu V = 0. Then a velocity potential, ) = )(x,y,z), can be defined such that V =
¬í), and the governing Euler equations cascade to a single non-linear partial differential equation, called the full
potential equation (FPE) [22],
¬ß )2 ¬∑
2) x) y
2) y ) z
¬ß ) 2x ¬∑
¬ß )2 ¬∑
2) x) z
¬®¬®1  2 ¬∏¬∏) xx  ¬®1  2y ¬∏) yy  ¬®¬®1  2z ¬∏¬∏) zz 
) xy 
) xz 
) yz
2
2
¬®
¬∏
a ¬π
a ¬π
a ¬π
a
a
a2
¬©
¬©
¬©

0

(2)

where a is the speed of sound. This equation is non-linear partial differential equation that holds for irrotational,
isentropic flow past a body, thick or thin, and at any angle of attack. It is, however, an approximation to the Euler
equations and does not hold when the shocks in the flow cannot be considered weak.
In the case of a slender body at small angle of attack, we can make the assumption of small perturbations and
define the velocity potential to be ) = Vf x + I, where I is the perturbation velocity potential and Vf is free-stream
velocity. Then equation (2) becomes the transonic small-disturbance equation (TSDE) [22],

1  M I
2
f

xx

¬™
I ¬∫
M f2 ¬´J  1 x ¬ªIxx ,
Vf ¬º
¬¨

 I yy  Izz

(3)

where Mf = Vf / af is the free-stream Mach number and J is the specific heat ratio.
1

w

2

3
/

z
k

4

L

Mean camber line
t

D
D
k

b/2

Vf

(a)

M
c
(b)

Fig. 1. (a) A schematic showing a wing planform of span b and quarter chord sweep angle /. Other parameters (not shown) of the wing are, e.g.,
taper ratio (ratio of tip chord to root chord) and twist distribution. At each spanstation (numbered 1 through 4) the wing is defined by an airfoil
section with a straight line wrap between the stations. (b) Shown is a typical airfoil (NACA 2412) of chord length c, with thickness t = t(k), and a
mean camberline, in a free-stream with speed Vf at an angle of attack D. The flow generates a lift force L, a drag force D, and pitching moment M
acting at the center of pressure.

0012

4408

4608

Fig. 2. Typical NACA four digit airfoils. A four-digit NACA airfoil is the simplest version and is defined by only three parameters m, p and t/c, where
m is the maximum ordinate of the mean camber line as a fraction of chord, and p is the chordwise position of maximum ordinate. Airfoils are denoted
by NACA mpxx, where xx is the thickness to chord ratio, t/c. The left most one is symmetrical with no camber (m = 0), the location is irrelevant (p =
0), and 12% thickness (t/c = 0.12). The middle one has 4% maximum camber (m = 0.04), located at 40% of the chord (p = 0.4), and 8% thickness (t/c
= 0.12). The right most one has the same camber and thickness, but the maximum camber is located at 60% of the chord (p = 0.6).

1314

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

These three different set of equations, i.e., the Euler equations, FPE, and TSDE, represent a hierarchy of models
for the analysis of inviscid, transonic flow past airfoils. The Euler equations are exact, while FPE is an
approximation (weak shocks) to those equations, and TSDE is a further approximation (thin airfoils at small angle of
attack). The TSDE can be solved with a finite differencing scheme on a rectangular grid, without considering
specifically the airfoil surface. Solving the FPE requires a more complicated grid that accounts for the body surface
boundary condition. The Euler equations are even more complex since they require a time-marching solution
method. The Euler equations can then be considered as a high-fidelity model (high accuracy and computationally
heavy), and FPE and TSDE as low-fidelity models (reduced accuracy and computationally cheap).
The flow past NACA 0012 at Mf = 0.75 is analyzed in Figure 3. Pressure coefficient (Cp) and Mach number (M)
contours at D = 2¬∞, calculated using the Euler equations with FLUENT [23], are shown in Figures 3(a) and (b),
respectively. The pressure coefficient is defined as
Cp

p  pf
1 / 2 U fVf2

(4)

where p is pressure in the flow-field and pf is the free-stream pressure. The pressure coefficient on the surface of the
airfoil as a function of chordwise position is shown in Figure 3(c) for the Euler equations with FLUENT (highfidelity model) and the TSDE with TSFOIL [24] (low-fidelity model). The sharp drop in pressure around the mid
chord is due to a shock on the upper surface, which is relatively strong in this case. Notice that TSDE predicts the
shock to be stronger and located more aft. Nondimensional coefficients of lift (Cl) and wave drag (Cdw) are shown as
a function of angle of attack in Figure 3(d). The section lift coefficient and wave drag coefficient are calculated from
Cl

C x sin D  C z cos D

C dw

C x cos D  C z sin D

(5)

Here, the force coefficients Cx and Cz are calculated by integrating the pressure counterclockwise around the surface
of the airfoil as

(a)

(b)

-1.5

1
Cl

TSFOIL
FLUENT

-1

Cp

-0.5

0
-1
-3
0.1

0

TSFOIL
FLUENT

-2

-1

-2

-1

0

1

2

3

0
1
D [deg]

2

3

Cdw

0.5
1
1.5
0

0.2

0.4

k/c

0.6

0.8

1

0.05
0
-3

(c)
(d)
Fig. 3. (a) Pressure coefficient (Cp) contours of the flow past NACA 0012 at Mf = 0.75 and D = 2¬∞ calculated with the Euler equations using
FLUENT [23] (high-fidelity model). (b) Mach number (M) contours of the same airfoil, same conditions and same equations as in (a). (c)
Pressure coefficient on the surface of the airfoil calculated with the Euler equations using FLUENT (high-fidelity model) and the transonic smalldisturbance equation using TSFOIL [24] (low-fidelity model). The scale on the y-axis is reversed since the pressure coefficient is negative on the
upper surface. (d) Nondimensional coefficients of lift (Cl) and wave drag (Cdw) as a function of angle of attack at Mf = 0.75.

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320

1315

Author name / Procedia Computer Science 00 (2009) 000‚Äì000

Cx

¬≥C

p

sin T ds

Cz

 ¬≥ C p cos T ds

(6)

where ds is the panel length on the surface of the airfoil and T is the angle the panel makes with the x-axis. We see
that the lift changes linearly with angle of attack and the wave drag changes quadratically with angle of attack. Note
that the low-fidelity model diverges from the high-fidelity model as the angle of attack increases or decreases.
In general, the objective of aerodynamic shape optimization is to, for a given operating condition, design an
airfoil shape that maximizes lift (or minimizes drag, or maximizes lift-to-drag ratio), subject to several constraints,
such as a limit on maximum drag (or a limit on minimum lift), maximum pitching moment, minimum pressure, and
minimum cross-sectional area [5].
3. Optimization methodology
The main focus of this work is to perform aerodynamic shape optimization in a computationally efficient way.
The high-fidelity model f is computationally expensive, so it is desirable to reduce the number of evaluations of f as
much as possible. The method presented here follows the general principles of surrogate-based optimization (SBO)
[13], where the optimization burden is shifted to the low-cost surrogate model s, whereas the high-fidelity model is
referenced occasionally for verification purposes and to obtain data necessary to update the surrogate. From now on
x will denote a vector of design variables (parameterization of the airfoil shape).
3.1. General Considerations
A surrogate model can be build using approximation techniques such as low-order polynomials, radial-basis
functions or kriging [25]. These popular approaches require, however, considerable amount of training data to build
a good surrogate model. Here, we build a surrogate model using a physics-based low-fidelity model c.
The low-fidelity model has to be corrected in order to become a reliable representation of the high-fidelity one. The
problem is that the figures of interest in an aerodynamic analysis (lift, drag, pitching-moment, cross-sectional area, etc.)
are scalars, which results in non-uniqueness of any alignment procedure that could be applied in order to match the
low-fidelity model with the high-fidelity one at any given design. Here, the model alignment is performed using
intermediate simulation results, more specifically, the pressure distribution, whose dimensionality can be made as large
as necessary by selecting sufficient number of control points along the airfoil chord. As the objectives and constraints
are uniquely determined by the pressure distribution (for an inviscid flow analysis), alignment of corresponding
distributions for the low- and high-fidelity models will results in (unique) alignment of the figures of interest.
One of the popular SBO methods exploiting physics-based surrogates is space mapping (SM) [16], [18]. SM
surrogate is a composition of the low-fidelity model and simple, usually linear transformations that re-shape the model
domain (input-like SM [16]), correct the model response (output-like SM [18]) or change the overall model properties
(implicit-like SM [18]). SM is able to yield a satisfactory design after a few evaluations of the high-fidelity model but
its performance depends on the proper selection of the SM transformations and their parameters. Also, simple SM
transformations are not able to ensure good alignment of the high- and low-fidelity models in our case.
Another generic SBO approach is approximation and model management (AMMO) [14]. AMMO is based on
ensuring zero- and first-order consistency conditions between the high-fidelity model and the surrogate (i.e.,
agreement between the function values and first-order derivatives at the current iteration point) by using a suitable
correction term [14]. Unfortunately, AMMO requires high-fidelity model sensitivity. Therefore, it can be efficient if
the derivatives can be computed cheaply, e.g., using adjoint methods.
3.2. Surrogate Model Based on Shape-Preserving Response Prediction
Here, we adopt a shape-preserving response correction (SPRP) methodology introduced in [20] in the context of
microwave engineering. SPRP is easy to implement, unlike space mapping it does not need any auxiliary
transformations or extractable parameters [20]. Also, it does not require high-fidelity model derivative information.
As mentioned before, the surrogate model is constructed based on the pressure distribution Cp rather than directly
on the figures of interest such as lift (Cl) or wave drag (Cdw). The reason is that these figures are not uniquely
determined by the design variable vector x. The pressure distribution, on the other hand, is uniquely determined by

1316

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

x, and uniquely determines lift and drag at the same time. The pressure distribution for the high- and low-fidelity
models will be denoted as Cp.f and Cp.c, respectively.
The surrogate model is constructed assuming that the change of Cp.f due to the adjustment of the design variables
x can be predicted using the actual changes of Cp.c. The change of Cp.c is described by the translation vectors
corresponding to certain (finite) number of its characteristic points. These translation vectors are subsequently used
to predict the change of Cp.f, whereas the actual Cp.f at the current design, Cp.f(x(i)), is treated as a reference.
Figure 4(a) shows the pressure distribution Cp.c of the low-fidelity model at x(i) = [0.02 0.4 0.12]T (NACA 2412
airfoil) for Mf = 0.7 and D = 1 deg, as well as Cp.c at x = [0.025 0.56 0.122]T; x(i) will denote a current design (at the
ith iteration of the optimization algorithm; the initial design will be denoted as x(0) accordingly). Circles denote
characteristic points of Cp.c(x(i)), here, representing, among others, k/c equal to 0 and 1 (leading and trailing airfoil
edges, respectively), the maxima of Cp.c for the lower and upper airfoil surfaces, as well as the local minimum of Cp.c
for the upper surface. The last two points are useful to locate the pressure shock. Squares denote corresponding
characteristic points for Cp.c(x), while small line segments represent the translation vectors that determine the ‚Äúshift‚Äù
of the characteristic points of Cp.c when changing the design variables from x(i) to x.
In order to obtain a reliable prediction, the number of characteristic points has to be larger than illustrated in Figure
4(a). Additional points are inserted in between initial points either uniformly with respect to k/c (for those parts of the
pressure distribution that are almost flat) or based on the relative pressure value with respect to corresponding initial
points (for those parts of the pressure distribution that are ‚Äústeep‚Äù). Figure 4(b) shows the full set of characteristic
points (initial points are distinguished using larger markers).
The pressure distribution of the high-fidelity model at the given design, here, x, can be predicted using the
translation vectors applied to the corresponding characteristic points of the pressure distribution of the high-fidelity
model at x(i), Cp.f(x(i)). This is illustrated in Figure 5(a) where only initial characteristic points and translation vectors are
shown for clarity. Figure 5(b) shows the predicted pressure distribution of the high-fidelity model at x as well as the
actual Cp.f(x). The agreement between both curves is very good.
1.5

1

1

0.5

0.5
-Cp

-Cp

1.5

0
-0.5

-0.5

-1
0

0

-1
0.2

0.4

0.6

0.8

1

0

0.2

0.4

k/c

0.6

0.8

1

k/c

1.5

1.5

1

1

0.5

0.5
-Cp

-Cp

(a)
(b)
Fig. 4. (a) Example low-fidelity model pressure distribution at the design x(i), Cp.c(x(i)) (solid line), the low-fidelity model pressure distribution at other
(i)
design x, Cp.c(x) (dotted line), characteristic points of Cp.c(x ) (circles) and Cp.c(x) (squares), and the translation vectors (short lines); (b) low-fidelity
model pressure distributions, initial characteristic points (large markers) and translation vectors from Fig. 1(a) as well as additional points (small
markers) inserted in between the initial points either uniformly with respect to x/c (for those parts of the pressure distribution that are almost flat) or
based on the relative pressure value with respect to corresponding initial points (for those parts of the pressure distribution that are ‚Äústeep‚Äù).

0
-0.5
-1
0

0
-0.5
-1

0.2

0.4

0.6
k/c

0.8

1

0

0.2

0.4

0.6

0.8

1

k/c

(a)
(b)
Fig. 5. (a) High-fidelity model pressure distribution at x(i), Cp.f(x(i)) (solid line) and the predicted high-fidelity model Cp at x (dotted line) obtained
(i)
using SPRP based on characteristic points of Fig. 4(b); characteristic points of Cp.f(x ) (circles) and the translation vectors (short lines) were used
to find the characteristic points (squares) of the predicted high-fidelity model pressure distribution (only initial points are shown for clarity); lowfidelity model distributions Cp.c(x(i)) and Cp.c(x) are plotted using thin solid and dotted line, respectively; (b) high-fidelity model pressure
distribution at x, Cp.f(x) (solid line), and the predicted high-fidelity model pressure distribution at x obtained using SPRP (dotted line).

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320

1317

Author name / Procedia Computer Science 00 (2009) 000‚Äì000

SPRP can be rigorously formulated as follows. Let Cp.f(x) = [cp.f(x,y1) ‚Ä¶ cp.f(x,ym)]T and Cp.c(x) = [cp.c(x,y1) ‚Ä¶
cp.c(x,ym)]T, where yj, j = 1, ‚Ä¶, m, are control points on the k/c axis (we assume that yj+1 > yj and 0 ¬î yj ¬î 1 for all j).
To simplify the notation we assume that Cp.f (Cp.c) is the pressure distribution for the upper surface only.
Formulation for the lower surface is identical. Let pjf = [yjf rjf]T, pjc0 = [yjc0 rjc0]T, and pjc = [yjc rjc]T, j = 1, ‚Ä¶, K,
denote the sets of characteristic points of Cp.f(x(i)), Cp.c(x(i)) and Cp.f(x), respectively. Here, y and r denote the k/c and
magnitude components of the respective point. The translation vectors of the low-fidelity model pressure
distribution are defined as Ti = [yjt rjt]T, j = 1,‚Ä¶, K, where yjt = yjc ‚Äì yjc0 and rjt = rjc ‚Äì rjc0.
The SPRP surrogate model is defined as follows
C p( i.)s ( x) [c (pi.)s ( x, y1 ) ... c (pi.)s ( x, ym )]T

(7)

where
c (pi.)s ( x, y j )

c p. f ( x ( i ) , F ( y j ,{ ykt }kK 1 ))  r ( y j ,{rkt }kK 1 )

(8)

for j = 1, ‚Ä¶, m. c p. f ( x, y) is an interpolation of {cp.f(x,y1), ‚Ä¶, cp.f(x,ym)} onto the interval [0,1]. The scaling function
F interpolates the data pairs {y1,y1}, {y1f,y1f‚Äìy1t}, ‚Ä¶, {yKf,yKf‚ÄìyKt}, {ym,ym}, onto the interval [0,1]. The function r
does a similar interpolation for data pairs {y1,r1}, {y1f,r1f‚Äìr1t}, ‚Ä¶, {yKf,rKf‚ÄìrKt}, {ym,rm}; here r1 = cp.c(x,y1) ‚Äì cp.c(xr,y1)
and rm = cp.c(x,ym) ‚Äì cp.c(xr,ym). Note that Cp.s(i)(x(i)) = Cp.f(i)(x(i)) as all translation vectors are zero at x = x(i).
Our prediction method assumes that the high- and low-fidelity model pressure distributions have corresponding sets
of characteristic points. This is usually the case for the practical ranges of design variables because the overall shape of
the distributions is similar for both models. In case of lack of correspondence, original definitions of characteristic
points are replaced by their closest counterparts. The typical example would be non-existence of the local minimum of
the pressure distribution for the upper surface for the high- and/or low-fidelity model at certain designs. In this case, the
original point (local minimum) is replaced by the points characterized by the largest curvature.
3.3. Objective Function
Due to unavoidable misalignment between the pressure distributions of the high-fidelity model and its SPRP
surrogate, it is not convenient to use a drag constraint directly, because the design that is feasible for the surrogate
model, may not be feasible for the high-fidelity model. In particular, the design x(i+1) obtained as a result of
optimizing the surrogate model Cs(i) will be feasible for Cs(i). However, if x(i+1) is not feasible for the high-fidelity
model, it will not be feasible for Cs(i+1) because we have Cp.s(i+1)(x(i+1)) = Cp.f(x(i+1)) by the definition of the surrogate
model. In order to alleviate this problem, we shall use the penalty function approach to handle the drag constraint.
More specifically, the objective function is defined as
H (C p ( x))

Cl .s (C p ( x))  E ['Cdw.s (C p ( x))]2

(9)

where 'Cdw,s = 0 if Cdw,s ¬î Cdw,s.max and ' Cdw,s = Cdw,s ‚Äì Cdw,s.max otherwise. In our numerical experiments we use

E = 1000. Cp is a pressure distribution (Cp = Cp.s for the surrogate model and Cp = Cp.f for the high-fidelity model);
Cl,s and Cdw,s denote the lift and wave drag coefficients (both being functions of the pressure distribution).

3.4. Optimization Algorithm
Our optimization algorithm exploiting the SPRP-based surrogate model can be summarized as follows:
1. Set i = 0;
2. Evaluate Cp.f(x(i));
3. Obtain x(i+1) = argmin{l ¬î x ¬î u, A(x) t Amin : H(Cp.s(i)(x))};
4. Set i = i + 1;
5. If termination condition is not satisfied, go to 2.
In this paper, the algorithm is terminated if the current iteration does not bring further improvement of the highfidelity model objective function or ||x(i+1) ‚Äì x(i)|| < 0.001. It should be noted that optimization of the surrogate model
is normally performed under relaxed tolerance requirements: finding the accurate optimum of the surrogate is not
necessary due to its limited accuracy. In practice, step 3 of the above procedure requires about 30 evaluations of the
surrogate model.

1318

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

4. Verification examples
Three test cases are presented for design algorithm. The design formulation is the same for all cases, except that
the operational parameters, initial design, and constraint values are different. The objective is to maximize the lift
coefficient Cl, subject to a constraints on wave drag (Cdw d Cdw,limit) and airfoil cross-sectional area
nondimensionalized with the chord squared (A t 0.075). Details of the formulation are given in Section 3.3. The
airfoil shape is parameterized using a NACA four digit airfoil with m, p, and t/c as the design variables. The side
constraints on the design variables are 0 d m d 0.03, 0.3 d p d 0.6, and 0.09 d t/c d 0.13. Details of the test cases and
optimization results are given in Table 1. Because the low-fidelity model (TSFOIL) evaluates quite fast (about 1 to 3
seconds depending on the design) and the high-fidelity model (FLUENT) evaluation takes a few minutes, the total
cost of evaluating the low-fidelity model in the whole optimization run corresponds to roughly 1-2 evaluations of
the high-fidelity model.
The initial design of the first test case is NACA 0012 with both constraints not active. The optimum design obtained
by direct optimization has a 62.5% higher Cl than the initial design. The wave drag constraint is active, but the crosssectional area constraint is not. The number of high-fidelity model evaluations is 102. The optimum design obtained by
the algorithm proposed in this work has a 70% higher Cl than the initial design, but requires only 5 high-fidelity model
evaluations and 126 low-fidelity model evaluations, with a total equivalent optimization cost being less than 7 highfidelity model evaluations. The design variables of the optimum designs are very similar. The maximum camber has
increased from zero to approximately 0.5% and location of maximum camber hits the upper bound of 60% of the
chord. As can be seen from Figure 6 the shock on the upper surface has become stronger, hence the wave drag constraint
becomes active, and it has moved rearward. The pressure distribution has opened up, yielding the increase in lift.
The second test case starts with a NACA 2412 airfoil and both constraints being not active. Using direct
optimization the lift is improved by 40.8%, whereas the proposed algorithm improves it by 36.7%. However, direct
optimization requires 110 high-fidelity model evaluations, and the proposed algorithm less than 7 equivalent highfidely model evaluations. In this case, as for the first case, the maximum camber is increased, from 2% to
approximately 2.5%, and the location of maximum camber is moved rearward, from 40% to 60% in the direct
optimization and 56.5% for the proposed algorithm. Hence, the aft camber of the airfoil is increased and the pressure
distribution opens up in the rear, yielding more lift, as can be seen in Figure 7. The shock moves rearward and becomes
stronger and, therefore, the wave drag constraint becomes active.
The third case also starts with NACA 2412, but at a higher Mach number and lower angle of attack. The limit on the
wave drag is lower, and so the wave drag constraint is violated at the inital design. Both optimization methods reduce
the maximum camber and move the location of it rearward. By reducing the camber the flow velocity decreases on the
upper surface and the shock strength is reduced, as can be seen in Figure 8. By moving the maximum camber rearward,
the aft camber increases and the pressure distribution opens up the in the rear, behind the shock, and increases lift.

Table 1. Numerical results for three test cases. Shown are results for the initial design, direct optimization and optimization using SPRP. All the
numerical values are from the high-fidelity model (FLUENT). Nc is number of low-fidelity model (TSFOIL) evaluations and Nf is the number
high-fidelity model (FLUENT) evaluations.
Case 2
Case 3
Case 1
Mf = 0.70, D = 1¬∞, Cdw,limit = 0.0058
Mf = 0.75, D = 0¬∞, Cdw,limit =0.0040
Mf = 0.75, D = 1¬∞, Cdw,limit = 0.0032
#
$
#
$
Variable
Initial
Direct
This work
Initial
Direct
This work
Initial
Direct#
This work$
m
0.0
0.00435
0.00489
0.02
0.0251
0.0253
0.02
0.0160
0.0173
p
0.0
0.6
0.6
0.4
0.5993
0.5653
0.4
0.5999
0.5930
t/c
0.12
0.1199
0.1180
0.12
0.12
0.1197
0.12
0.1199
0.1163
0.2072
0.3367
0.3521
0.6006
0.8454
0.8210
0.4732
0.4770
0.5085
Cl
0.00097
0.0032
0.0032
0.0035
0.0058
0.0057
0.0100
0.0040
0.0041
Cdw
A
0.0807
0.0807
0.0794
0.0808
0.0808
0.0806
0.0808
0.0808
0.0783
N/A
0
126
N/A
0
135
N/A
0
161
Nc
N/A
102
5
N/A
110
5
N/A
130
5
Nf
Total cost*
N/A
102
<7
N/A
110
<7
N/A
130
<7
#
Design obtained through direct optimization of the high-fidelity FLUENT model using the grid-search algorithm.
$
Design obtained using the algorithm proposed in Section 3; surrogate model optimization performed using the grid-search algorithm.
*
The total optimization cost is expressed in the equivalent number of high-fidelity model evaluations.

1319

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

Direct optimization improves the lift 0.8%, but the proposed algorithm improves it by 7.5%. With increased lift
there should be an increase in wave drag. However, the optimum design obtained by proposed algorithm reduces the
thickness from 12% to 11.6%, and therefore, is able to reduce the wave drag (since thinner airfoils have, in general,
lower wave drag). The proposed algorithm requires less than 7 equivalent high-fidelity model evaluations, whereas
direct optimization requires 130 high-fidelity model evaluations.

Cp

-1
0

1
0
0.1
z/c

(a)

Initial (NACA 0012)
Optimum

0.2

0.4

0.2

0.4

0.6

0.8

1

0.6

0.8

1

0
-0.1
0

k/c

(c)
(b)
Fig. 6. (a) Mach number contours for the initial design (NACA 0012) of Case 1 (Mf = 0.75, D = 1¬∞). (b) Mach number contours of the optimum
design obtained using the proposed algorithm. (c) Pressure coefficient on the surface of the initial and optimum designs, and the airfoil shapes.

Cp

-1

(a)

0

z/c

1
0
0.1

Initial (NACA 2412)
Optimum

0.2

0.4

0.2

0.4

0.6

0.8

1

0.6

0.8

1

0
-0.1
0

k/c

(c)
(b)
Fig. 7. (a) Mach number contours for the initial design (NACA 2412) of Case 2 (Mf = 0.70, D = 1¬∞). (b) Mach number contours of the optimum
design obtained using the proposed algorithm. (c) Pressure coefficient on the surface of the initial and optimum designs, and the airfoil shapes.

Cp

-1
0
1
0

(a)

z/c

0.1

Initial (NACA 2412)
Optimum

0.2

0.4

0.2

0.4

0.6

0.8

1

0.6

0.8

1

0
-0.1
0

k/c

(c)
(b)
Fig. 8. (a) Mach number contours for the initial design (NACA 2412) of Case 3 (Mf = 0.75, D = 0¬∞). (b) Mach number contours of the optimum
design obtained using the proposed algorithm. (c) Pressure coefficient on the surface of the initial and optimum designs, and the airfoil shapes.

1320

L. Leifsson, S. Koziel / Procedia Computer Science 1 (2012) 1311‚Äì1320
Author name / Procedia Computer Science 00 (2009) 000‚Äì000

5. Conclusions
We have presented a design optimization methodology for transonic airfoils that uses a computationally cheap,
physics-based low-fidelity model to construct a surrogate of an accurate but CPU-intensive high-fidelity model. The
low-fidelity model is corrected by aligning its airfoil surface pressure distribution with the corresponding
distribution of the high-fidelity model. The alignment is carried out using a shape-preserving response prediction
methodology and ensures good generalization capability of the surrogate model with respect to both objectives and
constraints (lift and wave drag). Several optimization case studies demonstrated computational efficiency of the
proposed method. More specifically, our approach brings over 90% reduction of the number of high-fidelity model
evaluations when compared to the direct optimization using grid-search.
Further verification studies of the proposed method in two-dimensions are required before extending it to threedimensions. Cases with shock on both the upper and the lower surface should be examined. Also, better control of
the airfoil shape can be realized by using other parameterization method.
References
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.

Chen, N., Zhang, H., Huang, W., and Xu, Y., ‚ÄúStudy on Aerodynamic Design Optimization of Turbomachinery Blades,‚Äù Journal of Thermal
Sciences, Vol. 14, No. 4, December 2005.
Saha, G., Suzuki, K., and Kai, H., ‚ÄúHydrodynamic Optimization of Ship Hull Forms in Shallow Water,‚Äù Journal of Marine Science and
Technology, Vol. 9, No. 2, July 2004.
Gundlach, J.F., Tetrault, P., Gern, F., Nagshineh-Pour, A., Ko, A., Schetz, J.A., Mason, W.H., Kapania, R., Grossman, B., and Haftka, R.T.,
‚ÄúMultidisciplinary Design Optimization of a Strut-Braced Wing Transonic Transport,‚Äù 38th Aerospace Sciences Meeting and Exhibit, Reno,
NV, AIAA Paper 2000-0420, Jan. 10-13, 2000.
Hosder, S.,Schetz, J.A., Grossman, B., and Mason, W.H., ‚ÄúAirframe Noise Modeling Appropriate for Multidisciplinary Design and
Optimization,‚Äù 42nd AIAA Aerospace Sciences Meeting and Exhibit, Reno, NV, AIAA Paper 2004-0698, Jan. 5-8, 2004.
Vanderplaats, G.N., ‚ÄúNumerical Optimization Techniques for Engineering Design,‚Äù 3rd Edition, Vanderplaats Research and Development, 1999.
Hicks, R.M., Murman, E.M., and Vanderplaats, G., ‚ÄúAn Assessment of Airfoil Design by Numerical Optimization,‚Äù NASA TM-3092, July 1974.
Jameson, A., ‚ÄúAerodynamic Design via Control Theory,‚Äù Journal of Scientific Computing, Vol. 3, 1988, pp. 233-260.
Reuther, J., and Jameson, A.,‚ÄúControl Theory Based Airfoil Design for Potential Flow and a Finitie Volume Discretization,‚Äù AIAA Paper
94-0499, AIAA 32nd Aerospace Sciences Meeting and Exhibit, Reno, Nevada, January 1994.
Jameson, A., and Reuther, J.,‚ÄúControl Theory Based Airfoil Design using Euler Equations,‚Äù Proceedings of AIAA/USAF/NASA/ISSMO
Symposium on Multidisciplinary Analsysis and Optimization, Panama City Beach, September 1994, pp. 206-222.
Kim, S., Alonso, J.J., and Jameson, A., ‚ÄúDesign Optimization of High-Lift Configurations Using a Viscous Continuous Adjoint Method,‚Äù
AIAA paper 2002-0844, AIAA 40th Aerospace Sciences Meeting & Exhibit, Reno, NV, January 2002.
Leoviriyakit, K., Kim, S., and Jameson, A.,‚ÄúViscous Aerodynamic Shape Optimization of Wings including Planform Variables,‚Äù 21st
Applied Aerodynamics Conference, Orlando, Florida, June 23-26, 2003.
Reuther, J., Jameson, A., Alonso, J.J., Rimlinger, M.J., and Sauders, D., ‚ÄúConstrained Multipoint Aerodynamic Shape Optimization Using an Adjoint
Formulation and Parallel Computing,‚Äù 35th AIAA Aerospace Sciences Meeting & Exhibit, Reno, NV, AIAA Paper 97-0103, Jan. 6-9, 1997.
Queipo, N.V., Haftka, R.T., Shyy, W., Goel, T., Vaidyanathan, R., and Tucker, P.K., ‚ÄúSurrogate-Based Analysis and Optimization,‚Äù
Progress in Aerospace Sciences, Vol. 41, No. 1, Jan. 2005, pp. 1-28.
Alexandrov, N.M., Nielsen, E.J., Lewis, R.M., and Anderson, W.K., ‚ÄúFirst-Order Model Management with Variable-Fidelity Physics
Applied to Multi-Element Airfoil Optimization,‚Äù 8th AIAA/USAF/NASA/ISSMO Symposium on Multidisciplinary Design and Optimization,
Long Beach, CA, AIAA Paper 2000-4886, Sept. 2000.
Robinson, T.D., Eldred, M.S., Willcox, K.E., and Haimes, R., ‚ÄúSurrogate-Based Optimization Using Multifidelity Models with Variable
Parameterization and Corrected Space Mapping,‚Äù AIAA Journal, Vol. 46, No. 11, November 2008.
J.W. Bandler, Q.S. Cheng, S.A. Dakroury, A.S. Mohamed, M.H. Bakr, K. Madsen, and J. Sondergaard, ‚ÄúSpace mapping: the state of the art,‚Äù
IEEE Trans. Microwave Theory Tech., vol. 52, no. 1, pp. 337 361, Jan. 2004.
S. Koziel, J.W. Bandler and K. Madsen, ‚ÄúA space mapping framework for engineering optimization: theory and implementation,‚Äù IEEE
Trans. Microwave Theory Tech., vol. 54, no. 10, pp. 3721-3730, 2006.
S. Koziel, Q.S. Cheng, and J.W. Bandler, ‚ÄúSpace mapping,‚Äù IEEE Microwave Magazine, vol. 9, no. 6, pp. 105-122, Dec. 2008.
M. Redhe, and L. Nilsson, ‚ÄúUsing space mapping and surrogate models to optimize vehicle crashworthiness design,‚Äù 9th AIAA/ISSMO
Multidisciplinary Analysis and Optimization Symp., Atlanta, GA, Sept. 2002, Paper AIAA-2002-5536.
S. Koziel, ‚ÄúEfficient Optimization of Microwave Circuits Using Shape-Preserving Response Prediction,‚Äù IEEE MTT-S Int. Microwave Symp.
Dig, Boston, MA, pp. 1569-1572, 2009.
Abbott, I.H., and Von Doenhoff, A.E., ‚ÄúTheory of Wing Sections,‚Äù Dover Publications, 1959.
Anderson, J.D., ‚ÄúModern Compressible Flow ‚Äì With Historical Prespective,‚Äù Third edition, McGraw-Hill, 2003.
FLUENT, ver. 6.3.26, ANSYS Inc., Southpointe, 275 Technology Drive, Canonsburg, PA 15317, 2006.
Murman, E.M., Bailey, F.R., and Johnson, M.L, ‚ÄúTSFOIL ‚Äì A computer code for the two-dimensional transonic calculations, including
wind-tunnel wall effects and wave-drag evaluation,‚Äù NASA SP-347, Part II, 1975, pp. 769-788.
T.W. Simpson, J. Peplinski, P.N. Koch, and J.K. Allen, ‚ÄúMetamodels for computer-based engineering design: survey and recommendations,‚Äù
Engineering with Computers, vol.17, no. 2, pp. 129-150, July 2001.
A.J. Smola and B. Sch√∂lkopf, ‚ÄúA tutorial on support vector regression,‚Äù Statistics and Computing, vol. 14, no. 3, pp. 199-222, Aug. 2004.

