Available online at www.sciencedirect.com

ScienceDirect

This space is reserved for the Procedia header, do not use it
This Procedia
space isComputer
reserved
for 108C
the Procedia
header, do not use it
Science
(2017) 2363–2367
This space is reserved for the Procedia header, do not use it

International Conference on Computational Science, ICCS 2017, 12-14 June 2017,
Zurich, Switzerland

Influenza peaks forecasting in Russia: assessing the
Influenza peaks forecasting in Russia: assessing the
of statistical
methods
Influenzaapplicability
peaks forecasting
in Russia:
assessing the
applicability
of statistical
methods
1
Vasiliy N. Leonenko
, KlavdiyaofO.statistical
Bochenina22 , methods
and Sergey A. Kesarev33
applicability
1
Vasiliy N. Leonenko , Klavdiya O. Bochenina , and Sergey A. Kesarev
1

ITMO University, Saint Petersburg, Russian Federation

2
1
2

ITMO
ITMO
ITMO
ITMO
ITMO
ITMO

1
2
1
Vasiliy N. Leonenko
, Klavdiya
O.Petersburg,
Bochenina
, and
Sergey A. Kesarev3
ITMO University,
Saint
Russian
Federation
vnleonenko@yandex.ru

3
2
3
3

vnleonenko@yandex.ru
University,
Saint Petersburg, Russian
University,
Saint
University,
Saint Petersburg,
Petersburg, Russian
Russian
k.bochenina@gmail.com
vnleonenko@yandex.ru
k.bochenina@gmail.com
University,
Saint Petersburg, Russian
University,
Saint
University,
Saint Petersburg,
Petersburg, Russian
Russian
kesarevs@gmail.com
k.bochenina@gmail.com
kesarevs@gmail.com
ITMO University, Saint Petersburg, Russian
kesarevs@gmail.com

Federation
Federation
Federation
Federation
Federation
Federation
Federation

Abstract
Abstract
This paper compares the accuracy of different statistical methods for influenza peaks prediction.
This
paper compares
the accuracy
of differentofstatistical
methodsmemory
for influenza
prediction.
The
research
demonstrates
the performance
long short-term
neuralpeaks
networks
along
Abstract
The
research
demonstrates
the
performance
of
long
short-term
memory
neural
networks
along
with
the
results
obtained
by
proved
statistical
methods,
which
are
the
Serfling
model,
averaging
This paper compares the accuracy of different statistical methods for influenza peaks prediction.
with
the
results
obtained
by
proved
statistical
methods,
which
are
the
Serfling
model,
averaging
and
estimates.
prediction
of the methods
is compared
with
the
The point-to-point
research demonstrates
the The
performance
of accuracy
long short-term
memory neural
networks
along
and
point-to-point
estimates.
The prediction
accuracy
of theofmethods
is compared
with
the
accuracy
of
the
modeling
approaches.
Possible
applications
the
methods
and
the
ways
to
with the results obtained by proved statistical methods, which are the Serfling model, averaging
accuracy
of
the
modeling
approaches.
Possible
applications
of
the
methods
and
the
ways
to
improve
their
accuracy
are
discussed.
and point-to-point estimates. The prediction accuracy of the methods is compared with the
improve their accuracy are discussed.
accuracy
the analysis,
modeling
approaches.
Possible applications
of the infection,
methods seasonal
and theinfluenza,
ways to
Keywords:
data
mathematical
epidemiology,
acute respiratory
©
2017 Theof
Authors.
Published
by
Elsevier B.V.
Keywords:
dataaccuracy
analysis,
mathematical
acute
respiratory
infection,
seasonal influenza,
improve learning,
their
Peer-review
under
responsibility
ofdiscussed.
the scientificepidemiology,
committee of the
International
Conference
on Computational
Science
machine
Pythonare
machine learning, Python
Keywords: data analysis, mathematical epidemiology, acute respiratory infection, seasonal influenza,
machine learning, Python

1 Introduction and motivation
1 Introduction and motivation
The problem of predicting the outbreaks of acute respiratory infections (ARIs) and influenza
1
Introduction
and
motivation
The
of predicting
theinoutbreaks
of mathematical
acute respiratory
infections due
(ARIs)
andworldwide
influenza
is oneproblem
of the most
important
the field of
epidemiology
to the
is
one of
most
important
in the1960’s,
field ofthe
mathematical
epidemiology
due
to the worldwide
spread
of the
these
In the
first mathematical
models of
influenza
The problem
ofdiseases.
predicting
the late
outbreaks of
acute
respiratory infections
(ARIs)
andoutbreaks
influenza
spread
of
these
diseases.
In
the
late
1960’s,
the
first
mathematical
models
of
influenza
outbreaks
were
created.
One
of
the
most
prominent
studies
of
that
time,
accomplished
by
Baroyan
and
is one of the most important in the field of mathematical epidemiology due to the
worldwide
were
created.
One of thewith
most
prominent
studieswithin
of that
time,
accomplished
by
Baroyan
and
Rvachev,
was
connected
the
flu
propagation
the
cities
in
the
Soviet
Union
[1].
From
spread of these diseases. In the late 1960’s, the first mathematical models of influenza outbreaks
Rvachev,
was
connected
with
the
flu
propagation
within
the
cities
in
the
Soviet
Union
[1].
From
early
1980’s, the
Soviet
modeling
complex for
flu forecasting
showed
some incoherence
with and
the
were created.
One
of the
most prominent
studies
of that time,
accomplished
by Baroyan
early
1980’s,
the Soviet
modeling
complex
for flu
forecasting
showed somewith
incoherence
with
the
epidemic
outbreak
patterns
observed
in
Soviet
cities
[6].
The
experiments
the
SEIR
models
Rvachev, was connected with the flu propagation within the cities in the Soviet Union [1]. From
epidemic
outbreak
patterns
observed
in
Soviet
cities
[6].
The
experiments
with
the
SEIR
models
calibration
theSoviet
contemporary
incidence
datashowed
available
[11],
[12] demonstrated
early 1980’s,tothe
modeling Russian
complexARI
for flu
forecasting
some
incoherence
with the
calibration
to theallow
contemporary
Russian
ARIpeak
incidence
data
available
[11],accuracy.
[12] demonstrated
that
the
models
predicting
an
epidemic
height
with
satisfactory
However,
epidemic outbreak patterns observed in Soviet cities [6]. The experiments with the SEIR
models
that
the models
allow
an peak
epidemic
peak height with satisfactory accuracy. However,
the
accuracy
low
forpredicting
an epidemic
day
calibration
toisthe
contemporary
Russian
ARIprediction.
incidence data available [11], [12] demonstrated
the The
accuracy is low
for whether
an epidemic
peak day
prediction.
arises
is better
to rely
the statistical
methodsaccuracy.
based on historical
that thequestion
models allow
predictingitan
epidemic
peakon
height
with satisfactory
However,
The
question
arises
whether
it
is
better
to
rely
on themaking
statistical
methodsin
based
historical
data
rather
than
on
the
modeling
approaches
while
predictions
the on
situation
of
the accuracy is low for an epidemic peak day prediction.
data
rather than
on the modeling
approaches
while
makingstatistical
predictions
in the situation
of
sophisticated
and
heterogeneous
disease
dynamics.
As
known,
approaches
taking
the
The question arises whether it is better to rely on the statistical methods based on historical
sophisticated and heterogeneous disease dynamics. As known, statistical approaches taking the
data rather than on the modeling approaches while making predictions in the situation of
1
sophisticated and heterogeneous disease dynamics. As known, statistical approaches taking the
1
1877-0509 © 2017 The Authors. Published by Elsevier B.V.
Peer-review under responsibility of the scientific committee of the International Conference on Computational Science
10.1016/j.procs.2017.05.196

1

2364	

(2017)Bochenina
2363–2367 and Kesarev
Influenza peaks forecasting Vasiliy
. . . N. Leonenko et al. / Procedia Computer Science 108C
Leonenko,

last season peak data and the average peak data as the peak prediction for the current season,
can demonstrate the same accuracy as the modeling prediction for the day peak [11]. In fact,
the reason is not the high accuracy of such a naive approach, but the low accuracy of the
modeling prediction of this parameter. The aim of this paper is to apply more sophisticated
statistical techniques to the same ARI dataset and compare the resulting accuracy with the
modeling approaches demonstrated in [11], [12].

2

Methods review

The two most popular families of non-parametric methods that can be used for epidemic peaks
prediction are Bayesian and machine learning (ML) methods. The example of Bayesian approach is given in [2], [7], and the approach to outbreak forecasting on the basis of classification
techniques (belong to ML methods) is presented in [13]. However, as we do not possess the
type of input data which was used in the mentioned works, the techniques described cannot be
applied to our case. The application of the Long-Short Term Memory (LSTM) neural networks
seems more promising, as they do not require large synthetic data sets as an input. Moreover,
they are capable of learning long-term dependencies without preliminary assumptions on the
structure of underlying process. The example of LSTM application is [16], where the authors
used LSTM networks to perform sequence-to-sequence weather forecasting. The approach used
in [16] requires the input and output sequences to be of the same length. However, the limitation of fixed dimensionality can be avoided by using two LSTMs (one as encoder, and one as
decoder) as it is shown in [15].

3

Numerical experiment

Algorithm details. The input dataset is a time series with daily ARI incidence observations
within the period from 1985 to 2015. With the aim of synthesizing large training samples we slice
the data using the running window with a small step s. This way yields the dataset of around
four thousand rows for each city if s = 1. The main drawback of this idea is that the adjacent
samples differ only in s observations. LSTM-based neural networks are sensitive to the scale of
the input data [3], so we work with normalized data, using the inverse transform to return to
the initial scale. Denote the whole dataset as T = (t1 , . . . , tN ) and set the step size s (in our
implementation s = 1). Then kth sample in the training set is xk = (tsk , tsk+1 , . . . , tsk+364 )
and the output for xk is yk = (tsk+365 , tsk+365+1 , . . . , tsk+365+364 ). The test set contains one
sample: the year before the last as x1 and the last year as y1 . No observations from the test
set are used in the training set.
The architecture of our network has the following structure. The input layer of the network
takes a matrix of shape 1 × 365 (which is essentially xk ). The linear combinations of these
inputs are sent to 128 LSTM cells. Fully-connected layer maps the time dependencies resolved
by LSTM cells back to the space of scaled influenza levels per each day of the year. The fact
that our output is within [0; 1] range allows us to use sigmoid activation function for the outer
layer. For the training procedure the batch size 32 was used. The network was implemented
using Keras library with TensorFlow backend. Initial weights are set to random numbers. We
employ three different loss functions. The first one is the classical mean square error (MSE):
2
MSE(ŷk , yk ) = 12 ŷk − yk  . The second one, softmax, enforces the network to predict peak
positions more precisely by suppressing the values which are significantly below the maximum:
xi
2
softmax(x)i = e exj , SF LOSS(ŷk , yk ) = 12 softmax(ŷk ) − softmax(yk ) . The third one is
j

2

	

(2017)Bochenina
2363–2367 and Kesarev
Influenza peaks forecasting Vasiliy
. . . N. Leonenko et al. / Procedia Computer Science 108C
Leonenko,

the combination of the methods mentioned above: MSE(ŷk , yk ) + α · SF LOSS(ŷk , yk ), α ∈ R –
with α somewhat arbitrary set to 0.2.
To assess the performance of employed time series prediction approaches, we have used three
statistical methods already used for the analysis of Russian ARI incidence [8]: simple averaging,
point-to-point linear estimates and Serfling regression method.
Experiment details. We use two datasets for the experiment. The first dataset contains the
original weekly ARI incidences in Moscow, Saint Peterburg and Novosibirsk within the period
from 1986 to 2014 provided by the Research Institute of Influenza, Saint Petersburg, Russia
[5]. The second one consists of the corresponding daily incidences obtained by the interpolation
and correcting the under-reporting during the holidays [10]. The dataset for every city iss split
into epidemic seasons starting from July 1st and ending on June 30th of the next year. For
each city the predictions for 15 epidemic seasons are made, from July 1st, 2000 to June 30th,
2014. Three LSTM algorithm launches are made with different initial seeds, thus giving us 135
peak predictions in total — compared with 45 predictions generated by deterministic statistical
methods. The values obtained from every prediction are the prediction bias of the peak day
dt and the ratio between the modeled and real outbreak peak heights dh. We assume that the
ideal peak prediction has dt = 0 and dh = 1. The following accuracy criteria ae employed [12]:
(a)’Square’. The prediction is accurate if dt ∈ −8..8 and dh ∈ (0.5; 2.0). (b)‘Vertical stripe’.
dt ∈ −7..7. (c) ‘Horizontal stripe’. dh ∈ (0.7; 1.5). The distributions of prediction biases for
the daily data are shown in Fig. 1. The ratio of the forecasts complying to the criteria is given
in Table 1.

Figure 1: Biases of the peak prediction for Saint Petersburg, Moscow and Novosibirsk using
the daily incidence data generated by the algorithm [10]. Dashed rectangles correspond to the
‘square’ accuracy criterion, the ‘stripe’ criteria are shown by transparent fill.

Table 1: The percentage of accurately predicted peaks according to different criteria
Average
Point to point
Serfling
MSE
Softmax
MSE+Softmax

Vert. stripe
Daily Weekly
10.4%
6.3%
10.4%
6.3%
16.7%
18.8%
23.7%
31.1%
20.7%
33.3%
23.0%
34.1%

Horiz.
Daily
85.4%
75.0%
70.8%
82.2%
74.1%
82.2%

stripe
Weekly
83.3%
72.9%
72.9%
68.1%
54.1%
74.1%

Square
Daily Weekly
14.6%
6.3%
14.5%
6.3%
16.6%
18.8%
25.2%
31.1%
22.2%
26.0%
26.7%
34.1%

3

2365

2366	

(2017)Bochenina
2363–2367 and Kesarev
Influenza peaks forecasting Vasiliy
. . . N. Leonenko et al. / Procedia Computer Science 108C
Leonenko,

4

Results

— In most of the cases the prediction made on the original weekly dataset is less accurate than
the prediction on the interpolated daily dataset. This result is compromised slightly by the
fact that the ”real” day and peak height are received by the interpolation of the weekly data.
Further investigation is required to compare the accuracy. We plan to perform it using the
daily ARI incidence data available for Saint Petersburg.
— As seen from the table, compared to MSE, the sole employment of Softmax criterion
worsens the prediction results, and the ensemble MSE+Softmax method with the current value
of α does not demonstrate the increased accuracy. Further algorithm calibration for the sake
of finding the optimal value of α is required.
— The accuracy of peak height assessment demonstrated by all the methods applied is
satisfactory and similar to that obtained by the modeling approaches ([11], [12]). The fact that
the accuracy of the peak day prediction obtained by statistical algorithms is lower compared
to the neural networks, demonstrates the inability of the former to capture the peak moment
patterns throughout different seasons.

5

Discussion

The experiment results demonstrate that the statistical time series forecasting approaches applied to the ARI dataset have no advantages in terms of accuracy compared to the modeling
approaches tested by the authors earlier [11], [12]. The unresolved problem is the low accuracy
of the peak day prediction. Moreover, if we compare the distribution of day prediction biases
on the scatter plots for the statistical and modeling methods (Fig. 1 of the current work,
Fig. 3 in [12]), it becomes obvious that in the latter case the range of forecast biases is even
narrower, i.e. the chance to obtain more accurate forecast of a peak day using the model is
higher (although it is still rather slight). The simple statistical methods are unable to forecast
accurately the peak day, because this moment is defined by external factors [9] rather than
by preceding ARI dynamics. The equivalent failure of the machine learning approach can be
caused by the speculative way of forming the training set (i.e. the running window slicing).
One of the possible ways to enhance the prediction accuracy is to use the data for other Russian
cities thus extending the dataset without slicing, another one is to combine two widely known
approaches: the autoencoders [4] and transfer learning [14].
Considering the results demonstrated in the paper, we believe that the direction of research
connected with the improvement of the modeling forecast is more beneficial in the long run
than the one relying on the statistical methods. However, the statistical methods can be used
for the long-term peak height assessment, because being compared to the modeling approach
they show almost the same accuracy delivering the results much more in advance before the
actual peak is observed. Moreover, both approaches can be combined in a composite influenza
forecasting framework, which is likely to obtain improved accuracy of the peak forecasting.

6

Acknowledgments

The authors thank Mikhail Kondratyev for the explicit information on the statistical algorithms
from [8] and Viktor Yakovlev for his contribution in refining the programming code. This
research is financially supported by The Russian Scientific Foundation, Agreement #14-1100823 (15.07.2014).
4

	

(2017)Bochenina
2363–2367 and Kesarev
Influenza peaks forecasting Vasiliy
. . . N. Leonenko et al. / Procedia Computer Science 108C
Leonenko,

References
[1] OV Baroyan, UV Basilevsky, VV Ermakov, KD Frank, LA Rvachev, and VA Shashkov. Computer
modelling of influenza epidemics for large-scale systems of cities and territories. In Proc. WHO
Symposium on Quantitative Epidemiology, Moscow, 1970.
[2] Logan C Brooks, David C Farrow, Sangwon Hyun, Ryan J Tibshirani, and Roni Rosenfeld. Flexible
modeling of epidemics with an empirical bayes framework. PLoS Comput Biol, 11(8):e1004382,
2015.
[3] F. A. Gers, J. Schmidhuber, and F. Cummins. Learning to forget: Continual prediction with
LSTM. Neural Computation, 12(10):2451–2471, Oct 2000.
[4] G. E. Hinton and R. R. Salakhutdinov. Reducing the dimensionality of data with neural networks.
Science, 313(5786):504–507, 2006.
[5] Flu Institute. Research Institute of Influenza website. [online]. http://influenza.spb.ru/en/.
[6] Yu.G. Ivannikov and P.I. Ogarkov. An experience of mathematical computing forecasting of the
influenza epidemics for big territory. Journal of Infectology, 4(3):101–106, 2012. In Russian.
[7] Xia Jiang, Garrick Wallstrom, Gregory F Cooper, and Michael M Wagner. Bayesian prediction of
an epidemic curve. Journal of Biomedical Informatics, 42(1):90–99, 2009.
[8] M. Kondratyev and L. Tsybalova. Long-term forecasting of influenza-like illnesses in Russia.
International Journal of Pure and Applied Mathematics, 89(4):619–641, 2013.
[9] V. N. Leonenko and S. V. Ivanov. Fitting the SEIR model of seasonal influenza outbreak to
the incidence data for Russian cities. Russian Journal of Numerical Analysis and Mathematical
Modelling, 31(5):267–279, 2016.
[10] V. N. Leonenko, S. V. Ivanov, and Yu. K. Novoselova. A computational approach to investigate patterns of acute respiratory illness dynamics in the regions with distinct seasonal climate
transitions. Procedia Computer Science, 80:2402–2412, 2016.
[11] Vasiliy N Leonenko and Sergey V Ivanov. Influenza peaks prediction in Russian cities: comparing
the accuracy of two SEIR models. Mathematical Biosciences and Engineering, 2017. In Press.
[12] Vasiliy N Leonenko, Yulia K Novoselova, and Karen M Ong. Influenza outbreaks forecasting
in Russian cities: Is Baroyan-Rvachev approach still applicable? Procedia Computer Science,
101:282–291, 2016.
[13] Elaine O Nsoesie, Richard Beckman, Madhav V Marathe, and Bryan Lewis. Prediction of an
epidemic curve: A supervised classification approach. Statistical Communications in Infectious
Diseases, 3(1):12, 2011.
[14] L. Y. Pratt. Discriminability-based transfer between neural networks. In S. J. Hanson, J. D.
Cowan, and C. L. Giles, editors, Advances in Neural Information Processing Systems 5, pages
204–211. Morgan-Kaufmann, 1993.
[15] Ilya Sutskever, Oriol Vinyals, and Quoc V Le. Sequence to sequence learning with neural networks.
In Advances in neural information processing systems, pages 3104–3112, 2014.
[16] Mohamed Akram Zaytar and Chaker El Amrani. Sequence to sequence weather forecasting with
long short-term memory recurrent neural networks. International Journal of Computer Applications, 143(11):7–11, Jun 2016.

5

2367

