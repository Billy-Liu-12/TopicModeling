Procedia Computer
Science
Procedia Computer
Procedia
ComputerScience
Science001(2010)
(2012)1–10
2371–2380

www.elsevier.com/locate/procedia

International Conference on Computational Science, ICCS 2010

A PDE pricing framework for cross-currency interest rate
derivatives
Duy Minh Danga,∗, Christina C. Christaraa , Kenneth R. Jacksona , Asif Lakhanyb
a Department

of Computer Science, University of Toronto, Toronto, ON, M5S 3G4, Canada
b Algorithmics Inc., Toronto, ON, M5T 2C6, Canada

Abstract
We propose a general framework for efﬁcient pricing via a Partial Differential Equation (PDE) approach of crosscurrency interest rate derivatives under the Hull-White model. In particular, we focus on pricing long-dated foreign
exchange (FX) interest rate hybrids, namely Power Reverse Dual Currency (PRDC) swaps with Bermudan cancelable
features. We formulate the problem in terms of three correlated processes that incorporate FX skew via a local volatility function. This formulation results in a time-dependent parabolic PDE in three spatial dimensions. Finite difference
methods on uniform grids are used for the spatial discretization of the PDE. The Crank-Nicolson (CN) method and
the Alternating Direction Implicit (ADI) method are considered for the time discretization. In the former case, the
preconditioned Generalized Minimal Residual (GMRES) method is employed for the solution of the resulting block
banded linear system at each time step, with the preconditioner solved by Fast Fourier Transform (FFT) techniques.
Numerical results indicate that the numerical methods considered are second-order convergent, and, asymptotically, as
the discretization granularity increases, almost optimal, with the ADI method being modestly more efﬁcient than CNGMRES-FFT. An analysis of the impact of the FX volatility skew on the PRDC swaps’ prices is presented, showing
that the FX volatility skew results in lower prices (i.e. proﬁts) for the payer of PRDC coupons.

c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
⃝

Keywords: Power Reverse Dual Currency (PRDC) swaps, Bermudan cancelable, Partial Differential Equation
(PDE), Alternating Direction Implicit (ADI), Generalized Minimal Residual (GMRES), Fast Fourier Transform
(FFT)

1. Introduction
We investigate the modeling and numerical valuation of cross-currency interest rate derivatives with strong emphasis on long-dated foreign exchange (FX) interest rate hybrids, namely Power Reverse Dual Currency (PRDC) swaps
with Bermudan cancelable features using a partial differential equation (PDE) approach. The motivation for this work
is that, although cross-currency interest rate derivatives in general, and FX interest rate hybrids in particular, are of
enormous current practical importance, the valuation of these derivatives via a PDE approach is not well-developed in
∗ Corresponding

author
Email addresses: dmdang@cs.toronto.edu (Duy Minh Dang ), ccc@cs.toronto.edu (Christina C. Christara),
krj@cs.toronto.edu (Kenneth R. Jackson), asif.lakhany@algorithmics.com (Asif Lakhany)

c 2012 Published by Elsevier Ltd. Open access under CC BY-NC-ND license.
1877-0509 ⃝
doi:10.1016/j.procs.2010.04.267

2372

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

2

the literature. More speciﬁcally, the pricing of PRDC swaps has been a subject of great interest in practice, especially
among ﬁnancial institutions, yet PDE methods for doing so are not well-developed in the public domain. The popular
choice for pricing PRDC swaps is Monte-Carlo (MC) simulation, but this approach has several major disadvantages,
such as slow convergence and difﬁculty in computing hedging parameters.
Foreign exchange (FX) interest rate hybrids, such as PRDC swaps, are exposed to moves in both the spot FX rate
and the interest rates in both currencies. The current standard modeling of such products consists of two one-factor
Gaussian models for the term structures and a one-factor log-normal model for the spot FX rate [1]. These choices
provide the beneﬁts of (i) keeping the number of factors to the minimum (a total of three) and (ii) using very efﬁcient,
essentially closed-form, calibration for the spot FX rate model. However, FX options, especially long-dated ones,
exhibit a signiﬁcant skew, which cannot be well captured by the log-normal distribution. In addition, cross-currency
interest rate derivatives with exotic features, such as Bermudan cancelable PRDC swaps, are particularly sensitive
to the FX volatility smile/skew. As a result, the assumption of log-normality of spot FX rates is questionable in
the modeling of such derivatives. One way to rectify this deﬁciency is to incorporate FX volatility smiles into the
model via a local volatility function, as ﬁrst suggested in [2]. By using a local volatility model, this approach avoids
introducing more stochastic factors into the model. Hence it keeps the number of factors to the minimum, while
providing better modeling for the skewness of the FX rate. Under a three-factor model, cross-currency interest rate
derivatives are dependent on three stochastic state variables and thus the PDE which their value function must satisfy
has three state variables in addition to the time variable. Furthermore, these products have additional complexity due
to multiple cash ﬂow dates and exotic features, such as Bermudan cancelability. As a result, pricing such derivatives
via a PDE approach is computationally challenging.
The remainder of this paper is organized as follows. In Section 2, we present a three-factor cross-currency pricing
model with FX skew and two short rates which follow the one-factor Hull-White model [3] and then derive the
PDE for pricing cross-currency derivatives. Section 3 discusses discretization schemes for the pricing PDE and
two numerical methods for solving the discretized problem. The ﬁrst scheme employs Crank-Nicolson for the time
discretization while the solution of the linear system at each timestep is handled by the preconditioned Generalized
Minimal Residual (GMRES) method with a preconditioner solved by Fast Fourier Transform (FFT) techniques. The
second scheme uses the Alternating-Direction Implicit (ADI) method. The pricing of PRDC swaps with Bermudan
cancelable features is discussed in Section 4. Numerical results are provided in Section 5. Section 6 concludes the
paper and outlines possible future work.
2. The model and the associated PDE
We consider an economy with two currencies, “domestic” (d) and “foreign” ( f ). We denote by s(t) the spot FX
rate, the number of units of domestic currency per one unit of foreign currency. Let ri (t), i = d, f, denote the domestic
and foreign short rates respectively. Under the domestic risk-neutral measure, the dynamics of s(t), rd (t), r f (t) are
described by [2]
ds(t)
= (rd (t) − r f (t))dt + γ(t, s(t))dW s (t),
s(t)
(1)
drd (t) = (θd (t) − κd (t)rd (t))dt + σd (t)dWd (t),

dr f (t) = (θ f (t) − κ f (t)r f (t) − ρ f s (t)σ f (t)γ(t, s(t)))dt + σ f (t)dW f (t),
where Wd (t), W f (t), and W s (t) are correlated Brownian motions with dWd (t)dW s (t) = ρds dt, dW f (t)dW s (t) = ρ f s dt,
and dWd (t)dW f (t) = ρd f dt. The short rates follow the mean-reverting Hull-White model with the mean reversion
rate and the volatility functions respectively denoted by κi (t) and σi (t), for i = d, f , while θi (t), i = d, f , captures
the current term structures. The “quanto” drift adjustment, −ρ f s (t)σ f (t)γ(t, s(t)), for dr f (t) comes from changing the
measure from the foreign risk-neutral measure to the domestic risk neutral one. The functions κi (t), σi (t), θi (t), i = d, f,
are all deterministic. The local volatility function γ(t, s(t)) for the spot FX rate has the functional form [2]
s(t) ς(t)−1
,
(2)
L(t)
where ξ(t) is the relative volatility function, ς(t) is the time-dependent constant elasticity of variance (CEV) parameter
and L(t) is a time-dependent scaling constant which is usually set to the forward FX rate with expiry t, denoted by
F(0, t), for convenience in calibration.
γ(t, s(t)) = ξ(t)

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

2373
3

Before any model can be used, calibration of the model parameters to speciﬁc market data is required. The parameters deﬁning the volatility structures of interest rates in both currencies, i.e. the functions σi (t), κi (t), i = d, f , can be
bootstrapped from European swaption market values for the respective currencies, while θi (t), i = d, f , are determined
by the current term structures of bond prices in the respective currency. Correlation parameters are typically chosen
based on historical estimations. The calibration of the local volatility function can be done via forward FX options, as
suggested in [2].
We now give a PDE that the price of any security whose payoff is a function of the domestic and foreign interest
rates and the exchange rate must satisfy.
Theorem 1: Let u ≡ u(s, rd , r f , t) denote the domestic value function of a security with a terminal payoff measurable
with respect to the σ-algebra at maturity time T end and without intermediate payments. Furthermore, assume that
u ∈ C2,1 on R3+ × [T start , T end ), i.e. u is at least twice differentiable with respect to the space variables and differentiable
with respect to the time variable. Then on R3+ × [T start , T end ), u satisﬁes the PDE
∂u
∂u
∂u
∂u
∂u
+Lu ≡ +(rd −r f )s + θd (t)−κd (t)rd
+ θ f (t)−κ f (t)r f −ρ f s σ f (t)γ(t,s(t))
∂t
∂t
∂s
∂rd
∂r f
∂2 u 1
1
∂2 u 1
∂2 u
∂2 u
+ γ2 (t,s(t))s2 2 + σ2d (t) 2 + σ2f (t) 2 + ρds σd (t)γ(t,s(t))s
2
2
∂s∂rd
∂s
∂rd 2
∂r f
+ ρ f s σ f (t)γ(t,s(t))s

(3)

∂2 u
∂2 u
+ ρd f σd (t)σ f (t)
− rd u = 0
∂s∂r f
∂rd ∂r f

Proof: Under the domestic risk-neutral measure, the normalized price process of any security is a martingale. Since
it is an Itˆo process, it must have zero drift. Calculating the drift term using Itˆo’s formula and setting it to zero gives us
the PDE (3).
Since payoffs and fund ﬂows are deal-speciﬁc, we defer specifying the terminal conditions until a later section. The
difﬁculty with choosing boundary conditions is that, for an arbitrary payoff, they are not known. A detailed analysis
of the boundary conditions is certainly beyond the scope of this short paper, and is a topic of future research. For
this project, we only impose general approximate boundary conditions. We choose Dirichlet-type “stopped process”
boundary conditions where we stop the processes s(t), r f (t), rd (t) when any of the three hits the boundary. Thus, the
value on the boundary is simply the discounted payoff for the current values of the state variables [4].
Note that the PDE (3) is in terms of forward time, but, since we solve the PDE backward in time, the change of
variable τ = T end − t is used. Under this change of variable, the PDE (3) becomes ∂u
∂τ = Lu. The pricing of crosscurrency interest rate derivatives is deﬁned in an unbounded domain {(s, rd , r f , τ)|s ≥ 0, rd ≥ 0, r f ≥ 0, τ ∈ [0, T ]},
where T = T end − T start . In order to use Finite Difference (FD) approximations for space variables, we truncate the
unbounded domain into a ﬁnite-sized computational one {(s, rd , r f , τ) ∈ [0, S ] × [0, Rd ] × [0, R f ] × [0, T ]} ≡ Ω × [0, T ],
where S , R f , Rd are sufﬁciently large [5].
3. Discretization of the PDE
Let the number of subintervals be n + 1, p + 1, q + 1 and l + 1 in the s-, rd -, r f -, and τ-directions, respectively.
R
Rd
S
T
The uniform grid stepsizes in the respective directions are denoted by Δs = n+1
, Δrd = p+1
, Δr f = q+1f , and Δτ = l+1
.
m
The grid point values of a FD approximation are denoted by ui, j,k ≈ u(si , rd j , r f k , τm ) = u(iΔs, jΔrd , kΔr f , mΔτ), where
i = 1 . . . , n, j = 1 . . . , p, k = 1 . . . , q, m = 1 . . . , l + 1. Second-order FD approximations to the ﬁrst and second partial
derivatives of the space variables in (3) are obtained by central schemes, while the cross-derivatives are approximated
by a four-point FD stencil. For example, at the reference point (si , rd j , r f k , τm ), the ﬁrst and second derivatives with
∂2 u
respect to the spot FX rate s, i.e. ∂u
∂s and ∂s2 , are approximated by
m
m
∂u ui+1, j,k − ui−1, j,k
≈
,
∂s
2Δs

while the cross-derivative

∂2 u
∂s∂rd

m
m
m
∂2 u ui+1, j,k − 2ui, j,k + ui−1, j,k
≈
,
∂s2
(Δs)2

(4)

is approximated by
m
m
m
um
∂2 u
i+1, j+1,k + ui−1, j−1,k − ui−1, j+1,k − ui+1, j−1,k
≈
.
∂s∂rd
4ΔsΔrd

(5)

2374

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

4

Similar approximations can be obtained for the remaining spatial derivatives. For brevity, we omit the derivations of
(4) and (5), but, using Taylor expansions, it can be veriﬁed that each of these formulas has a second-order truncation
error, provided that the function u is sufﬁciently smooth. The FD discretization of the spatial differential operator L
of (3) is performed as follows. At the spatial grid Ω, each spatial derivative appearing in the operator L is replaced by
its corresponding FD scheme (as in (4) and (5)). We denote by Lum
i, j,k the FD discretization of L at (si , rd j , r f k , τm ).
3.1. The Crank-Nicolson scheme
To step from time τm−1 to τm , we apply the Crank-Nicolson scheme
m−1
um
i, j,k − ui, j,k

Δτ

=

1 m
1
Lu + Lum−1 ,
2 i, j,k 2 i, j,k

where i = 1, . . . , n, j = 1, . . . , p, k = 1, . . . , q. Unless otherwise stated, assume that the mesh points are ordered
in the s-, rd - , then r f - directions. Let um denote the vector of values at time τm on the mesh Ω that approximates
the exact solution um = u(s, rd , r f , τm ). The Crank-Nicolson method deﬁnes approximations um successively for
m = 1, 2, . . . , l + 1, by
1
1
1
(6)
(I − ΔτAm )um = (I + ΔτAm−1 )um−1 + Δτ(gm + gm−1 ),
2
2
2
where I denotes the npq × npq identity matrix and Am is the matrix of the same size as I arising from the FD
discretization of the differential operator L. For brevity, we omit the explicit formula for Am . However, it can
be written in a compact format using tensor products, similar to (7). The vectors gm−1 and gm are obtained from
the boundary conditions. Applying direct methods, such as LU factorization, to solve this linear system can be
very computationally expensive for several reasons: (i) the matrix I − 12 ΔτAm possesses a bandwidth proportional
to min{np, nq, pq}, depending on the ordering of the grid points, (ii) sparse solvers suffer considerable ﬁll-in when
solving systems derived from PDEs of the form (3), and (iii) this matrix needs to be factored at each timestep because
of its dependence on the timestep index m of the local volatility function.
3.1.1. GMRES with a preconditioner solved by FFT techniques
To avoid the high computational cost of direct methods, we choose to apply an iterative method to solve (6),
namely GMRES. We choose GMRES because I − 12 ΔτAm is neither symmetric nor positive (semi-) deﬁnite in general.
Thus, commonly used iterative schemes, such as the conjugate gradient method, designed primarily for symmetric
positive-deﬁnite systems, are not likely to converge. A detailed description of the GMRES method, and the “restarted”
version of the method, can be found in [6]. In our implementation, the initial guess for GMRES is based on linear
extrapolation of the numerical solution from the two previous timesteps, except for the ﬁrst timestep. It is important
to mention that, due to the use of this initial guess and the use of a preconditioner which is described below, only a
few iterations (usually 5 or 6 ) are required for the GMRES method to converge, hence no restarting is needed.
We use the matrix P arising from the discretization of
∂2 u ∂2 u ∂2 u
+
+
+u
∂s2 ∂rd2 ∂r2f
as the preconditioner. In the rest of the subsection, we describe an efﬁcient algorithm for solving linear systems of the
form Pv = b. The matrix P can be written in the following form using tensor products:
P=

1
1
1
(Iq ⊗ I p ⊗ Tn ) +
(Iq ⊗ T p ⊗ In ) +
(Tq ⊗ I p ⊗ In ) + I.
(Δs)2
(Δrd )2
(Δr f )2

(7)

Here, In denotes the identity matrix of size n × n and Tn denotes the tridiagonal matrix representation of the classic
second-order difference operator on n points. Note that the matrix Tn is a tridiagonal matrix with entries {1, −2, 1}
on each row except the ﬁrst and last rows, which are {−2, 1} and {1, −2}, respectively, due to Dirichlet boundary
conditions. Matrices T p and Tq are similar to Tn but of size p × p and q × q, respectively. It is known [7] that, if we
let Vn be the matrix of normalized eigenvectors of Tn and Fn be the Discrete Sine Transform (DST) matrix of order

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

2375
5

n, then we have V−1
n = Fn . Matrices V p and Vq are similar to Vn , and matrices F p and Fq are similar to Fn . A useful
observation is that P can be block-diagonalized via
−1
B = (V−1
q ⊗ V p ⊗ In )P(Vq ⊗ V p ⊗ In )
1
1
1
=
(Iq ⊗ I p ⊗ Tn ) +
(Iq ⊗ Λ p ⊗ In ) +
(Λq ⊗ I p ⊗ In ) + I,
(Δs)2
(Δrd )2
(Δr f )2

(8)

where Λn = V−1
n Tn Vn is a diagonal matrix with the eigenvalues of Tn on its diagonal. The matrix B has pq blocks,
each of size n×n. These observations give rise to the following fast solver for the preconditioner using FFT techniques,
more speciﬁcally, using Fast Sine Transforms (FSTs). (Note that the main computational requirement of an FST is
that of an FFT.) Consider the linear system Pv = b. Note that b ∈ Rnpq and for the sake of presentation, denote by
bq×pn the q × pn matrix with entries being the components of b laid out in q rows and pn columns, column by column.
Taking (8) into account, the solution v to the system Pv = b can be written as
−1
−1
−1
−1
v = P−1 b = (Vq ⊗ V p ⊗ In )B−1 (V−1
q ⊗ V p ⊗ In )b = (Fq ⊗ F p ⊗ In )B (Fq ⊗ F p ⊗ In )b.

(9)

The FST algorithm for performing the computation in (9) consists of the following steps:
1. Perform the FST on each of the pn columns of (b pn×q )T to obtain (b(1) )q×pn = Fq (b pn×q )T .
T
2. Perform the FST on each of the qn columns of ((b(1) )qn×p )T to obtain (b(2) ) p×qn = F p (b(1)
qn×p ) , or, equivalently
(2)
b = (Fq ⊗ F p ⊗ In )b.
3. Solve the block-diagonal system Bb(3) = b(2) .
(3)
T
4. Perform the inverse FST on each of the pn columns of ((b(3) ) pn×q )T to obtain (b(4) )q×pn = F−1
q ((b ) pn×q ) .
(4)
T
−1 (4)
T
5. Perform the inverse FST on each of the qn columns of (bqn×p ) to obtain v p×qn = F p (bqn×p ) , or equivalently
−1
−1
v = (F−1
q ⊗ F p ⊗ In )B (Fq ⊗ F p ⊗ In )b.
The above ﬁve steps form an FFT technique for solving the linear system Pv = b. Clearly, the ﬁve steps involve
O(npq log(npq)) ﬂops.
3.2. The ADI scheme
m
We decompose the matrix Am into four submatrices: Am = 3i=0 Am
i . Here, we choose the matrix A0 as the part
m
m
,
of A that comes from the FD discretization of the mixed derivative terms in (3), while the matrices Am
1 A2 and A3
m
are the three parts of A that correspond to the spatial derivatives in the s-, rd -, and r f -directions, respectively. The
m
m
term rd u in (3) is distributed evenly over Am
1 , A2 and A3 . The FD discretization for the spatial variable described in
m
m
(4) implies that if the grid points are ordered appropriately, then Am
1 , A2 and A3 are tridiagonal. (There is a different
m
m
m
ordering for each of A1 , A2 and A3 .) The following splitting scheme based on the Hundsdorfer and Verwer (HV)
approach [8] generates an approximation um to the exact solution um successively for m = 1, 2, . . . , l + 1:1
⎧
⎪
v0
⎪
⎪
⎪
⎪
⎪
1
⎪
m
⎪
⎪
(I − ΔτAi )vi
⎪
⎪
⎪
2
⎪
⎪
⎪
⎪
⎨
v0
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
1
⎪
⎪
⎪
(I − ΔτAm
⎪
i )vi
⎪
⎪
2
⎪
⎪
⎩
um

= um−1 + Δτ(Am−1 um−1 + gm−1 ),
1
1
m−1
= vi−1 − ΔτAm−1
um−1 + Δτ(gm
), i = 1, 2, 3,
i
i − gi
2
2
1
1
= v0 + Δτ(Am v3 − Am−1 um−1 ) + Δτ(gm − gm−1 ),
2
2
1
= vi−1 − ΔτAm
i = 1, 2, 3,
i v3 ,
2
= v3 .

m
Here, the vector gm is given by gm = 3i=0 gm
i where gi are obtained from boundary conditions corresponding to the
respective derivative terms. The above splitting scheme treats the mixed derivative part Am
0 in a fully explicit way
m
while the Am
i parts, i = 1, 2, 3, are treated implicitly. Since the matrices Ai , i = 1, 2, 3 are tridiagonal, the number of
ﬂoating point operations per time step is directly proportional to npq, which yields a big reduction in computational
cost compared to solving (6) by a direct method. The HV scheme has been proved to be unconditionally stable for
arbitrary spatial dimensions [8].
1 This

is the scheme (1.4) in [8] with θ = μ = 12 .

2376

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

6

4. Pricing PRDC swaps
For the past few years, PRDC swaps have been one of the most widely traded and liquid cross-currency exotics.
Readers are referred to [1] for a detailed discussion on the dynamics of PRDC swaps. PRDC swaps are essentially
long-dated (usually 30 years or more) swaps which pay FX-linked coupons in exchange for LIBOR ﬂoating-rate
payments. We investigate PRDC swaps from the perspective of the payer of PRDC coupons (the receiver of the
ﬂoating-rate payments).2 The other party of the deal is the investor (the receiver of the PRDC coupons). The ﬂoatingrate payments are termed the funding leg. Both the coupon rate and the ﬂoating rate are applied on the domestic
currency principal Nd . More speciﬁcally, suppose that we have the following tenor structure:
T 0 = 0 < T 1 < · · · < T β−1 < T β = T,

να = ν(T α−1 , T α ) = T α − T α−1 ,

α = 1, 2, . . . , β − 1.

Here, να represents the year fraction between T α−1 and T α using the Actual/365 day counting convention. The PRDC
coupon rate Cα of the coupon amount ναCα Nd issued at time T α for the period [T α , T α+1 ], α = 1, 2, . . . , β − 1, has the
following structure:
s(T α )
Cα = min max c f
− cd , b f , bc ,
α = 1, . . . , β − 1.
(10)
fα
Here, s(T α ) is the spot FX rate at time T α ; cd and c f are domestic and foreign coupon rates; b f and bc are the ﬂoor
and cap of the payoff. The scaling factor fα usually is set to the forward FX rate F(T 0 ,T α ). All parameters can vary
from coupon to coupon (i.e. they may depend on T α , α = 1, . . . , β − 1). In the standard structure, in which b f = 0 and
c
bc = ∞, by letting hα = fαf and kα = fαccf d , the coupon rate Cα can be viewed as a call option on spot FX rates, since
Cα = hα max(s(T α ) − kα , 0).

(11)

In (11), the option notional hα determines the overall level of the coupon payment, while the strike kα determines
the likelihood of the positiveness of the coupon. It is important to emphasize that, if the strike kα is low, the coupon
has a relatively high chance of paying a positive amount. However, in this case, the option notional hα is typically
chosen to be low and thus the overall level of a coupon payment is small. This is a low-leverage situation. On the
other hand, if both kα and hα are high, then we have a high-leverage situation.
β−1
for the period [T α−1 , T α ], where Ld (T α−1 ,T α )
The funding leg pays the amount να Ld (T α−1 ,T α )Nd at time {T α }α=1
denotes the domestic LIBOR rates for the period [T α−1 , T α ], as observed at time T α−1 . Note that Ld (T α−1 , T α ) is set at
time T α−1 , but the actual ﬂoating leg payment for the period [T α−1 , T α ] does not occur until time T α , i.e. “in arrears”.
There is an initial ﬁxed-rate coupon paid to the investor that is not included in the above deﬁnition as its valuation is
straightforward.
Since a “vanilla” PRDC swap can be seen as a collection of simple FX options with different maturities (see (11)),
its valuation is relatively simple. Let ucα (t) and uαf (t) be the value at time t of all PRDC coupons and ﬂoating payments,
respectively, of the “vanilla” PRDC swap scheduled on or after T α+1 . The value uαf (t) can be obtained using the “ﬁxed
notional” method and not by solving the PDE. The payoff of the coupon part at each {T α }β−2
α=1 is
ucα (T α ) + ναCα Nd .

(12)

The value of the payoff (12) at time T α−1 can be obtained by solving backward in time the PDE (3) from T α to T α−1 ,
with terminal condition (12). The time iteration for the coupon part starts at the time T β−1 with
ucβ−1 (T β−1 ) = νβ−1Cβ−1 Nd ,
and by progressing backward in time to T 0 , we obtain uc0 (T 0 ). The value of the “vanilla” PRDC swap is u0f (T 0 )−uc0 (T 0 ).
It is important to emphasize that variations of PRDC swaps with exotic features, such as Bermudan cancelable (or
cancelable for short), are much more popular than “vanilla” PRDC swaps. Cancelable PRDC swaps give the payer of
2 Usually,

the payer of PRDC coupons is a bank.

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

2377
7

3
the coupons the right to cancel the swap at any of the dates {T α }β−1
α=1 . Such features are designed to limit the downside
risk arising from excessive movements in spot FX rate for the payer.
The key observation in valuing cancelable swaps is that terminating a swap is the same as (i) continuing the original
swap and (ii) entering into the offsetting swap. Since the payer has the option to cancel the PRDC swap on any of
the dates {T α }β−1
α=1 , we can regard a cancelable PRDC swap as a “vanilla” PRDC swap with the same tenor structure,
referred to as the underlying swap, plus a long position in a Bermudan swaption, the underlying swap of which is a
“vanilla” swap with the same tenor structure, but involves coupons being received and domestic ﬂoating payments
being paid. We refer to this Bermudan swaption and its underlying swap as the offsetting Bermudan swaption and the
offsetting swap, respectively. Denote ueα (t) the value at time t of all fund ﬂows in the offsetting swap scheduled on or
after T α+1 . Let uhα (t) be the value at time t of the offsetting Bermudan swaption that has only the dates {T α+1 , . . . , T β−1 }
as exercise opportunities. Assume optimal exercise at each of {T α }β−1
α=1 , i.e. the coupon payer will exercise the offsetting
Bermudan swaption at T α if and only if the value ueα (T α ) (the “exercise value”) exceeds the value uhα (T α ) (the “hold
value”) of the option. Thus the payoff of the offsetting Bermudan swaption at each T α is

max(uhα (T α ), ueα (T α )).
We can progress backward in time in the same fashion as described above for a “vanilla” PRDC swap, starting with
uhβ−1 (T β−1 ) = ueβ−1 (T β−1 ) = 0.
Note that the value ueα (T α ) can be computed by ueα (T α ) = −(uαf (T α ) − ucα (T α )). The value of the cancelable PRDC swap
is uh0 (T 0 ) + (u0f (T 0 ) − uc0 (T 0 )).
5. Numerical results
We consider the same short rate models, correlation parameters, and local volatility function for the spot FX
rate as given in [2]. In this cross-currency example, the Japanese yen (JPY) and the U.S. dollar (USD) are the
domestic and foreign currencies, respectively. Their interest rate curves given by Pd (0, T ) = exp(−0.02 × T ) and
P f (0, T ) = exp(−0.05 × T ), where Pd (0, T ) and P f (0, T ) denote the current market values in domestic and foreign
currency of a bond with maturity T , respectively. The volatility parameters for the short rates and correlations are
given by σd (t) = 0.7%, κd (t) = 0.0%, σ f (t) = 1.2%, κ f (t) = 5.0%, ρd f = 25.0%, ρds = −15.0%, ρ f s = −15.0%. The
initial spot FX rate is set to s(0) = 105.00. The parameters ξ(t) and ς(t) of the local volatility function are assumed to
be piecewise constant and given in the following table.
period
(years)
(0 0.5]
(0.5 1]
(1 3]
(3 5]
(5 7]

(ξ(t))
9.03%
8.87%
8.42%
8.99%
10.18%

(ς(t))
-200%
-172%
-115%
-65%
-50%

period
(years)
(7 10]
(10 15]
(15 20]
(20 25]
(25 30]

(ξ(t))
13.30%
18.18%
16.73%
13.51%
13.51%

(ς(t))
-24%
10%
38%
38%
38%

Note the parameters θi (t), i = d, f , associated the domestic and foreign short rates are fully determined by the above
information [9]. We consider a PRDC swap that has following features:
- Tenor structure: να = T α − T α−1 = 1 (year), α = 1, . . . , β − 1 and β = 30 (years).
- Pay annual PRDC coupons and receive annual domestic LIBOR payments.
- Standard structure, i.e. b f = 0, bc = +∞. The scaling factor { fα }β−1
α=1 is set to F(0, T α ).
β−1
.
- Bermudan cancelable, which allows the payer to cancel the swap on each of {T α }α=1
β−1

3 Another popular exotic feature is the knock-out provision, which stipulates that the swap terminates if the FX rate on any of the dates {T }
α α=1
exceeds a speciﬁed level.

2378

leverage

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

m

n

p

q

4
8
16
32
4
medium 8
16
32
4
high
8
16
32

12
24
48
96
12
24
48
96
12
24
48
96

6
12
24
48
6
12
24
48
6
12
24
48

6
12
24
48
6
12
24
48
6
12
24
48

low

8

underlying swap
cancelable swap
performance
ADI – GMRES
ADI
GMRES
value (%) change ratio value(%) change ratio time (s) time (s) avg. iter.
-11.41
11.39
0.78
1.19
5
-11.16
2.5e-3
11.30
8.6e-4
8.59
12.27
6
-11.11
5.0e-4 5.0
11.28
1.7e-4 5.0
166.28 253.35
6
-11.10
1.0e-4 5.0
11.28
4.1e-5 4.1 3174.20 4882.46
6
-13.87
13.42
-12.94
9.3e-3
13.76
3.3e-3
-12.75
1.9e-3 4.7
13.85
9.5e-4 3.5
-12.70
5.0e-4 3.9
13.88
2.6e-4 3.6
-13.39
18.50
-11.54
1.8e-2
19.31
8.1e-3
-11.19
3.5e-3 5.2
19.56
2.5e-3 3.2
-11.12
8.0e-4 4.3
19.62
5.4e-4 4.6

Table 1: Values of the underlying PRDC swap and cancelable PRDC swap with FX skew for various leverage levels; “change” is the difference in
the solution from the coarser grid; “ratio” is the ratio of the changes on successive grids; “avg. iter.” is the average number of iterations.

- The domestic and foreign coupons are chosen to provide different levels of leverage: low (cd = 2.25%, c f =
4.50%), medium (cd = 4.36%, c f = 6.25%), high (cd = 8.1%, c f = 9.00%).
Note that the forward FX rate F(0, T α ) can be obtained from the domestic and foreign interest rate curves via the
well-known formula
P f (0, T α )
s(0),
F(0, T α ) =
Pd (0, T α )
which follows from no-arbitrage arguments. The domestic LIBOR rate Ld (T α−1 , T α ), as observed at time T α−1 for the
maturity T α , can be computed by
1 − Pd (T α−1 , T α )
.
Ld (T α−1 , T α ) =
ν(T α−1 , T α )Pd (T α−1 , T α )
The truncated computational domain Ω is deﬁned by setting S = 3s(0) = 315, Rd = 3rd (0) = 0.06, and R f =
3r f (0) = 0.15. For the GMRES method, the tolerance is 10−5 . Selected numerical results are presented in Table 1.
Grid sizes indicated in Table 1 are for each period [T α−1 , T α ], α = 1, . . . , β − 1. The values of swaps are expressed
as a percentage of the notional Nd . In terms of accuracy, both the ADI and the preconditioned GMRES methods give
identical prices to four digits of accuracy for the underlying PRDC swap and the cancelable PRDC swap. (Hence,
we do not present prices obtained by the two methods separately to save space in the table.) As expected from
the discretization methods, second-order accuracy is obtained. Since for different leverage levels, the computation
times of the methods considered are virtually the same, we report only the selected computation statistics for the
low leverage case in the last three columns of Table 1 obtained from pricing the underlying PRDC swap. We note
that, asymptotically, for each doubling of the number of timesteps and gridpoints in all directions, both the ADI
and GMRES computation times increase by a factor of about 19, which is close to the optimal factor of 16. It is
also evident the ADI method is modestly more efﬁcient than the GMRES method, in absolute terms. It is worth
noting that the average number of iterations required by the GMRES method per timestep is quite small, and more
importantly, is independent of the size of discretized problem. These results show the combined effect of using an
effective preconditioner and a good initial guess based on linear extrapolation.
To investigate the effects of the FX skew, we compare our numerical results with those obtained under the lognormal model, where the local volatility function is a deterministic function of only the time variable. To this end, we
used the parametrization as in (2) but independent of s(t) for the log-normal local volatility function, and calibrated
it to the same at-the-money FX option data (Table A of [2]) that was used for the calibration of the skew model. Our
experiments show that the values under the log-normal model corresponding to the ﬁnest mesh in Table 1 for the
three leverage levels are −9.01, −9.67, and −9.85, respectively, for the underlying PRDC swap; for the cancelable

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

2379
9

PRDC swap, the values are 13.31, 16.89, and 22.95, respectively. First, we consider the effect of the FX skew on
the underlying PRDC swap. Negative values of the underlying swap indicate the price that the investor has to pay to
the coupon payer to enter into a “vanilla” PRDC swap. It is important to emphasize that due to the rate differential
between JPY and USD, the forward FX curve is strongly downward sloping, hence in (11), fα is considerably smaller
than s(T α ). Thus the coupon payer essentially shorts a collection of FX call options with low strikes. (For the low,
medium, and high leverage cases, the strike kα is set to 50%, 70% and 90% of fα , respectively.) The numerical results
indicate that the prices of the underlying swap under the skew model are more negative than the prices under the lognormal model (for example, −11.10 versus −9.01). These results are expected, since, in a skew model, the implied
volatility increases for low-strike options, resulting in higher prices for the options and hence pushes down the value
of the underlying swap for the payer. However, the effect of the skew is not uniform across the leverage levels. The
effect seems most pronounced for the medium-leverage swaps. An explanation for this observation is that the total
effect is a combination of the change in implied volatility and the sensitivities (the Vega) of the options’ prices to that
change. Due to the skew, the lower the strikes are, the higher the implied volatility changes are. Thus, among the
three leverage levels, the volatilities change the most for the low-leverage swaps, since the strikes of the coupon rates
are the lowest in this case. However, it is important to note that the Vega of an option is an increasing function of the
strike [10]. Thus, the Vega of low-leverage options is the smallest, since the strikes for coupon rates are the lowest.
As a result, the combined effect is limited. The situation is reversed for high-leverage swaps, while the combined
effect is the most pronounced for medium-leverage swaps. For cancelable PRDC swaps, the impact of the FX skew
is increasing across the leverage levels. The positive values of the cancelable swap indicate the level of the initial
ﬁxed coupon that the payer is willing to pay to the investor to enter the cancelable PRDC swap. Under both skew and
log-normal models, a high-leverage cancelable PRDC swap provides more attractive initial coupons to the investor.
It is important to note that the prices of the underlying PRDC swap and the cancelable PRDC swap are pushed
down under the FX skew model as compared to those obtained by the log-normal model. These changes in values
are quite signiﬁcant and are considered as proﬁts for the payer when a FX skew is incorporated. In other words, not
accounting for the FX skew can result in a loss, a fact that indicates the importance of having a proper skew model for
pricing and risk managing PRDC swaps.
6. Summary and future work
We have proposed a general PDE pricing framework for exotic cross-currency interest rate derivatives under a FX
skew model, with strong emphasis on Bermudan cancelable PRDC swaps. Over each period of the tenor structure, we
partition the pricing of Bermudan cancelable PRDC swaps into two entirely independent pricing subproblems: (i) the
pricing of the underlying PRDC swap and (ii) the pricing of an associated Bermudan swaption, each of which can be
solved efﬁciently. We consider two numerical methods for the solution of each of the subproblems. Both methods are
built upon second-order central FD on uniform grids for the discretization of the space variables and differ primarily
in the temporal discretization, with one method using the Crank-Nicolson discretization and the other using the levelsplitting ADI method. In the former case, the GMRES method is employed for the solution of the resulting block
banded linear system at each time step, with the preconditioner solved by FFT techniques. Experimental results verify
that our methods are second-order, and that ADI scheme is modestly faster than the other method. Preliminary analysis
shows that cancelable PRDC swaps are very sensitive to the FX volatility skew, which highlights the importance of
having a realistic FX skew model for pricing and risk managing PRDC swaps.
A possible extension of this work is to use non-uniform meshes reﬁned around the initial FX and the initial short
rates to improve the performance of the numerical methods. In this case, a different fast solver for the preconditioner
needs to be developed and the stability of the ADI method on a non-uniform mesh needs to be studied.
From a modeling perspective, due to the sensitivity to the FX volatility skew of the PRDC swaps with exotic
features, it is highly desirable to have a mechanism that more accurately approximates the observed FX volatility
skew. This could possibly be achieved by incorporating stochastic volatility into the spot FX rate model so that the
market-observed FX volatility smiles are more accurately simulated. This enrichment to the current model leads to
a time-dependent PDE in four state variables — the spot FX rate, domestic and foreign short rates, and volatility. In
such a application, numerical methods presented in this paper could be easily extended to cope with an extra spatial
dimension, but the computational work required to solve the extended problem would likely rise signiﬁcantly. Possibly

2380

D.M. Dang et al. / Procedia Computer Science 1 (2012) 2371–2380

D. M. Dang, C. C. Christara, K. R. Jackson, A. Lakhany / Procedia Computer Science 00 (2010) 1–10

10

an effective parallel numerical method could be developed to solve the extended problem in an acceptable amount of
time.
Acknowledgment
This research was supported in part by the Natural Sciences and Engineering Research Council (NSERC) of
Canada. The ﬁrst author would like to thank Vicky Huang, formerly at Algorithmics Inc., Toronto, for helping with
the spreadsheet that illustrates the dynamics of PRDC swaps.
References
[1] J. Sippel, S. Ohkoshi, All power to PRDC notes, Risk 15 (11) (2002) 31–33.
[2] V. Piterbarg, Smiling hybrids, Risk 19 (2) (2005) 66–70.
[3] J. Hull, A. White, One factor interest rate models and the valuation of interest rate derivative securities, Journal of Financial and Quantitative
Analysis 28 (2) (1993) 235–254.
[4] M. Dempster, J. Hutton, Numerical valuation of cross-currency swaps and swaptions, Cambridge University Press, 1997.
[5] H. Windcliff, P. A. Forsyth, K. R. Vetzal, Analysis of the stability of the linear boundary condition for the Black-Scholes equation, Journal of
Computational Finance 8 (2004) 65–92.
[6] W. Hackbush, Iterative Solution of Large Sparse Systems of Equations, Springer, 1993.
[7] C. V. Loan, Computational Frameworks for the Fast Fourier Transform, Society for Industrial and Applied Mathematics, 1992.
[8] K. in’t Hout, B. Welfert, Unconditional stability of second-order ADI schemes applied to multi-dimensional diffusion equations with mixed
derivative terms, Applied Numerical Mathematics 59 (2009) 677–692.
[9] D. Brigo, F. Mercurio, Interest Rate Models - Theory and Practice, 2nd Edition, Springer, 2006.
[10] J. C. Hull, Options, Futures, and Other Derivatives, sixth Edition, Prentice Hall, 2006.

