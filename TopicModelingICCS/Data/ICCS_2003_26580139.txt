A Symplectic Lanczos-Type Algorithm to
Compute the Eigenvalues of Positive Deﬁnite
Hamiltonian Matrices
Pierluigi Amodio
Dipartimento di Matematica, Universit`
a di Bari,
Via E. Orabona 4, I-70125 Bari, Italy,
amodio@dm.uniba.it

Abstract. The Lanczos algorithm is a well known procedure to compute
few eigenvalues of large symmetric matrices. We slightly modify this
algorithm in order to obtain the eigenvalues of Hamiltonian matrices H =
JS with S symmetric and positive deﬁnite. These matrices represent a
signiﬁcant subclass of Hamiltonian matrices since their eigenvalues lie on
the imaginary axis. An implicitly restarted procedure is also considered
in order to speed-up the convergence of the algorithm.

1

Introduction

Many applications require the numerical approximation of the eigenvalues of a
2n × 2n real Hamiltonian matrix H = JS where
J=

O In
−In 0

and S is a large and sparse symmetric matrix. As an example, we cite the solution
of the continuous-time algebraic Riccati equations [9,11] of the form
Q + AT X + XA − XGX = 0,
where A, G and Q are known n × n matrices, G and Q symmetric, and the
solution X is also symmetric.
It is well known that the considered eigenvalues are symmetric with respect
to the real and imaginary axes. In this paper we are particularly interested in a
subclass of Hamiltonian matrices where S is symmetric and positive deﬁnite. In
this case the eigenvalues lie (two by two symmetrically with respect to the origin)
along the imaginary axis. These matrices arise in many application ﬁelds that
deal with evolutionary problems whose solutions satisfy a certain conservation
law, typically the energy of the system (see, for example, [5]). In the rest of the
paper we refer to these matrices as positive deﬁnite Hamiltonian matrices [2].
All the numerical methods for the eigenvalues computation of Hamiltonian
matrices use symplectic transformations in order to maintain the Hamiltonian
Work supported by GNCS.
P.M.A. Sloot et al. (Eds.): ICCS 2003, LNCS 2658, pp. 139–148, 2003.
c Springer-Verlag Berlin Heidelberg 2003

140

P. Amodio

structure of the matrix. In fact, if P is symplectic (that is, P T JP = J) and H
is Hamiltonian, then also P −1 HP is Hamiltonian. For this reason, most of the
existing algorithms are symplectic modiﬁcations of more general approaches as,
for instance, the symplectic QR method in [6,7,13] and the symplectic iterative
methods [3,4].
In particular, the symplectic Lanczos algorithm in [4] where the directions
generated by the procedure are symplectic rather than orthogonal, is strictly
related to the method introduced in this paper. The idea inherited this algorithm
is the following: let
S=

S11 S12
T
S12
S22

with S11 and S22 symmetric, the matrix H may be represented in the form
H=

T
S12
S22
−S11 −S12

≡

V W
Z −V T

.

The approach in [4], as well as those in [1,10] which deﬁne canonical forms for
the Hamiltonian matrices, transform the above matrix in
V1 W1
−V1T
with V1 triangular and V1 and W1 having few nonnull diagonals. This is called
a Hamiltonian triangular form for the matrix H.
Conversely, based on a theoretical result in [2], for positive deﬁnite Hamiltonian matrices we derive a canonical form (W2 tridiagonal)
−I

W2

by means of a transformation that we prove to be symplectic. We will explain
how to derive this form in Section 2. Then in Section 3, following the results
presented in [4,8], we derive an implicit restarting technique that can be easily
applied to the considered class of matrices.

2

Tridiagonal Canonical Form

In [2] existence results on a diagonal form for Hamiltonian matrices H = JS with
S positive deﬁnite is given. In the same paper, this result is also rearranged in
order to obtain the following symplectic transformation in the simplest canonical
form.
Theorem 1. Given a real Hamiltonian matrix H = JS with S symmetric and
positive deﬁnite, a real symplectic matrix Z exists such that
HZ = Z
with D1 > 0 diagonal.

−D1

D1

≡ ZJ

D1

D1

(1)

A Symplectic Lanczos-Type Algorithm to Compute the Eigenvalues

141

Even if the proof of Theorem 1 is presented in [2], it is interesting to sketch
its main steps. As a remark, we recall that:
– if A is a symmetric matrix, then all the eigenvalues are real and an orthogonal
matrix U exists such that
AU = U Λ;
– if A is a skew-symmetric matrix, then all the eigenvalues are pure imaginary
and a unitary matrix U = [U1 U 1 ] exists such that
AU = iU
Moreover, from V =

√

Λ1

−Λ1

.

2[Re(U1 ) Im(U1 )] one has

AV = V J

Λ1

Λ1

,

V T V = I,

that is, a skew-symmetric matrix is similar to a positive deﬁnite Hamiltonian
matrix by means of an orthogonal matrix.
Proof. Let us start from the decomposition of the symmetric and positive deﬁnite
matrix S in diagonal form, that is S = QΛQT , with Q orthogonal and Λ positive.
Then
(JS)JQ = (JQΛQT )JQ = JQ(ΛQT JQ)
shows that JS is similar to ΛQT JQ by means of the transformation matrix
JQ. Now, since the matrix Λ1/2 QT JQΛ1/2 is skew-symmetric, it will admit the
following similarity transformation
Λ1/2 QT JQΛ1/2 = V J

D1

D1

V T,

(2)

and hence
ΛQT JQ = Λ1/2 Λ1/2 QT JQΛ1/2 Λ−1/2 = (Λ1/2 V )J

D1

D1

(Λ1/2 V )−1 .

Let U = JQΛ1/2 V . One has that
U T JU = −(V T Λ1/2 QT J)J(JQΛ1/2 V ) = V T Λ1/2 QT JQΛ1/2 V
D1
D1
= V TV J
V TV = J
D1
D1
and therefore the matrix
Z=U

−1/2

D1

−1/2
D1

is symplectic and satisﬁes (1).

= JQΛ1/2 V

−1/2

D1

−1/2

D1

142

P. Amodio

Equation (1) allows us to easily obtain the eigenvalues of JS as iλj and
−iλj , where λj is a diagonal element of D1 . On the other hand, as it occurs in
the case of symmetric matrices, the above theorem cannot be used to compute
the eigenvalues numerically. For this reason, diﬀerent approaches need to be
introduced.
We now observe that −S 1/2 JSJS 1/2 is symmetric and positive deﬁnite, then
it is possible to apply to this matrix the Lanczos algorithm, that is one should
compute a matrix Zk+1 = [Zk zk+1 ] which is deﬁned by means of k+1 orthogonal
columns and a tridiagonal matrix Tk such that
−S 1/2 JSJS 1/2 Zk = Zk Tk + βk+1 zk+1 eTk ,
where ek is the last unit vector of IRk . Then, from Vk+1 = S −1/2 Zk+1 =
[Vk vk+1 ], one has
− H 2 Vk = Vk Tk + βk+1 vk+1 eTk

(3)

with Vk of size 2n × k and such that
VkT SVk = Ik .

(4)

If −iλj , for j = 1, . . . , n, are the eigenvalues of H, then the eigenvalues of H 2
are −λ21 , −λ21 , −λ22 , −λ22 , . . . , that is, H 2 has double eigenvalues with a subspace
of size 2 associated. This means that, if no breakdown has previously occurred,
this algorithm theoretically will stop after n steps, providing a tridiagonal symmetric and positive deﬁnite matrix T . In fact, from
− H 2 V = V T,

V T SV = In ,

(5)

one has
−V T SH 2 V = V T SV T = T
and −SH 2 is symmetric and positive deﬁnite.
Hence the eigenvalues of H 2 may be obtained applying an algorithm for symmetric and positive deﬁnite matrices to a half sized matrix T . Unfortunately, the
decomposition (3)-(4) is not stable and can be only used to compute a limited
number of extremal eigenvalues. Otherwise, it needs continue reorthogonalizations which make necessary to store all the columns of V.
Anyway, from a theoretical point of view, we derive the following symplectic
transformation which is numerically more reliable than that deﬁned in Theorem
1.
Theorem 2. Given a real Hamiltonian matrix H = JS with S symmetric and
positive deﬁnite, a real symplectic matrix U exists such that
HU = U

−I

T

≡ UJ

I

T

with T symmetric and positive deﬁnite tridiagonal matrix.

A Symplectic Lanczos-Type Algorithm to Compute the Eigenvalues

143

Proof. Let
W = −HV,

(6)

HW = V T

(7)

from (5) one has

and, consequently,
H[V W ] = [−W V T ] = [V W ]

−I

T

.

(8)

The matrix U = [V W ] is symplectic, that is
U T JU =

V T JV V T JW
W T JV W T JW

= J.

In fact, from (6) one has JW = SV and
V T JW = V T SV = I.
Moreover, V T JV = O since each column vi of V may be expressed in terms of
an even polynomial of degree 2(i − 1) in H, that is vi = pi−1 (H 2 )v1 , and for any
integers i and l
viT Jvl = v1T (pi−1 (H 2 ))T Jpl−1 (H 2 )v1 = v1T (pi+l−1 (H))T Jpi+l−1 (H)v1 = 0
being, for any vector v of appropriate length, v T Jv = 0. Finally, W T JW = O
for a similar reasoning.
The above theorem states that U transforms the matrix H in a matrix
J

I

T

which corresponds to the tridiagonal form of symmetric matrices. This is the
simplest canonical transformation which can be computed for Hamiltonian matrices and proves the existence of a canonical form for positive deﬁnite Hamiltonian matrices which is slightly diﬀerent from the one obtained in Theorem 1. In
fact, from T = Q1 D12 QT1 , with D1 diagonal and Q1 orthogonal, it results that
diag(Q1 , Q1 ) is symplectic and
QT1

QT1

−I

T

Q1

Q1

=

−I

D12

≡J

I

D12

.

Now we derive an algorithm for the computation of matrices U and T in
Theorem 2. Let Vk = [v1 , . . . , vk ] and

144

P. Amodio



α1 β2






 β2 α2 . . .
,

Tk = 

.
.
.. .. β 

k
βk αk

(9)

the generic row of (3) is
−H 2 vj = βj vj−1 + αj vj + βj+1 vj+1
and allows us to compute vj+1 . The coeﬃcient βj is computed in order to have
vjT Svj = 1, while αj derives from
0 = vjT Svj+1 =

1
βj+1

(vjT SHwj − αj ) =

1
βj+1

(−vjT H T Swj − αj ),

where wj = −Hvj in analogy with (6).
The complete algorithm to obtain the tridiagonal form is the following:
v˜1 arbitrary
v1T S˜
v1 )1/2
β1 = (˜
for j = 1, 2, . . . , n
vj = v˜j /βj
wj = −Hvj
αj = wjT Swj
if j = 1
v˜j+1 = Hwj − αj vj
elseif j < n
v˜j+1 = Hwj − αj vj − βj vj−1
end
T
βj+1 = (˜
vj+1
S˜
vj+1 )1/2
if βj+1 = 0, stop
end
We observe that αj > 0 and βj ≥ 0. The algorithm stops before n steps if
βj = 0 (i.e., v˜j = 0), that is, when v˜1 belongs to an invariant subspace of H 2 .
The vectors wj need not to be stored, while the vj are required for any reorthogonalization. If the above algorithm is applied to matrices JS with S nondeﬁnite,
then v˜jT S˜
vj should be less than zero and the procedure breaks. A modiﬁcation
of the algorithm in order to overcome this problem will be investigated in future.

3

Implicit Restarting

As observed previously, the Lanczos method is widely used to compute only a
small subset of the eigenvalues. In this case, the algorithm is stopped after a ﬁxed

A Symplectic Lanczos-Type Algorithm to Compute the Eigenvalues

145

number k of iterations, then it restarts with a diﬀerent initial vector v1 obtained
by the performed iterations. The idea is just to compute the new starting vector
in order to obtain, after k steps, βk+1 = 0, that is an invariant subspace which
allows us to compute k eigenvalues.
The implicit restarted Lanczos algorithm shows several advantages since the
storage requirement is ﬁxed, there are no spurious eigenvalues, and deﬂation
techniques similar to those applied to the QR algorithm may be applied [8].
As an example, we now analyze how it is possible to apply this technique to
the Lanczos algorithm described in the previous section. Let us start from k + 2
steps of equation (3)
−H 2 Vk+1 = Vk+1 Tk+1 + βk+2 vk+2 eTk+1 ,
where ek+1 represents the last unit vector of IRk+1 . Then, for a given real parameter µ and from Tk+1 − µI = QR we have the following equalities
(−H 2 − µI)Vk+1 = Vk+1 (Tk+1 − µI) + βk+2 vk+2 eTk+1
(−H 2 − µI)Vk+1 = Vk+1 QR + βk+2 vk+2 eTk+1
(−H 2 − µI)(Vk+1 Q) = (Vk+1 Q)RQ + βk+2 vk+2 eTk+1 Q
−H 2 (Vk+1 Q) = (Vk+1 Q)(RQ + µI) + βk+2 vk+2 eTk+1 Q

(10)

where RQ + µI is a symmetric and positive deﬁnite tridiagonal matrix. The last
equation cannot be however considered as obtained by a Lanczos procedure since
βk+2 eTk+1 Q = [βk+1 eTk βk+2 ],

(11)

that is, it has two elements diﬀerent from zero (instead of one, see (9)). Anyway,
equation (10) is useful to deﬁne the vector v1+ = (Vk+1 Q)e1 (e1 is the ﬁrst unit
vector of IRk+1 ) as the starting vector of the new Lanczos iterations. Its relation
with v1 is
(−H 2 − µI)v1 = ρ1 v1+
where ρ1 is the (1,1) element of R, is obtained by applying the second equation
of (10) to e1 and from Re1 = ρ1 e1 .
Let us now partition the matrices Vk+1 Q = [Vk+ v˜k+1 ] and
RQ + µI = QT Tk+1 Q =

Tk+ βk+1 ek
βk+1 eTk αk+1

.

Substitution of (11) and (12) in the last equation of (10) gives


Tk+ βk+1 ek


− H 2 [Vk+ v˜k+1 ] = [Vk+ v˜k+1 vk+2 ]  βk+1 eTk αk+1  .
βk+1 eTk βk+2
The ﬁrst k columns of (13) may be rewritten in the form

(12)

(13)

146

P. Amodio

+
+
vk+1
eTk
− H 2 Vk+ = Vk+ Tk+ + βk+1

(14)

where
+
=
vk+1

1

˜k+1
+ (βk+1 v
βk+1

+ βk+1 vk+2 )

+
+
+
is such that (vk+1
)T Svk+1
= 1. Hence equation (14) represents the
and βk+1
implicit application of k steps of the Lanczos algorithm to the starting vector
v1+ .
This technique may be iterated. Starting from (14), we repeat one additional
step of the Lanczos iteration and then again the implicit method until βk+1 ≈ 0.
The application of p shifts µ1 , µ2 , . . . , µp is straightforward and is used to
speed-up the computation of k eigenvalues simultaneously. We summarize its
use in the following algorithm.

compute v1 , . . . , vk , v˜k+1 , α1 , . . . , αk , β2 , . . . , βk+1 by
means of k steps of the Lanczos algorithm
while |βk+1 | is greater than a ﬁxed tolerance
compute vk+1 , . . . , vk+p , v˜k+p+1 , αk+1 , . . . , αk+p ,
βk+2 , . . . , βk+p+1 by means of p additional steps
of the Lanczos algorithm
vk+p+1 = v˜k+p+1 /βk+p+1
construct the matrix Tk+p as in (9)
choose the parameters µ1 , µ2 , . . . , µp
Q = Ik+p ; T = Tk+p
for i = 1, . . . , p
Qi Ri = T − µi I
T = QTi T Qi
Q = QQi
end
deﬁne qk+p,k as the (k + p, k) element of Q
deﬁne βk+1 as the (k + 1, k) element of T
βk+p+1 = βk+p+1 qk+p,k
[Vk+ Vp ] = Vk+p Q
deﬁne vˆk+1 as the ﬁrst column of Vp
deﬁne v1 , . . . , vk as the k columns of Vk+
v˜k+1 = βk+1 vˆk+1 + βk+p+1 vk+p+1
deﬁne α1 , . . . , αk and β2 , . . . , βk as the main diagonal
and the lower diagonal of T
βk+1 = (˜
vk+1 S˜
vk+1 )1/2
end

A Symplectic Lanczos-Type Algorithm to Compute the Eigenvalues

147

The matrix-by-matrix operations are not expensive since k and p are small
with respect to n. This means that the computational cost of the overall algorithm depends only on the number of iterates in the Lanczos method.
The choice of the parameters µj gives rise to diﬀerent strategies. For example,
if we set µj , j = 1, . . . , p, as p of the eigenvalues of Tk+p , that is, if we use the
exact shift selection strategy [12], then T has the following structure
Tk+

Dp

,

where Dp is diagonal with µ1 , . . . µp as main diagonal entries. This strategy gives
good results, especially when used to compute the largest eigenvalues in modulus
of the positive deﬁnite Hamiltonian matrix.

4

Conclusions

The Lanczos process has been modiﬁed in order to compute the eigenvalues of
positive deﬁnite Hamiltonian matrices. The obtained algorithm is symplectic
and requires half of the workspace of the original algorithm. Moreover, since
the procedure gives a symmetric and positive deﬁnite matrix, known techniques
for this class of matrices (for example, the implicit restarting) can be used to
improve the computation.

References
1. Ammar, G., Mehrmann, V.: On Hamiltonian and symplectic Hessenberg forms.
Linear Algebra Appl. 149 (1991), 55–72
2. Amodio, P., Iavernaro, F., Trigiante, D.: Conservative perturbations of positive
deﬁnite Hamiltonian matrices, Numer. Linear Algebra Appl., (2003), in press
3. Benner, P.: Symplectic balancing of Hamiltonian matrices, SIAM J. Sci. Comput.,
22 (5) (2001), 1885–1904
4. Benner, P., Faßbender, H.: An implicit restarted symplectic Lanczos method for
the Hamiltonian eigenvalue problem, Linear Algebra Appl., 263 (1997), 75–111
5. Brugnano, L., Trigiante, D.: Solving ODEs by Linear Multistep Initial and Boundary Value Methods. Gordon & Breach, Amsterdam, 1998
6. Bunse-Gerstner, A.: Matrix factorization for symplectic QR–like methods, Linear
Algebra Appl., 83 (1986), 49–77
7. Byers, R.: A Hamiltonian QR–algorithm, SIAM J. Sci. Stat. Comput., 7 (1986),
212–229
8. Calvetti, D., Reichel, L., Sorensen, D.C.: An implicitly restarted Lanczos method
for large symmetric eigenvalue problems, ETNA, Electron. Trans. Numer. Anal.,
2 (1994), 1–21
9. Lancaster, P., Rodman, L.: The algebraic Riccati equation. Oxford University
Press, Oxford, 1995
10. Lin, W., Mehrmann, V., Xu, H.: Canonical forms for Hamiltonian and symplectic
matrices and pencils, Linear Algebra Appl. 302-303 (1999), 469–533

148

P. Amodio

11. Rosen, I., Wang, C.: A multilevel technique for the approximate solution of operator
Lyapunov and algebraic Riccati equations. SIAM J. Matrix Anal. Appl. 32 (1992),
514–541
12. Sorensen, D.C.: Implicit application of polynomial ﬁlters in a k-step Arnoldi
method, SIAM J. Matrix Anal. Appl. 13 (1992), 357–385
13. Van Loan, C.: A symplectic method for approximating all the eigenvalues of a
Hamiltonian matrix, Linear Algebra Appl., 16 (1984), 233–251

