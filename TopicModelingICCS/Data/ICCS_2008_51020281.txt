Multiscale Numerical Models for Simulation of Radiation
Events in Semiconductor Devices
Alexander I. Fedoseyev1, Marek Turowski1, Ashok Raman1, Michael L. Alles 2,
and Robert A. Weller 2
1

CFD Research Corporation (CFDRC), 215 Wynn Drive, Huntsville, AL 35805
aif@cfdrc.com
2
Vanderbilt University, Nashville, Tennessee 37237, USA

Abstract. This paper describes the new CFDRC mixed-mode simulator which
combines multiscale 3D Technology Computer Aided Design (TCAD) device
models (fluid carrier transport and nuclear ion track impact), and advanced
compact transistors models. Key features include an interface and 3D adaptive
meshing to allow simulations of single event radiation effects with nuclear reactions and secondary particles computed by Vanderbilt’s MRED/Geant4 tools.
Keywords: Nanoscale device, radiation event, nuclear reaction, 3D transient
simulation, 3D adaptive mesh generation, hydrodynamics, drift-diffusion, multiscale, finite volume method, computer-aided-design.

1 Introduction
Space and ground-level electronic equipment with devices of nanometer-scale, extremely high densities and highly complex circuits may be strongly affected by ionizing radiation. Accurate multiscale numerical models are necessary for better analysis
of radiation effects and design of radiation tolerant devices [1,2]. Nano-scale electronic device responses to radiation are strongly related to the microstructure of the
radiation event. Multiscale models and adaptive dynamic 3D mesh generation are
needed to enable efficient simulations of transient semiconductor device and circuit
responses to realistic multi-branched track, produced by ionizing particle. Predictive
calculations can leverage efficient mixed-mode simulation capability, that is, threedimensional (3D) physical simulations of ionizing radiation effects in semiconductor
structure coupled with external circuit solver. To design radiation-hardened (rad-hard)
electronics and predict circuit/system characteristics, modeling tools are required at
multiple levels (Fig. 1).
The energy deposition by ionizing particles (so called single event effects) can no
longer be treated as an average deposition (linear energy transfer, LET) along a linear
path (Fig. 2). The impact of such radiation events has implications for nano-scale
devices reliability operating in space exploration environments. The new multiscale
approach to understanding the single-event response of semiconductor materials,
devices, and circuits is necessary for reliable engineering models.
M. Bubak et al. (Eds.): ICCS 2008, Part II, LNCS 5102, pp. 281 – 290, 2008.
© Springer-Verlag Berlin Heidelberg 2008

282

A.I. Fedoseyev et al.

Adaptive dynamic 3D mesh generation capability has been developed to allow
complex, multi-branched track data generated by Vanderbilt’s Geant4/MRED tools
[1,2] simulations to be incorporated into CFDRC NanoTCAD device simulator [3-5]
for transient device response simulations (Fig 3).

Fig. 1. Space electronics systems require automated design tools across multiple levels: macro,
micro, nano. More accurate radiation-effects models are needed for new, nano-scale generations of semiconductor technologies, devices, and ICs.

Fig. 2. Examples of realistic ion tracks, to be simulated for device respond, computed by the
Vanderbilt University group (middle: 100MeV proton of energy goes through strikes silicon
device, generates hundreds of secondary tracks; right: 1GeV proton strike generates few secondary high-energy tracks)

In the following sections we provide the description of the multiscale simulation
approach with focus on the new adaptive 3D mesh generation around ion tracks, and
efficient solution methods for large 3D unstructured meshes which are necessary for
transient radiation effects simulations.

2 Numerical Models Implemented and Governing Equations
The numerical models for efficient 3D simulation of realistic radiation events in
semiconductor nano-scale devices are being integrated within the advanced software
tool NanoTCAD, which is a 3D device simulator developed and commercialized by

Multiscale Numerical Models for Simulation of Radiation Events

283

incoming particle

(a)

Metal 1

Metal 2

NMOS

PMOS

(b)
Fig. 3. (a) 3D model of the CMOS inverter test structure, with two metal layers (M1 and M2)
and examples of two radiation events computed by MRED/Geant4, where the incoming particle
is hitting M1 (copper) above the NMOS-source tungsten contact. (b) 3D mesh generated (semitransparent) for NanoTCAD simulator with ion tracks shown.

CFD Research Corporation [4]. This integration provides a user-friendly interface
and a large database of the semiconductor material properties available in NanoTCAD. It also makes possible a complete PV-cell simulation including both quantum and classical models for the appropriate PV-cell elements, both DC and transient regimes, etc.
The models are currently being extended to incorporate simulation of the electronphonon transport in QDS made of semiconductors with both cubic and hexagonal
crystal lattice, e.g., InAs/GaAs, Ge/Si, CdSe, ZnO. The drift-diffusion model implemented in NanoTCAD is described below.
2.1 Fluid Carrier Transport Model
Fluid carrier transport drift-diffusion models are formulated based on continuity equations for electrons and holes and Poisson equation for electrostatic potential. They are
able to provide good comparison with experimental data for transistors with channel
length down to 15 nm.
Conservation of charge for electrons is represented by continuity equation
q

∂n
+∇⋅J =qR
n
∂t

(1)

q

∂p
+∇⋅J =-qR
p
∂t

(2)

and similarly for holes as

where the electron current is
J =qμ (U ∇n-n∇Ψ)
n
n T

(3)

J =-qμ (U ∇p-p∇Ψ)
p
n T

(4)

and hole current is

284

A.I. Fedoseyev et al.

3
Here n and p are electron and hole densities [1/cm ], Ψ is electrostatic potential [V], q
k T
B
is carrier charge (electron charge e), U =
, and diffusion coefficients are
T q
2
D =U μ and D =U μ [cm /s].
n T n
p T p
Electron and hole mobilities μ , μ are calculated parameters (models depend on
n n
the material, device, or calculated from quantum or kinetic level problems).
Electrostatic potential which appears in current equations is governed by Poisson
equation
∇ε∇Ψ=q(n-p-C)

(5)

where Ψ is electrostatic potential [V], ε is dielectric constant, and C is a doping,
+ +
−
C=ND-NA where N D and N A are constitutive doping .
2.2 Boundary Conditions
Boundary conditions for n, p, and Ψ are shown below for the example of Ohmic contact. At the Ohmic contact we assume thermal equilibrium and vanishing space charge
which results in
2
n⋅p-ni =0
(6)
n-p-C=0
(7)
Solving a quadratic equation for n, p we get Dirichlet conditions for n and p on the
boundary (Ohmic contact)

n0 =

1
2

(

C 2 + 4ni2 + C

)

(8)

p0 =

1
2

(

C 2 + 4ni2 − C

)

(9)

The boundary potential at an Ohmic contact is the sum of the externally applied
potential (voltage) V (t) and the so called built-in potential, which is produced by
C
doping
Ψ=Ψ +V (t)
bi C
The built-in potential is

(10)

Multiscale Numerical Models for Simulation of Radiation Events

⎡ C ( x ) + C 2 + 4n 2
i
Ψ bi = U T ln ⎢
2ni
⎢⎣

⎤
⎥
⎥⎦

285

(11)

where the intrinsic concentration n is:
i
n=
i

n⋅p

(12)

2.3 Discretization of Governing Equations and Efficient Solution of Linear
Algebraic System
Governing equations (1) to (4), (5) are discretized by finite volume method and
solved simultaneously using the Newton technique, to ensure a good convergence.
Unstructured adaptive meshes are used for domain discretization. In NanoTCAD,
we use a high-performance iterative linear solver CNSPACK, developed by Fedoseyev et al. in (2001) [8]. CNSPACK uses a high order preconditioning by incomplete decomposition to ensure the accuracy, stability and convergence of the
simulations.
The linear algebraic system is solved in CNSPACK using a CGS-type iterative
method with preconditioning by the incomplete decomposition of the matrix. Comparing the CGS and GMRES methods in different tests, it was found that both methods converge well, if a good preconditioner is used. The CGS method needs less
memory to store only eight work vectors.
To reduce the memory requirements, a compact storage scheme for matrices is
used in CNSPACK. It stores only the nonzero matrix entries. The incomplete decomposition (ID) used for preconditioning, is constructed as a product of triangular and
diagonal matrices, P=LDU. To avoid diagonal pivot degeneration, the Kershaw diagonal modification is used [9]. If the value of diagonal element becomes small dur-t
ing the construction of preconditioning matrix, i.e. |a |<α= 2 σμ , the diagonal a
ii
ii
is replaced by α . Here σ and μ are the maximum magnitudes of current row and
i
-t
column elements, and 2 is a machine precision (t bits in mantissa).
i
For the first order ID, the matrix P has the same non-zero entry pattern as the
original matrix. For a second order or higher ID, matrix P has one or more additional
entries near the locations of the non-zero matrix entries, where the original matrix
entries are zeros.
The incomplete decomposition order is selected automatically to ensure a stable
and fast convergence, typical values for ID are 2 to 6. Compared to other 3D commercial device simulators, NanoTCAD solver uses dramatically less memory (by a
factor of 20), and CPU time is much smaller (by a factor of 10 to 20) for the similar
problem and similar mesh size. Very large problems are solved within days instead of
months compared to other commercial software.

286

A.I. Fedoseyev et al.

NanoTCAD simulator can solve a transient 3D multi-branched ion strike problem
with 100,000 node unstructured mesh within 512MB memory. It can solve the problem with 3D unstructured mesh for up to 500,000 nodes within 2GB memory.
This efficient linear solver made possible to use adaptive unstructured 3D mesh
generation for a transient 3D multi-branched ion strike problem.

3 Novel Multiscale Single-Event Radiation Effect Models
We are developing multiscale single-event models, which better reflect the true space
environment and help to:
(i) better understand and predict response of nano-devices and novel materials to
the space radiation environment, particularly high atomic number and energy particles (HZE particles) and energetic protons, and the interaction with materials and
devices;
(ii) develop and assess radiation hardening techniques for space electronics;
(iii) better evaluate the radiation response of new electronic devices and circuits at
early design stage;
(iv) reduce the amount radiation-laboratory testing, hence reducing the cost and
time of exploration electronic system design.
These new models have required development of a new 3D adaptive mesh generation tool (which we have named Germes, for Gerris-based Mesher) to ensure better
accuracy of the simulations and more reliable prediction of radiation issues in nanoscale technologies and devices.
The adaptive 3D mesh is particularly important for accurate modeling of complex,
multi-branched tracks of single events (ion strikes) computed by MRED/Geant4 tools
from Vanderbilt University, like, for example, presented in Fig.4 .

Fig. 4. View of “event 267” track-energy data (“tsv” file), plotted using “filaments” in CFDRC
3D software package. Boundaries of track segments from Geant4 are visible as black stripes.
The incident particle was moving in the +Y direction (from bottom to top). All sizes are in μm.

Multiscale Numerical Models for Simulation of Radiation Events

287

The NanoTCAD package contains an unstructured mesh solver. This makes a
wider choice of possible meshes and refinement methods. Ones of particular interest
are binary-tree (bin-tree) mesh-refinement methods. The mesh refinement is based on
bin-tree levels, to discretize each particular part of the sub-domain. In this case, one
can generate the refined grid cells/points in the volume of the transistor in the vicinity
of particle tracks. We use more levels for higher energy deposition in the vicinity of
tracks, Fig. 5.

(a)

(b)
Fig. 5. (a) Adaptive mesh generation for 2D example case, which uses more levels for higher
energy deposition in the vicinity of tracks, and (b) for the real 3D event 267 tracks. Different
isosurface of energy value is plotted with more details. The adaptive mesh refinement in the
vicinity of tracks is shown in different plane cross-sections at Y=const .

The advantage of this approach is that the refined mesh is quite localized in the vicinity of tracks only, dramatically saving the computational time. The difficulty of
this approach is a much more complicated implementation. For our experiments, we
have used the open-source modules from Gerris flow solver [6], [7]. It has 2D and 3D
capabilities, and both static and dynamic mesh refinement modules.
We have developed the interfaces from MRED/GEant4 radiation event data to the
Gerris mesh generation module and performed a series of tests for the mesh refinement with different particle-track models in the volume of the devices, both 2D and
3D cases. Fig. 5 shows bin-tree mesh refinement examples in the vicinity of ion tracks

288

A.I. Fedoseyev et al.

for 2D and 3D test cases. One can see that the mesh refinement is local, in the vicinity
of tracks only. This is very important for the efficiency of computations for very large
problems .

4 Nanotcad Transient Simulations with MRED/Geant4 Tracks
with Developed Accurate Radiation Event Model
The 3D mesh, created using the new CFDRC tools described above, can be used for
transient 3D simulations of semiconductor nano-device response to such a radiation
event generated by the Vanderbilt MRED/Geant4 interface. First such simulations
have been performed at CFDRC, for a NMOS-transistor with external circuit (Fig. 6).
Vdd

Vdd

Vdd

Vdd

10
(floating)
load_inv

Vdd

P1

1
low input

P2

2

P3

3

4

P4

5

6

7

8

9
Vout

Vin
inv5
N1

S

G

Ion
Strike

N2

N3

inv6

inv7

inv8

N4

D
Vss

0

Vss

inv2

Vss

inv3

P-subs

Vss

inv4

Circuit Simulated
by SPICE
3D NMOS Model
solved by NanoTCAD

Fig. 6. The 8-inverter chain simulation setup used for our mixed-mode simulations

The ion strike duration time-scale is one ps, but the time-scale of transient device
respond is up to six orders of magnitude higher, 1μs. Numerical simulation of such
transient behavior is difficult and required adaptive integration in time. Sample results
are shown in Fig. 7 (b), the collected charge conservation is very good.
For the device response computation, we simulated the NMOS device using the
CFDRC NanoTCAD 3D solver [6] and the rest of the circuit in Spice (using the
CFDRC mixed-mode package, MixSpice). In the NMOS 3D device volume, we applied the radiation event data obtained from Vanderbilt MRED simulation, which
were then used in CFDRC new tool, Germes, to generate a 3D model with adaptive
meshing around the ion tracks. The multi-branched ion-track segments outside of the
NMOS 3D TCAD model can be ignored, as not affecting the device behavior. A series of test simulations was done, with different mesh sizes, with adaptive mesh refined near the ion tracks and doping profiles. We found that a 3D mesh with about
30,000 nodes for NMOS was sufficiently good, producing results for currents and
collected charge <8% different from the results obtained for 3D mesh sizes of 80,000

Multiscale Numerical Models for Simulation of Radiation Events

289

Source
Drain

(a)

(b)
Fig. 7. Multiscale numerical simulations : MRED/Geant4 nuclear reaction radiation event 3D
simulation in NMOS by CFDRC NanoTCAD. (a) Ion tracks (isosurface of deposited energy),
3D mesh locally refined around tracks, and resulting electron concentration (color map), at t =
2.4 ps. (b) Transient currents flowing through the contacts and the collected charges versus time
(for this event, the total collected charge Qcol = 59 fC).

and 120,000 nodes, while saving the computation time dramatically. Our typical transient simulation with 3D mesh of 30K-40K nodes takes about 40-60 minutes on a
2GHz CPU.

5 Conclusions
A description of multiscale numerical models involving fluid carrier transport and
nuclear ion track generation, adaptive 3D meshing approach, and efficient solution
method for large 3D problems using unstructured meshes has been provided. Multiscale models and adaptive dynamic 3D mesh generation presented in this paper enable
efficient simulations of transient semiconductor device response to realistic multibranched track, produced by ionizing particle. The developed approach efficiently

290

A.I. Fedoseyev et al.

uses computer resources, makes possible solution of transient 3D multi-branched ion
strike problems on a regular desktop computer.
Key features include an interface and adaptive meshing to allow simulations of
single event radiation effects with nuclear reactions and secondary particles computed
by MRED/Geant4 tools from Vanderbilt University. As shown by many recent papers, the contribution of nuclear reactions to single event upset cross-section of modern ICs may be very significant.

References
1. Weller, R.A., Sternberg, A.L., Massengill, L.W., Schrimpf, R.D., Fleetwood, D.M.: Evaluating average and atypical response in radiation effects simulations. IEEE Trans. Nucl.
Sci. 50, 2265–2271 (2003)
2. Kobayashi, A.S., Sternberg, A.L., Massengill, L.W., Schrimpf, R.D., Weller, R.A.: Spatial
and Temporal Characteristics of Energy Deposition by Protons and Alpha Particles in Silicon. IEEE Trans. Nucl. Sci. 51, 3312 (2004)
3. Turowski, M., Raman, A., Schrimpf, R.: Non-Uniform Total-Dose-Induced Charge Distribution in Shallow-Trench Isolation Oxides. IEEE Trans. on Nuclear Science 51, 3166–3171
(2004)
4. CFDRC, NanoTCAD (2006), http://www.cfdrc.com/bizareas/microelec/micro_nano/
5. Fedoseyev, A.I., Turowski, M., Wartak, M.S.: Kinetic and Quantum Models for Nanoelectronic and Optoelectronic Device Simulation. J. of Nanoelectronics and optoelectronics 2,
234–256 (2007)
6. Popinet, S.: Numerical modelling of fluid flow. Marsden Update (July 2004)
7. Popinet, S.: Free Computational Fluid Dynamics. ClusterWorld, 2 (June 2004)
8. Fedoseyev, A.I., Bessonov, O.A.: Iterative solution for large linear systems for unstructured
meshes with preconditioning by high order incomplete decomposition. Comput. Fluid Dynamics Journal 10, 296–304 (2001)
9. Kershaw, D.S.: The incomplete Cholesky-conjugate gradient method for the iterative solution of systems of linear equations. J. Comput. Phys. 2, 43 (1978)

