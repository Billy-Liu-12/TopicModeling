Design and Analysis of Test Signals for
System Identification
LIU Bo, ZHAO Jun, and QIAN Jixin
Institute of System Engineering
National Key Laboratory of Industrial Control Technology
Zhejiang University, Hangzhou, P.R. China 310027
liubo@iipc.zju.edu.cn

Abstract. For multi-channel process, due to disadvantages of the open-loop
single variable step method, multi-channel test method is used. That means all
of the channels are tested at the same time. In order to eliminate cross-effect of
the different test signals, it requires that all the test signals are uncorrelated.
Several test signals are introduced and analyzed. Based on two familiar identification methods: correlation analysis method and least-squares method, we put
our strength on the way to get uncorrelated test signals. A novel design for the
period length of uncorrelated pseudo random binary sequence (PRBS) is proposed. Use this design method, identifiable PRBS signals can be gained and
their periods are the shortest. Simulation results show the effectiveness.

1 Introduction
The fundamental problem in all kinds of predictive control is how to choose an appropriate functional model which reflects the characteristic of the control system.
Again, The primary method to acquire a valuable functional model in the current
industry is system identification. And the key to obtain a worthful result of correct
identification is choosing rightly recognizable test signals.
Although multivariable control concept is well accept by industry, the guideline
for identification practice is still single variable thinking. Current practice of industry is to use a series of single variable step tests[1] for model identification, which
reflects the fact that each manipulating variable (MV) is stepped separately and
some clear step responses are expected for modeling each transfer function. The
biggest problem of this test method is its high cost in time and manpower. The
product qualities may be disturbed by stepping the MVs. This problem can be
solved by using automatic multivariable test approach. But when you input several
test signals at the same time, there are some cross-effect between the test signals.
For the sake of identifying different impacts on the same output from different inputs in such experiment, these inputs need to be presumed as uncorrelated. Therefore, for multivariable process, we have new design for uncorrelated test signals.
Simulation data show that use these design methods, less test time needs and better
results can be get.
V.N. Alexandrov et al. (Eds.): ICCS 2006, Part III, LNCS 3993, pp. 593 – 600, 2006.
© Springer-Verlag Berlin Heidelberg 2006

594

B. Liu, J. Zhao, and J. Qian

2 Pseudo Random Binary Sequence (PRBS)
PRBS is a long period signal. In a period, it is a true stochastic binary signal. Over a
period, it is a deterministic signal and it will repeat the previous period signal. In the
field of system identification, the stochastic of PRBS plays a quite important role.
2.1 Properties of PRBS
A PRBS is a two states signal which can be generated by using a feedback shift
register. When the number of registers are n, the maximum possible length is
N = 2 n − 1 . Assume that the clock period is Δt , the period of PRBS is: T = N ⋅ Δt .
Because the length of PRBS is odd number in a period it takes two values –a
and a, the number of value “ + a ” is one less than the number of value ” − a ”.
The most characteristic of PRBS signal is its auto-correlation function can resemble
the auto-correlation of white noise sequence. For this characteristic, it can be used as
test signal. Its auto-correlation function is:

：

，

，

⎧ 2
N +1 τ
⋅ )
− Δt < τ < Δt
⎪⎪a (1 −
N Δt
R xx (τ ) = ⎨
2
a
⎪
−
Δt ≤ τ ≤ ( N − 1) Δt
N
⎩⎪

(1)

That is, when N is large enough, in the range [0, NΔt ] , Rxx (τ ) can be taken as δ
function. See Fig 1.
1 . 2

1

0 . 8

0 . 6

0 . 4

0 . 2

0

- 0 . 2

0

1

0

2 0

3 0

4 0

5

0

6 0

7 0

8

0

9

0

1

0 0

t

Fig. 1. Auto-correlation function of PRBS

Note that generating a part of a period of a PRBS will not give a signal with the above
properties. This makes the selection of time less flexible.
2.2 PRBS Used in Correlation Analysis Method

Firstly for SISO linear system, suppose the input of linear system is x(t ) , output
is y (t ) . Correlation analysis method uses correlation method to solve the dynamic
characteristic of system, that is impulse response g (τ ) . The cross-correlation function
between input and output is

Design and Analysis of Test Signals for System Identification
Ts

R xy (τ ) = ∫ g ( s ) R xx (τ − s )ds
0

Where,

595

(2)

Ts is system adjust time, when τ ≥ Ts , we get g (τ ) = 0 . Adjust the period of

PRBS, it can be arrived that T > Ts .
According to (3), we have
τ ≥ Δt
[ Rxy (τ ) − R yx (τ )] / S
⎧
⎪
τ
τ
1
⎪
` g (τ ) = [ R (τ ) − R (τ )] /[( + (1 −
)) S ] Δt > τ > 0
⎨ xy
yx
2 Δt
2Δt
⎪
τ =0
2[ Rxy (0) − R yx (Δt )] / S
⎩⎪

(3)

where
S = (1 +

1 2
)a Δt
N

(4)

Consequently, we can achieve g (τ ) from cross-correlation function between input
and output conveniently taking PRBS as input signals. In relative analysis method,
used as test signal and in virtue of its periodicity, PRBS does not need infinite time to
calculate cross-correlation function in contrast with white noise sequence. PRBS just
needs a period time. Therefore to ensure yielding fine identification precision, PRBS
shall be easily made and save more time.
As to MIMO system, an old approach is to test every variable independently. Assuming other inputs are zero, we test one selected variable at each time. This approach is time-consuming for one by one test method. Again, it doesn’t guarantee to
keep other variables intact when checking the selected one. To solve this problem, it
needs to make a one and only experiment. But when you input several test signals at
the same time, there are some cross-effect between the test signals, that it’s difficult to
distinguish different impacts on the same output from different inputs. For the sake of
identifying different impacts on the same output from different inputs in such experiment, these inputs need to be presumed as uncorrelated.
In order to make uncorrelated PRBS signals, firstly you need to generate a PRBS,
secondly shift it horizontally. That is to say, other signals will be this signal’s delaysignals. But it still exits a big problem that what is the delay value. To guarantee process dynamic is persistent excited by input signals, the PBRS signal must ensure that
its period is longer than the settling time of process for each variable. For this reason,
the uncorrelated range of each variable should be longer than its settling time. Therefore, in order to ensure the PRBS signals are uncorrelated and identifiable, what is the
minimum delay value we should choose? Aim at this problem we have further study
about delay value D .
Theorem 1. Assume a linear process with m-input and n-output, where n ≤ m ,
xi (t ) (i = 1,L , m) are input PRBS signals, xi +1 (t ) are delay signals of xi (t ) , suppose
the delay value are K i +1Δt , that is xi +1 (t ) = xi (t + K i +1Δt ) . All the input signals are unm

correlated in the range of 0 ~ ( N − K − 1)Δt , where K1 = 0 is the delay value
∑ i
i =1

of x1 (t ) .

596

B. Liu, J. Zhao, and J. Qian

Proof. Consider x1 (t ) is a PRBS signal, x2 (t ) is the delay signal of x1 (t ) , the delay value
is K 2 Δ t , so that x2 (t ) = x1 (t + K 2 Δt ) .
The cross-correlation function between x1 (t ) and x2 (t ) is
Rx1x2 (τ ) =

1
T

∫

T

0

x1 (t ) x2 (t + τ ) dt =

1
T

∫

T

0

x1 (t ) x1 (t + τ + K 2 Δt ) dt

(5)

= Rx1x2 (τ + K 2 Δt )
=

0 < τ < ( N − K 2 − 1) Δt

− a2
N

，

According to (5) the cross-correlation function between xi (t ) and xi − p (t ) is
Rxi xi− p (τ ) =

=

1
T

∫

T

0

xi (t ) xi − p (t + τ ) dt

1 T
xi − p (t ) xi (t + τ + ( K i + K i −1 + L + Ki − p +1 )Δt ) dt
T ∫0

(6)

= Rxi− p xi− p (τ + ( K i + K i −1 + L + K i − p +1 )Δt )
=

− a2
N

0 < τ ≤ ( N ' − ( K i + K i −1 + L + K i − p +1 ) − 1) Δt

when N is large enough, Rx x (τ ) ≈ 0 , so xi (t ) and xi − p (t ) will be uncorrelated in the
i i− p
range of 0 ~ ( N − ( K i + K i −1 + L + K i − p +1 ) − 1)Δt . Thus it can be seen, the uncorrelated
range of all signals is 0 ~ ( N −

m

∑K
i =1

i

− 1) Δt .

The theorem shows the uncorrelated range. Through this theorem, it can be known
that which is the minimum delay value and we got a new way to design test signals.
Consider a linear process with m inputs and n outputs, where n ≤ m , assume
that Di stands for the settling time for i th input. So that the new design approach of
test signals is:
Step1: Generate a PRBS x1 (t ) ;
Step2: Calculate max Di (i = 1, L, m) , choose the channel which has the maximum
settling time as the first channel and take x1 (t ) as its input signal;
Step3: Choose the remaining input signals for m − 1 channels stochastically
[ x 2 (t ) x 3 (t ) L x m −1 (t ) x m (t )] ;
Step4: xi (t ) is the delay signal of xi −1 (t ) , its delay value is K i Δt = Di (i = 1, L , m) ,
where K1 = 0 .
m

From the forward approach, the minimum period of input signals is T = D . In refer∑ i
i =1

ence [4], the author used maximum settling time of the process as delay value. So its
period is m × Dmax . By comparing T with m × Dmax , especially to a quite complicated

Design and Analysis of Test Signals for System Identification

597

system in which every channel differs in the settling time, it bigly shortens the length
of test signal after we make the improvement. The data of example 1 shows it clearly.

3 Generalized Binary Noise (GBN)
This signal was proposed by Tullenken. The motivation was to generate a test signal
that is suitable for control-relevant identification of industrial processes.
3.1 Properties of GBN

A GBN signal u(t ) takes two values − a and a . At each candidate switching time t, it
switches according to the following rule
P[u (t ) = −u (t − 1)] = p sw

(7)

P[u (t ) = u (t − 1)] = 1 − p sw

p sw is switching probability. The distribution for the event at each switching
time is an independent alternative distribution with parameter p sw .

where

The GBN auto-correlation function is

Ruu (τ ) = Eu (t )u (t − τ )
=

=

1
N

N

∑a
t =1

2

[ P (u (t ) = a and u (t − τ ) = a ) + P (u (t ) = − a and u (t − τ ) = − a )

− P (u (t ) = a and u (t − τ ) = − a ) + P (u (t ) = − a and u (t − τ ) = a )]

N

1
∑a2 (1− 2 psw )[P(u(t −1) = a and u(t −τ ) = a) + P(u(t −1) = −a and u(t −τ ) = −a)
N t =1
− P (u (t − 1) = a and u (t − τ ) = − a ) + P (u (t − 1) = − a and u (t − τ ) = a )]

= ((1 − 2 p sw ) E (u (t − 1)u (t − τ ))

(8)

M

= ((1 − 2 p sw )τ Eu 2 (t − τ )
= (1 − 2 p sw )τ

1
N

N

∑a

2

( P (u (t − τ ) = a + P (u (t − τ ) = − a )

t =1

= a 2 (1 − 2 p sw )τ
Especially when: p sw = 1 / 2 , then 1 − 2 p sw = 0 . Its auto-correlation function is
⎧a 2 τ = 0
Ruu (τ ) = ⎨
⎩0 τ ≠0
From this function it can be seen that GBN auto-correlation function can resemble
the auto-correlation function of white noise sequence. And especially when
p sw = 1 / 2 , the auto-correlation is the same with the auto-correlation of white noise
sequence. It can be called white noise GBN. Shows in Fig 2.

598

B. Liu, J. Zhao, and J. Qian
1
p= 1/2
p= 1/4
p= 3/4
0.5

0

-0 . 5
-1 0

-8

-6

-4

-2

0

2

4

6

Fig. 2. Auto-correlation function of GBN for different

8

10

p sw

White noise GBN can be used in relative analysis method. Because its autocorrelation function is δ function, the cross-correlation between any of two white
noise GBN signals is zero, that is to say any of two white noise GBN signals are uncorrelated. That is, for MIMO system, we can generate m white noise GBN signals as
input signals.
Note that GBN noise has no period, it needs infinite time to calculate crosscorrelation function, which needs quite a long time for GBN to attain good precision.
Compare with PRBS, PRBS is period signal, it just needs a period time to calculate its
auto-correlation function. Therefore, PRBS shall be a better choice to be applied in
relative analysis method.
3.2 GBN Used in Least-Squares Method

In least-squares method, to guarantee that the estimation algorithms have unique solutions, test signals should be persistent excitation. PRBS, L signal and GBN can be
used in least-squares method.
In a process control environment, a PRBS signal will over-emphasize the high frequency band at the cost of the low and middle frequency band; its frequent fluctuations can be harmful for control actuators. And its power spectrum is
2πa 2 N
0 ≤ ω ≤ 2π
(9)
Φ (ω ) =
∑ δ (ω − 2πk / N )
N

k =1

Its spectrum has dips around frequencies 2π / Δt , 4π / Δt , 6π / Δt ,L , which will result in low signal-to-noise ratios in these frequency ranges. A PRBS signal is not the
best test signal for least-squares method.
A good test signal for process control has a low-pass character. We can generated
low-pass GBN signals by reducing the switching probability p sw , or equivalently,
increasing the mean switching time ETsw . Define minimum switching time Tmin as the
time (in samples) to keep the signal constant and switching time

Tsw as the elapsed

time between two switches, we can get GBN power spectrum:
Φ u (ω ) =

(1 − q 2 )Tmin
1 − 2q cos Tmin ω + q 2

(10)

Note that unlike the PRBS signal, the spectrum of a low-pass GBN signal does not
have dips at frequencies 2π / Δt , 4π / Δt ,L , which is advantageous, see Fig 3. So
GBN signal is better than PRBS signal in least-squares method.

Design and Analysis of Test Signals for System Identification
S

p e c t r a

o f

lo w - p a s s

G

B

N

( s o lid )

a n d

lo w - p a s s

P

R

B

S

599

( d a s h e d )

1 2

1 0

8

6

4

2

0

0

0 . 5

1

1 . 5
F r e q u e n c y

2

2 . 5

3

Fig. 3. Compare the power spectra of low-pass GBN and low-pass PRBS

4 Examples
Example 1. Consider a process with three inputs. The transfer functions are:
G(s) = [

(11)

1
1
1 T
]
100s + 1 20s + 1 s + 1

Use correlation analysis method to identify this process. PRBS signals are taken as test
signals. Follow the new design steps of PRBS, we get the period of PRBS. Table 1
shows the different period time by using delay value proposed in reference [4] and this
paper.
Table 1. Compare the period of PRBS
Process
Variable 1
Variable 2
Variable 3
The whole process

Settling time

500
100

5

The period of PRBS using
the method in reference [4]

1500
1500
1500
1500

The period of PRBS using
the method of this paper

605
605
605
605

Example 2. Let us see a typical petrochemical processes in refinery industry. There
are four main variables. Asymptotic method[7] extended by least-square method is
used here. Choose white noise GBN signals as test signals. Because the uncorrelated
character of white noise GBN, we can generate four white noise GBN signals directly
and input to the process at the same time. Table 2 shows the duration of one test by
using single variable step test and white noise GBN signals.

In multivariable test, as the four variables are test at the same time, the duration time
of every variable are the same. Compared to the conventional single variable step test,
our design can save about 70% test time. In such a petrochemical process, we can
save most cost of time and money.

600

B. Liu, J. Zhao, and J. Qian
Table 2. Compare the duration of one test
Process

Settling time

The duration of single
variable step test

The duration using
multivariable test

Main fractionator

50

50
40
20
35
>145

50
50
50
50
50

Atmospheric tower
FCC react
Stabilizer
The whole process

40

20
35

5 Conclusions
The result of system identification is affected by test signals directly. This article
study several kinds of test signals from the point of view of system identification.
Firstly, introduce every kind of test signal's attribute. Then analyse how to design
uncorrelated test signals in correlation analysis method and least-squares method. In
conclusion, due to the periodicity of PRBS, the time to calculate auto-correlation
function is comparatively short. Therefore, PRBS shall be a better choice to be applied in relative analysis method than GBN. And we can obtain low-pass signal by
converting the convert probability of GBN, such characteristics make GBN works
better than PRBS in least-squares method. The future researches will focus more on
these test signals more suitable for system identification.

References
[1] Chongzhi Fang, Deyun Xiao. Process Identification. Qinghua Publishing House. 1988.
[2] Ljung, L. System Identification: Theory for the User. NJ, Prentice-Hall, UpperSaddle
River, 2nd edition, 1999
[3] M. leskens, L.B.M. Van kessel. MIMO closed-loop identification of an MSW incinerator.
Control Engineering Practice , 2002, 10:315–326.
[4] M.E.H. Amrani, R.M. Dowdeswell, P.A. Payne, etal. Pseudo-random binary sequence interrogation technique for gas sensors［ J］ . Sensors and Actuators, 1998, B 47:118-124
[5] Ljung, L. Asymptotic variance expressions for identified black-box transfer function models. IEEE Transactions on Automatic Control, 1985b, 30:834-844.
[6] Zhu, Y.C. Black-box identification of MIMO transfer functions: asymptotic properties of
prediction error models. Int.J.Adaptive Control and Signal Processing, 1989, 3:357-373.
[7] Zhu, Y.C. Multivariable process identification for MPC: the asymptotic method and its applications. Journal of Process Control, 1998, 8(2):101-115.
[8] Bainan Li. PRBS signal and relative identification. Science Publishing House. 1987.

