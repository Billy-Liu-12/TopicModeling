Construction of Quasi Optimal Portfolio for
Stochastic Models of Financial Market
Aleksander Janicki and Jakub Zwierz
Mathematical Institute, University of Wroclaw,
pl. Grunwaldzki 2–4, 50–384 Wroclaw, Poland
janicki@math.uni.wroc.pl
http://www.math.uni.wroc.pl/˜janicki

Abstract. In the paper we propose a purely computational new method of construction of a quasi–optimal portfolio for stochastic models
of a ﬁnancial market. Here we present the method in the framework of
a classical Black–Scholes model of a complete market (see, eg. [4], [6]),
considering a well known optimal investment and consumption problem
with the HARA type optimization functional. Our method is based on
the idea to maximize this functional, taking into account only some subsets of possible portfolio and consumption processes. We show how to
reduce the main problem to the construction of a portfolio maximizing a
deterministic function of a few real valued parameters but under purely
stochastic constraints. It is enough to solve several times an indicated
system of stochastic diﬀerential equations (SDEs) with properly chosen
parametrs.
Results of computer experiments presented here were obtained with the
use of the SDE–Solver software package. This is our own professional
C++ application to Windows system, designed as a scientiﬁc computing
tool based on Monte Carlo simulations and serving for numerical and
statistical construction of solutions to a wide class of systems of SDEs,
including a broad class of diﬀusions with jumps driven by non-Gaussian
random measures (consult [1], [2], [5], [8], [9]).
Our method can be easily extended to stochastic models of ﬁnancial
market described by systems of such SDEs.

1

Optimal Investment and Consumption Problem for
Black–Scholes Model of a Financial Market

Let us recall that an N dimensional Black–Scholes model of a ﬁnancial market
can be described by the following system of N + 1 SDEs
t

S0 (t) = S0 (0) +

r(s)S0 (s)ds,

(1)

0
N

t

Sn (t) = Sn (0) +

t

µn (s)Sn (s)ds +
0

σn,k (s)Sn (s)dBk (s),
k=1

0

M. Bubak et al. (Eds.): ICCS 2004, LNCS 3039, pp. 803–810, 2004.
c Springer-Verlag Berlin Heidelberg 2004

(2)

804

A. Janicki and J. Zwierz

for n = 1, . . . , N and t ∈ (0, T ], and where we have the money market with a
price S0 (t) and N stocks with prices-per-share S1 (t), . . . , SN (t), for t ∈ [0, T ].
We assume that processes r = r(t), and µn = µn (t), for 1 ≤ n ≤ N , are
L1 (Ω × [0, T ])–integrable, and processes σn,k = σn,k (t) are L2 (Ω × [0, T ])–
integrable on the probability space (Ω, F, {Ft }, P) with a ﬁltration {Ft } generated by N –dimensional Brownian motion process (B1 (t), . . . , BN (t)).
Let the stochastic processes η0 = η0 (t) and ηn = ηn (t), for n = 1, 2, ..., N ,
denote the number of shares of a bond and stocks, respectively. So, the value of
the investor’s holdings at time t is represented by the wealth process, which can
be represented by
N

df

N

X(t) =

ηn (t)Sn (t) =
n=0

where

πn (t),

(3)

n=0

df

πn (t) = ηn (t)Sn (t), n = 0, 1, . . . , N.
Let π(t) = (π1 (t), . . . , πN (t)). We say that the process
(π0 , π) = {(π0 (t), π(t)) : t ∈ [0, T ]}
is the portfolio process or simply portfolio of an investor.
We deﬁne the gains process {G(t) : t ∈ [0, T ]} as a process which satisﬁes the
following equation,
N

N

ηn (t)dSn (t) +

dG(t) =
n=0

Sn (t)δn (t)dt,

(4)

n=1

where δn = δn (t) is the so called divident rate payment process of the nth stock,
for all 0 < n ≤ N . By the consumption process we understand here any nonnegative, regular enough stochastic process c = {c(t) : t ∈ [0, T ]}. Let x > 0
denote the initial wealth (or endowment, i.e. an amount of money an ivestor
has to his disposal at time t = 0), what means that we have X(0) = x. Let
df

Γ (t) = x −

t
0

c(s)dt. We say that the portfolio (π0 , π) is Γ –ﬁnanced, when
N

πn (t) = Γ (t) + G(t),

(5)

n=0

with G(0) = 0, Γ (0) = x.
It is not diﬃcult to check that if conditions (4) and (5) are satisﬁed, then the
wealth process
(6)
X ≡ X x,c,π = {X x,c,π (t) : t ∈ [0, T ]},
deﬁned by (3), can be obtained as a solution to the following Itˆ
o SDE
N

dX(t) = (rX(t) − c(t))dt +

(µn (t) + δn (t) − r)πn (t)dt +
n=1

N

N

πn (t)

+
n=1

σn,m Bm (t),
m=1

with an initial condition of the form X(0) = x =

N
n=0

(7)

ηn (0)Sn (0).

Construction of Quasi Optimal Portfolio

805

From (4) and (5), after application of the classical Itˆ
o formula, it follows that
the following – very important in our approach – equation must be satisﬁed
N

N

Sn (t)δn (t)dt − c(t)dt.

Sn (t)dηn (t) =
n=0

(8)

n=1

In optimization problems utility functions can be chosen in many diﬀerent
ways, however the typical choice for scientiﬁc investigations is the HARA model,
what means that we chose utility function given by
df

U (p) (x) = xp /p,

x > 0,

(9)

for p ∈ (−∞, 0) or p ∈ (0, 1).
The risk aversion coeﬃcient is then deﬁned by the formula
df

R = −x

d2 (p)
U (x)
dx2

d (p)
U (x) = 1 − p.
dx

(10)

Here we are interested in the following optimization problem.
For a given utility function U (p) = U (p) (c) and initial wealth x > 0, we look
for an optimal portfolio π(t) = {π1 (t), . . . , πN (t)} and an optimal consumption
process c = c(t), such that for the value function of the form
T

df

Vc,π (x) = E

U (p) (c(t))e

−

t
0

β(s)ds

dt

(11)

0

the following condition is satisﬁed
Vcˆ,ˆπ (x) =

sup

Vc,π (x).

(12)

(c,π)∈A(x)

Here the condition (c, π) ∈ A(x) means, that the processes c = c(t) and π = π(t)
are subject to the stochastic constraints, what means that c = c(t) is positive
on [0, T ] and the corresponding wealth process satisﬁng SDE (7) is such that
X x,c,π (t) ≥ 0 a.s.

2

for t ∈ [0, T ].

(13)

An Example of a Quasi–optimal Portfolio

An attempt to answer the question how to apply computational methods to solve
directly and eﬀectively optimizations problem (12) through analytical methods,
e.g. making use of the Malliavin calculus (see [3], [7]) or trying to get a hedging
strategy by constructing a relevant replicating portfolio (see eg. [4], [6], etc.) is
not an obvious task.
So, our aim is to describe a method of computer construction of a quasi–
optimal portfolio solving approximate problem related to (12).
The method is based on the idea to maximize functional (11), taking into
account only some subsets of possible portfolio processes derived from equations

806

A. Janicki and J. Zwierz

(7) and (8), and chosing the class of admissible positive consumption processes
arbitrally, in a convenient reasonable way.
We show how to reduce the main problem to the construction of a portfolio
maximizing a deterministic function of a few real valued parameters but under
purely stochastic constraints.
In order to make the further exposition easier, we restrict ourselves to the
classical one dimensional (N = 1) Black–Scholes model, which can be described
in the following form
t

S0 (t) = S0 (0) + r

S0 (s)ds

(14)

0
t

S1 (t) = S1 (0) + µ

t

S1 (s)ds + σ
0

S1 (s)dB(s),

(15)

0

for t ∈ [0, T ], and initial conditions such that S0 (0) > 0, S1 (0) > 0.
In the model (14)–(15) all paremeters, i.e. S0 (0), S1 (0), r, µ, σ, are given
positive real numbers. So, the processes S0 , S1 can be described in the explicit
closed form
S0 (t) = S0 (0) ert ,
S1 (t) = S1 (0) e

(16)

{(µ−σ 2 /2)t+σB(t)}

.

(17)

The portfolio is now given by π = (π0 , π1 ), where
π0 (t) = η0 (t)S0 (t),

π1 (t) = η1 (t)S1 (t),

t ∈ [0, T ].

(18)

In the example we have chosen for computer experiments presented here
we reduced the class of admissible portolio process to those which are of the
following form
η1 (t) = p1 S1 (t), t ∈ [0, T ].
(19)
We also restric ourselves to the class of consumption processes deﬁned by
c(t) = c0 S0 (t) + c1 S1 (t),

t ∈ [0, T ],

(20)

In (19) and (20) parameters p1 , c0 , c1 are deterministic (real) variables, subject
to some stochastic constraints, and which should ﬁxed in an optimal way.
It is not diﬃcult to notice that in such circumstances the wealth process
X(t) = X c0 ,c1 ,p1 (t), deﬁned by (7), solves the following Itˆ
o SDE
dX(t) = rX(t) + (µ1 + δ1 − r)η1 (t)S1 (t) − c0 S0 (t) + c1 S1 (t)
+σ1 η1 (t)S1 (t)dB(t), t ∈ (0, T ],

dt (21)

X(0) = x.

Making use of the equation (8), it is also possible to check that the ﬁrst
component of the portfolio, i.e. the proces η0 = η0 (t) solves the following SDE
dη0 (t) = (−µ1 + δ1 )p1 S12 (t) − c0 S0 (t) + c1 S1 (t)

/S0 (t)dt −

− p1 σ1 S12 (t)/S0 (t)dB(t), t ∈ (0, T ], η(0) = (x − p1 S12 (0))/S0 (0).(22)
In this way we arrive at the following problem.

Construction of Quasi Optimal Portfolio

807

For a given utility function U (p) = U (p) (c) and initial wealth x > 0, we look
for optimal values of parameters c0 , c1 , p1 , such that for the value function of
the form
T

df

Vc0 ,c1 ,p1 (x) = E

U (p) (c0 S0 (t) + c1 S1 (t))e−βt dt

(23)

0

the following condition is satisﬁed
Vc0 ,c1 p1 (x) =

sup
(c0 ,c1 ,p1 )∈A(x)

Vc0 ,c1 ,p1 (x).

(24)

Now the condition (c0 , c1 , p1 ) ∈ A(x) means, that the consumption and wealth
processes, deﬁned by (20) and (21), are such that we have
X c0 ,c1 ,p1 (t) ≥ 0 a.s.,

c0 S0 (t) + c1 S1 (t) ≥ 0 a.s. for t ∈ [0, T ].

(25)

We see that, having to our disposal stochastic processes solving SDEs (14),
(15), and (21), we are able to solve the problem (23)–(25). In order to get values
of the value function (23) using the SDE–Solver software it is enough to solve
the system of two equations
dY (t) = c0 rS0 (t) + c1 µ1 S1 (t) dt + c1 σ1 S1 (t) dB(t),

(26)

dZ(t) = U (p) (Y (t))eβt dt,

(27)

for t ∈ (0, T ], and with initial conditions Y (0) = c0 S0 (0) + c1 S1 (0), Y (0) = 0,
and ﬁnally to compute
Vc0 ,c1 ,p1 (x) = E Z(T ).
(28)
Then, making use of formulae (22), (19), (18), and (20), one can easily construct quasi optimal portfolio and quasi optimal consumption processes.

3

Results of Computer Experiments

We solved the optimization problem desribed by formulae (14)–(25), with the
following ﬁxed values of constant parameters: T = 1, r = 0.2, µ1 = 0.15, δ1 =
0.05, σ1 = 0.35, β = 0 and also β ∈ {0, 0.1, 0.2, 0.4, 0.8}, x = 50, S00 = 50,
S10 = 50.
The optimal solution for β = 0.0 is of the following form:
c0 = 1.0,

c1 = −0.01,

p1 = 0.0,

Vc0 ,c1 ,cp = 14.8.
1

From a large amount of data obtained in our experiments we present here
the optimal solution for β = 0, including Fig. 1 presenting the convex subset
of admissible parameters (c0 , c1 , p1 ) in R3 , which can be of independent interest
and the Fig. 2 containing the values of the value function Vc0 ,c1 ,p1 .

808

A. Janicki and J. Zwierz

0.04
0.035
0.03
0.025

p1 0.02
0.015
−0.5

0.01
0
0.005
0
−0.4

0.5
1
−0.2

0

0.2

0.4

0.6

0.8

1

1.5

c

0

c

1

Fig. 1. The convex set in R3 containing all admissible values of parameters Vc0 ,c1 ,p1

15
β=0
β = 0.4
β = 0.8

max(E(U(c)))

10

5

0

0

0.005

0.01

0.015

0.02
p1

0.025

0.03

0.035

0.04

Fig. 2. Dependence of function Vc0 ,c1 ,p1 on parameter p1 for 3 values of β

Construction of Quasi Optimal Portfolio

809

In Table 1 below some values of function Vc0 ,c1 ,p1 , indicated in Fig. 2 for 3
diﬀerent values of β, are presented with corresponding values of parameters
c0 , c1 , p1 .
Table 1. Values of Vc0 ,c1 ,p1 from (23)

Vc0 ,c1 ,p1 (x)

c0

c1

p1

β

14.8

1.00

−0.01

0.00

0.00

11.5

0.30

0.00

0.80

0.30
−0.10

0.00

12.5

0.01

0.00

11.5

0.30

0.30

0.01

0.00

11.3

0.30

0.30

0.02

0.00

13.3

1.00

−0.01

0.00

0.20

11.7

0.38

0.20

0.80

0.38
−0.10

0.01

11.3

0.01

0.20

10.3

0.30

0.30

0.02

0.20

12.1

1.00

−0.01

0.00

0.40

10.6

0.80

−0.05

0.01

0.40

9.4

0.30

0.30

0.02

0.40

10.1

1.00

−0.01

0.00

0.80

7.8

0.30

0.30

0.02

0.80

In all runs of the system of equations (14), (15), (21), (26), (27) leading to
computation of values of the expression in (28) with the SDE–Solver, we had
1000 trajectories of the solution, which were constructed on the grid given by
1000 subintervals of lenght 0.001 of the interval [0, 1]. Numerical and statistical
approximation methods involved are described in [1], [2], [5], [9].
Another completely solved example (simplier one, with value function depending only on two parameters) of a quasi optimal portfolio and quasi optimal
consumption processes can be found in [1]. Instead of (19), (20), and (23), the
following conditions describe the optimization problem:
η0 (t) = p0 S0 (t),
T

df

Vc2 ,p0 (x) = E

c(t) = c2 X(t),

U (p) (c2 X(t))e−βt dt .

0

Graphical representations, visualizing trajectories and some statistical properties of quasi optimal processes η0 = η0 (t), η1 = η1 (t), X = X(t), and c = c(t),
are included there.

810

4

A. Janicki and J. Zwierz

Conclusions

We strongly insist that even such rough approximations of the optimal investment and consumption problem as presented here are of important practical
interest. One can get quite useful ideas about properties of stochastic processes
solving the problem, how they depend on parameters of the stochastic model of
ﬁnancial market, investor preferences, etc. Of course, much more work on improvement of suggested method of construction of quasi optimal portfolio has to
be done. It is also quite obvious that the method can be easily extended onto
much more soﬁsticated stochastic models of ﬁnancial market. There are various
questions of mathematical nature, that should be answered in the future, e.g.
on the correctness and convergence of the proposed approximate method, when
more and more parameters enlargig properly the sets of admissible portfolio and
consumption processes, are included.
Our computer experiments indicate to some extent the direction of further
development of computational methods and computer software useful in practical solution of such complicated problems as construction of optimal strategies
for investors, when stochastic model of the ﬁnancial market is investigated in
the framework of a system of SDEs of Itˆ
o or another, more general, type. For
example, our approach can be in a very simple and natural way implemented
for parallel computing systems.

References
1. Janicki, A., Izydorczyk, A.: Computer Methods in Stochastic Modeling (in Polish).
Wydawnictwa Naukowo-Techniczne, Warszawa, (2001)
2. Janicki, A., Izydorczyk, A., Gr¸adalski, P.: Computer Simulation of Stochastic Models with SDE–Solver Software Package. Proceedings of the 3ICCS Sankt Petersburg, Lecture Notes in Computer Science 2657 (2003) 361–370
3. Janicki, A., Krajna, L.: Malliavin Calculus in Construction of Hedging Portfolios
for the Heston Model of a Financial Market. Demonstratio Mathematica XXXIV
(2001) 483–495
4. Karatzas I., Shreve, S.E.: Methods of Mathematical Finance. Springer-Verlag, Berlin, (1998)
5. Kloeden, P.E., Platen, E.: Numerical Solution of Stochastic Diﬀerential Equations,
3rd ed. Springer-Verlag, New York, (1998)
6. Musiela, M., Rutkowski, M.: Martingale Methods in Financial Modelling: Theory
and Applications. Springer-Verlag, New York, (1997)
7. Ocone, D.L., Karatzas, I.: A generalized Clark representation formula, with application to optimal portfolios. Stochastics and Stochastics Reports 34 (1991), 187–220
8. Protter, P.: Stochastic Integration and Diﬀerential Equations – A New Approach.
Springer-Verlag, New York, (1990)
9. Rachev, S. T.: Handbook of Numerical Methods in Finance. Springer-Verlag, Berlin,
New York, (2004)

